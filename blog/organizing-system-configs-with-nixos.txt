3:I[5613,[],""]
5:I[1778,[],""]
6:I[8029,["250","static/chunks/250-a30085ccab20449f.js","781","static/chunks/781-9238b26c3a132736.js","185","static/chunks/app/layout-9608048ecb38eb6e.js"],"ThemeProviders"]
7:I[5935,["250","static/chunks/250-a30085ccab20449f.js","781","static/chunks/781-9238b26c3a132736.js","185","static/chunks/app/layout-9608048ecb38eb6e.js"],""]
8:I[9266,["250","static/chunks/250-a30085ccab20449f.js","781","static/chunks/781-9238b26c3a132736.js","185","static/chunks/app/layout-9608048ecb38eb6e.js"],"KBarSearchProvider"]
9:I[5250,["250","static/chunks/250-a30085ccab20449f.js","749","static/chunks/749-ed776d54eb5c7205.js","797","static/chunks/app/blog/%5B...slug%5D/page-fd9b73ee915812e8.js"],""]
a:I[2146,["250","static/chunks/250-a30085ccab20449f.js","781","static/chunks/781-9238b26c3a132736.js","185","static/chunks/app/layout-9608048ecb38eb6e.js"],"KBarButton"]
b:I[5021,["250","static/chunks/250-a30085ccab20449f.js","781","static/chunks/781-9238b26c3a132736.js","185","static/chunks/app/layout-9608048ecb38eb6e.js"],""]
c:I[123,["250","static/chunks/250-a30085ccab20449f.js","781","static/chunks/781-9238b26c3a132736.js","185","static/chunks/app/layout-9608048ecb38eb6e.js"],""]
4:["slug","organizing-system-configs-with-nixos","c"]
d:T44f,M23.268 5.313c-.35-2.578-2.617-4.61-5.304-5.004C17.51.242 15.792 0 11.813 0h-.03c-3.98 0-4.835.242-5.288.309C3.882.692 1.496 2.518.917 5.127.64 6.412.61 7.837.661 9.143c.074 1.874.088 3.745.26 5.611.118 1.24.325 2.47.62 3.68.55 2.237 2.777 4.098 4.96 4.857 2.336.792 4.849.923 7.256.38.265-.061.527-.132.786-.213.585-.184 1.27-.39 1.774-.753a.057.057 0 0 0 .023-.043v-1.809a.052.052 0 0 0-.02-.041.053.053 0 0 0-.046-.01 20.282 20.282 0 0 1-4.709.545c-2.73 0-3.463-1.284-3.674-1.818a5.593 5.593 0 0 1-.319-1.433.053.053 0 0 1 .066-.054c1.517.363 3.072.546 4.632.546.376 0 .75 0 1.125-.01 1.57-.044 3.224-.124 4.768-.422.038-.008.077-.015.11-.024 2.435-.464 4.753-1.92 4.989-5.604.008-.145.03-1.52.03-1.67.002-.512.167-3.63-.024-5.545zm-3.748 9.195h-2.561V8.29c0-1.309-.55-1.976-1.67-1.976-1.23 0-1.846.79-1.846 2.35v3.403h-2.546V8.663c0-1.56-.617-2.35-1.848-2.35-1.112 0-1.668.668-1.67 1.977v6.218H4.822V8.102c0-1.31.337-2.35 1.011-3.12.696-.77 1.608-1.164 2.74-1.164 1.311 0 2.302.5 2.962 1.498l.638 1.06.638-1.06c.66-.999 1.65-1.498 2.96-1.498 1.13 0 2.043.395 2.74 1.164.675.77 1.012 1.81 1.012 3.12z0:["KJjil5QzPbaOHvzNe1zNm",[[["",{"children":["blog",{"children":[["slug","organizing-system-configs-with-nixos","c"],{"children":["__PAGE__?{\"slug\":[\"organizing-system-configs-with-nixos\"]}",{}]}]}]},"$undefined","$undefined",true],["",{"children":["blog",{"children":[["slug","organizing-system-configs-with-nixos","c"],{"children":["__PAGE__",{},["$L1","$L2",null]]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children","$4","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/14fb540b7a3ad639.css","precedence":"next","crossOrigin":""}]]}]]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}]]},[null,["$","html",null,{"lang":"en-us","className":"__variable_587f35 scroll-smooth","suppressHydrationWarning":true,"children":[["$","link",null,{"rel":"apple-touch-icon","sizes":"76x76","href":"/static/favicons/apple-touch-icon.png"}],["$","link",null,{"rel":"icon","type":"image/png","sizes":"32x32","href":"/static/favicons/favicon-32x32.png"}],["$","link",null,{"rel":"icon","type":"image/png","sizes":"16x16","href":"/static/favicons/favicon-16x16.png"}],["$","link",null,{"rel":"manifest","href":"/static/favicons/site.webmanifest"}],["$","link",null,{"rel":"mask-icon","href":"/static/favicons/safari-pinned-tab.svg","color":"#5bbad5"}],["$","meta",null,{"name":"msapplication-TileColor","content":"#000000"}],["$","meta",null,{"name":"theme-color","media":"(prefers-color-scheme: light)","content":"#fff"}],["$","meta",null,{"name":"theme-color","media":"(prefers-color-scheme: dark)","content":"#000"}],["$","link",null,{"rel":"alternate","type":"application/rss+xml","href":"/feed.xml"}],["$","body",null,{"className":"bg-white text-black antialiased dark:bg-gray-950 dark:text-white","children":["$","$L6",null,{"children":[[["$","$L7",null,{"strategy":"lazyOnload","data-domain":"johns.codes","data-api":"$undefined","src":"https://plausible.io/js/plausible.js"}],["$","$L7",null,{"strategy":"lazyOnload","id":"plausible-script","children":"\n            window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }\n        "}]],["$","section",null,{"className":"mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0","children":["$","div",null,{"className":"flex h-screen flex-col justify-between font-sans","children":[["$","$L8",null,{"kbarConfig":{"searchDocumentsPath":"search.json"},"children":[["$","header",null,{"className":"flex items-center justify-between py-10","children":[["$","div",null,{"children":["$","$L9",null,{"href":"/","aria-label":"John's Codes","children":["$","div",null,{"className":"flex items-center justify-between","children":["$","div",null,{"className":"hidden h-6 text-2xl font-semibold sm:block","children":"John's Codes"}]}]}]}],["$","div",null,{"className":"flex items-center space-x-4 leading-5 sm:space-x-6","children":[[["$","$L9",null,{"href":"/blog","className":"hidden font-medium text-gray-900 dark:text-gray-100 sm:block","children":"Blog"}],["$","$L9",null,{"href":"/tags","className":"hidden font-medium text-gray-900 dark:text-gray-100 sm:block","children":"Tags"}],["$","$L9",null,{"href":"/projects","className":"hidden font-medium text-gray-900 dark:text-gray-100 sm:block","children":"Projects"}],["$","$L9",null,{"href":"/about","className":"hidden font-medium text-gray-900 dark:text-gray-100 sm:block","children":"About"}]],["$","$La",null,{"aria-label":"Search","children":["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","fill":"none","viewBox":"0 0 24 24","strokeWidth":1.5,"stroke":"currentColor","className":"h-6 w-6 text-gray-900 dark:text-gray-100","children":["$","path",null,{"strokeLinecap":"round","strokeLinejoin":"round","d":"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"}]}]}],["$","$Lb",null,{}],["$","$Lc",null,{}]]}]]}],["$","main",null,{"className":"mb-auto","children":["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","div",null,{"className":"flex flex-col items-start justify-start md:mt-24 md:flex-row md:items-center md:justify-center md:space-x-6","children":[["$","div",null,{"className":"space-x-2 pb-8 pt-6 md:space-y-5","children":["$","h1",null,{"className":"text-6xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 md:border-r-2 md:px-6 md:text-8xl md:leading-14","children":"404"}]}],["$","div",null,{"className":"max-w-md","children":[["$","p",null,{"className":"mb-4 text-xl font-bold leading-normal md:text-2xl","children":"Sorry we couldn't find this page."}],["$","p",null,{"className":"mb-8","children":"But dont worry, you can find plenty of other things on our homepage."}],["$","$L9",null,{"href":"/","className":"focus:shadow-outline-blue inline rounded-lg border border-transparent bg-blue-600 px-4 py-2 text-sm font-medium leading-5 text-white shadow transition-colors duration-150 hover:bg-blue-700 focus:outline-none dark:hover:bg-blue-500","children":"Back to homepage"}]]}]]}],"notFoundStyles":[],"styles":null}]}]]}],["$","footer",null,{"children":["$","div",null,{"className":"mt-16 flex flex-col items-center","children":[["$","div",null,{"className":"mb-3 flex space-x-4","children":[null,["$","a",null,{"className":"text-sm text-gray-500 transition hover:text-gray-600","target":"_blank","rel":"noopener noreferrer","href":"https://github.com/JRMurr","children":[["$","span",null,{"className":"sr-only","children":"github"}],["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","viewBox":"0 0 24 24","className":"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6","children":["$","path",null,{"d":"M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"}]}]]}],["$","a",null,{"className":"text-sm text-gray-500 transition hover:text-gray-600","target":"_blank","rel":"noopener noreferrer","href":"https://twitter.com/JRMurrCodes","children":[["$","span",null,{"className":"sr-only","children":"twitter"}],["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","viewBox":"0 0 24 24","className":"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6","children":["$","path",null,{"d":"M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"}]}]]}],["$","a",null,{"className":"text-sm text-gray-500 transition hover:text-gray-600","target":"_blank","rel":"noopener noreferrer","href":"https://hachyderm.io/@jrmurr","children":[["$","span",null,{"className":"sr-only","children":"mastodon"}],["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","viewBox":"0 0 24 24","className":"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6","children":["$","path",null,{"d":"$d"}]}]]}],["$","a",null,{"className":"text-sm text-gray-500 transition hover:text-gray-600","target":"_blank","rel":"noopener noreferrer","href":"/feed.xml","children":[["$","span",null,{"className":"sr-only","children":"rss"}],["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","viewBox":"0 0 24 24","className":"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6","children":[["$","path",null,{"d":"M3.692 17.517A3.696 3.696 0 0 0 0 21.211C0 23.244 1.656 24.9 3.692 24.9s3.694-1.657 3.694-3.689a3.697 3.697 0 0 0-3.694-3.694z"}],["$","path",null,{"d":"M.384 8.142A.386.386 0 0 0 0 8.527v4.688c0 .211.173.383.384.383 6.02 0 10.919 4.898 10.919 10.92 0 .209.171.383.384.383h4.705a.385.385 0 0 0 .387-.383l-.018-.121C16.692 15.423 9.37 8.142.384 8.142z"}],["$","path",null,{"d":"M24.89 24.397C24.825 10.936 13.854.011.384.011A.385.385 0 0 0 0 .397v4.824c0 .212.173.383.384.383 10.429 0 18.913 8.486 18.913 18.914 0 .209.172.383.382.383h4.845a.39.39 0 0 0 .388-.383l-.022-.121z"}]]}]]}]]}],["$","div",null,{"className":"mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400","children":[["$","div",null,{"children":"John Murray"}],["$","div",null,{"children":" • "}],["$","div",null,{"children":"© 2024"}],["$","div",null,{"children":" • "}],["$","$L9",null,{"href":"/","children":"John's Codes"}]]}]]}]}]]}]}]]}]}]]}],null]],[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/895662d5d095c22a.css","precedence":"next","crossOrigin":""}]],"$Le"]]]]
f:I[144,["250","static/chunks/250-a30085ccab20449f.js","749","static/chunks/749-ed776d54eb5c7205.js","797","static/chunks/app/blog/%5B...slug%5D/page-fd9b73ee915812e8.js"],""]
10:I[2502,["250","static/chunks/250-a30085ccab20449f.js","749","static/chunks/749-ed776d54eb5c7205.js","797","static/chunks/app/blog/%5B...slug%5D/page-fd9b73ee915812e8.js"],""]
11:I[4282,["250","static/chunks/250-a30085ccab20449f.js","749","static/chunks/749-ed776d54eb5c7205.js","797","static/chunks/app/blog/%5B...slug%5D/page-fd9b73ee915812e8.js"],""]
12:I[4970,["250","static/chunks/250-a30085ccab20449f.js","749","static/chunks/749-ed776d54eb5c7205.js","797","static/chunks/app/blog/%5B...slug%5D/page-fd9b73ee915812e8.js"],""]
2:[["$","script",null,{"type":"application/ld+json","dangerouslySetInnerHTML":{"__html":"{\"@context\":\"https://schema.org\",\"@type\":\"BlogPosting\",\"headline\":\"Organizing system configs with NixOS\",\"datePublished\":\"2023-10-09T07:14:19.315Z\",\"dateModified\":\"2023-10-09T07:14:19.315Z\",\"description\":\"How I organize and manage my system and user configs with NixOS and homemanager\",\"author\":[{\"@type\":\"Person\",\"name\":\"John Murray\"}]}"}}],["$","section",null,{"className":"mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0","children":[["$","$Lf",null,{}],["$","article",null,{"children":["$","div",null,{"children":[["$","header",null,{"children":["$","div",null,{"className":"space-y-1 border-b border-gray-200 pb-10 text-center dark:border-gray-700","children":[["$","dl",null,{"children":["$","div",null,{"children":[["$","dt",null,{"className":"sr-only","children":"Published on"}],["$","dd",null,{"className":"text-base font-medium leading-6 text-gray-500 dark:text-gray-400","children":[["$","time",null,{"dateTime":"2023-10-09T07:14:19.315Z","children":"October 9, 2023"}],["$","span",null,{"className":"mx-2","children":"-"}],["$","span",null,{"className":"ml-1","children":[13," min read"]}]]}]]}]}],["$","div",null,{"children":["$","h1",null,{"className":"text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14","children":"Organizing system configs with NixOS"}]}]]}]}],["$","div",null,{"className":"grid-rows-[auto_1fr] divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:divide-y-0","children":[["$","div",null,{"className":"divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0","children":[["$","div",null,{"className":"prose max-w-none pb-8 pt-10 dark:prose-invert","children":[["$","$L10",null,{"series":null,"currSlug":"organizing-system-configs-with-nixos"}],[["$","details",null,{"open":true,"children":[["$","summary",null,{"className":"ml-6 pb-2 pt-2 text-xl font-bold","children":"Table of Contents"}],["$","div",null,{"className":"ml-6","children":["$","ul",null,{"className":"","children":[["$","li","0",{"children":[["$","a",null,{"href":"#what-is-nixos","children":"What is NixOS"}],["$","ul",null,{"className":"","children":[["$","li","0",{"children":[["$","a",null,{"href":"#quick-nixlang-overview","children":"Quick NixLang overview"}],null]}],["$","li","1",{"children":[["$","a",null,{"href":"#a-basic-module","children":"A Basic Module"}],null]}],["$","li","2",{"children":[["$","a",null,{"href":"#using-nixos","children":"Using NixOS"}],null]}]]}]]}],["$","li","1",{"children":[["$","a",null,{"href":"#diving-into-my-server-config","children":"Diving into my Server Config"}],["$","ul",null,{"className":"","children":[["$","li","0",{"children":[["$","a",null,{"href":"#managing-complex-services","children":"Managing complex services"}],null]}]]}]]}],["$","li","2",{"children":[["$","a",null,{"href":"#managing-secrets","children":"Managing secrets"}],["$","ul",null,{"className":"","children":[["$","li","0",{"children":[["$","a",null,{"href":"#the-secret-repo","children":"The Secret Repo"}],null]}]]}]]}],["$","li","3",{"children":[["$","a",null,{"href":"#managing-dotfiles-with-home-manager","children":"Managing Dotfiles with Home Manager"}],["$","ul",null,{"className":"","children":[["$","li","0",{"children":[["$","a",null,{"href":"#home-manager-on-mac","children":"Home Manager on Mac"}],null]}]]}]]}],["$","li","4",{"children":[["$","a",null,{"href":"#wrap-up","children":"Wrap up"}],null]}]]}]}]]}],["$","p",null,{"children":["Nix and NixOS has been the technology I've been the most excited about in the last few years. While I have used Linux on my personal desktop and home server in the past, I never did anything complicated. It was so hard to remember what I did to my system to get it to work the way I wanted. This led to me keeping my systems very basic and eventually just using windows + docker for everything. While that setup worked fine, it was hard to customize things... I wanted to rice out my config like everyone on ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://www.reddit.com/r/unixporn/","children":"r/unixporn"}]]}],["$","p",null,{"children":"When I found NixOS it was like a lightbulb went off. Now I can feel free to change my config as I please, not be scared if I break something, and be able to reproduce my system if I need to reinstall or got a new machine."}],["$","p",null,{"children":"This post will be going over the \"vibe\" of using NixOS, I will explain how I set up my NixOS config and explain things in broad strokes as I go. I will link out to other posts/code to go into greater detail. I may get some things wrong as I explain so if you catch something please comment!"}],["$","p",null,{"children":"My hope is for people who don't know NixOS this will get you to give it a try. If you are using NixOS but feel lost, give you a path forward for feeling more comfortable using it."}],["$","h2",null,{"id":"what-is-nixos","children":[["$","a",null,{"href":"#what-is-nixos","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"What is NixOS"]}],["$","p",null,{"children":["A big point of confusion when using Nix is the difference between Nix, NixPkgs, and NixOS. ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://www.haskellforall.com/2022/08/stop-calling-everything-nix.html","children":"This post"}]," by ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://twitter.com/GabriellaG439","children":"Gabriella Gonzalez"}]," does a great break down on the differences. For a high level TLDR, ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://NixOS.org/","children":"NixOS"}]," is a Linux distro built on top of ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://github.com/NixOS/nixpkgs","children":"NixPkgs"}],". NixPkgs uses the ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://nix.dev/tutorials/first-steps/nix-language","children":"Nix language"}]," to define how to build packages."]}],["$","p",null,{"children":"There is more nuance than that, but it will be good enough to get started and for googling the right things."}],["$","h3",null,{"id":"quick-nixlang-overview","children":[["$","a",null,{"href":"#quick-nixlang-overview","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"Quick NixLang overview"]}],["$","p",null,{"children":"For people new to nix I will go over the basics so the NixOS examples aren't completely foreign, if you know a little nix or other functional languages you can probably skip this part."}],["$","p",null,{"children":["I like this quote from ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://zero-to-nix.com/concepts/nix-language","children":"zero to nix"}]," to describe the language"]}],["$","blockquote",null,{"children":["$","p",null,{"children":"Nix is a pure, functional, lazy, declarative, and reproducible programming language."}]}],["$","p",null,{"children":"NixLang is a lot like Haskell in that it is pure, functional, and lazy."}],["$","p",null,{"children":"This example should give a decent vibe of what programming in nix is like"}],["$","$L11",null,{"className":"shiki shiki-themes github-light github-dark","style":{"backgroundColor":"#fff","--shiki-dark-bg":"#24292e","color":"#24292e","--shiki-dark":"#e1e4e8"},"tabIndex":"0","children":["$","code",null,{"children":[["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"let"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  foo"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" x: y: "}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"x"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"in"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"  foo"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"a\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" ("}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":"throw"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"sad\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":")"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#6a737d","--shiki-dark":"#6A737D"},"children":"# evals to \"a\""}]}],"\n",["$","span",null,{"className":"line"}]]}]}],["$","p",null,{"children":["That example defines a function ",["$","code",null,{"children":"(x: y: x;)"}]," which takes two arguments and returns the first, and binds it to the variable ",["$","code",null,{"children":"foo"}]," with ",["$","code",null,{"children":"let foo =...; in"}],". This means the variable ",["$","code",null,{"children":"foo"}]," is only in scope after the ",["$","code",null,{"children":"in"}],". Finally, we call foo with ",["$","code",null,{"children":"foo \"a\" (throw \"sad\")"}],". This resolves to \"a\". Notice the error is not thrown because nix is lazy, that means if we never \"need\" to use a variable or expression, it will never be evaluated."]}],["$","p",null,{"children":["If we swap the order of the arguments to the function like ",["$","code",null,{"children":"foo (throw \"sad\") \"b\""}],", we will get"]}],["$","$L11",null,{"className":"shiki shiki-themes github-light github-dark","style":{"backgroundColor":"#fff","--shiki-dark-bg":"#24292e","color":"#24292e","--shiki-dark":"#e1e4e8"},"tabIndex":"0","children":["$","code",null,{"children":[["$","span",null,{"className":"line","children":["$","span",null,{"children":"error:"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"children":"       … while calling the 'throw' builtin"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"children":"         at «string»:1:29:"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"children":"            1| (let foo = x: y: x; in foo (throw \"sad\") \"b\")"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"children":"             |                             ^"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"children":"       error: sad"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{}]}]]}]}],["$","p",null,{"children":"The laziness helps us right very declarative code, describe what you want and if you don't reference something, no worries, it won't affect performance."}],["$","p",null,{"children":["One of my favorite features of the nix language is how you can use ",["$","code",null,{"children":"attrsets"}]," (objects, hash maps, dicts, etc.). You can create one like"]}],["$","$L11",null,{"className":"shiki shiki-themes github-light github-dark","style":{"backgroundColor":"#fff","--shiki-dark-bg":"#24292e","color":"#24292e","--shiki-dark":"#e1e4e8"},"tabIndex":"0","children":["$","code",null,{"children":[["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"let"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  foo"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    key1"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"bar\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    key2"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"      nested1"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" 1"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"      nested2"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" 2"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"    };"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"  };"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"in"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"  foo"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"key2"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"nested1"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#6a737d","--shiki-dark":"#6A737D"},"children":"# resolves to 1"}]}],"\n",["$","span",null,{"className":"line"}]]}]}],["$","p",null,{"children":["at first, they look like normal objects from something like python or JS but my favorite feature of them is the syntax sugar for dealing with nested ",["$","code",null,{"children":"attrsets"}]]}],["$","$L11",null,{"className":"shiki shiki-themes github-light github-dark","style":{"backgroundColor":"#fff","--shiki-dark-bg":"#24292e","color":"#24292e","--shiki-dark":"#e1e4e8"},"tabIndex":"0","children":["$","code",null,{"children":[["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"let"}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":" foo"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  key1"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"bar\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  key2"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"nested1"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" 1"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  key2"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"nested2"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" 2"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"};"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"in"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"  foo"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"key2"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"nested1"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#6a737d","--shiki-dark":"#6A737D"},"children":"# resolves to 1"}]}],"\n",["$","span",null,{"className":"line"}]]}]}],["$","p",null,{"children":["That snippet creates the same ",["$","code",null,{"children":"attrset"}]," as the example above but lets you use \"path notation\" to create the nested object. While a basic syntax sugar it makes it very easy to override 1 nested option when merging things together. Without it NixOS would be a big PITA to manage IMO."]}],["$","p",null,{"children":["The last language feature I'll cover is the ",["$","code",null,{"children":"with"}]," block."]}],["$","$L11",null,{"className":"shiki shiki-themes github-light github-dark","style":{"backgroundColor":"#fff","--shiki-dark-bg":"#24292e","color":"#24292e","--shiki-dark":"#e1e4e8"},"tabIndex":"0","children":["$","code",null,{"children":[["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"with"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" { "}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"a"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" 1"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"; "}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"b"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" 2"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"; };"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"  a"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" +"}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" b"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#6a737d","--shiki-dark":"#6A737D"},"children":"# evals to 3"}]}],"\n",["$","span",null,{"className":"line"}]]}]}],["$","p",null,{"children":["The with block will put all of an ",["$","code",null,{"children":"attrset"}],"'s key value pairs as variable in scope. This makes it easier to access library functions with something like ",["$","code",null,{"children":"with builtins"}]," or ",["$","code",null,{"children":"with lib"}],", so you don't need to prefix everything."]}],["$","h3",null,{"id":"a-basic-module","children":[["$","a",null,{"href":"#a-basic-module","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"A Basic Module"]}],["$","p",null,{"children":["NixOS lets you organize your system into many ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://NixOS.wiki/wiki/NixOS_modules","children":"modules"}],". A module is a file or function that either declares options for other modules to use, or sets options defined in other modules."]}],["$","p",null,{"children":"For example"}],["$","div",null,{"className":"remark-code-title","children":"hello.nix"}],["$","$L11",null,{"className":"shiki shiki-themes github-light github-dark","style":{"backgroundColor":"#fff","--shiki-dark-bg":"#24292e","color":"#24292e","--shiki-dark":"#e1e4e8"},"tabIndex":"0","children":["$","code",null,{"children":[["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#6a737d","--shiki-dark":"#6A737D"},"children":"# Taken from https://NixOS.wiki/wiki/NixOS_modules#Example"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"{ lib"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":","}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" pkgs"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":","}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" config"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":","}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ... "}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"}:"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"with"}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" lib"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"let"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#6a737d","--shiki-dark":"#6A737D"},"children":"  # Shorter name to access final settings a"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#6a737d","--shiki-dark":"#6A737D"},"children":"  # user of hello.nix module HAS ACTUALLY SET."}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#6a737d","--shiki-dark":"#6A737D"},"children":"  # cfg is a typical convention."}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  cfg"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" config"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"services"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"hello"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"in"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#6a737d","--shiki-dark":"#6A737D"},"children":"  # Declare what settings a user of this \"hello.nix\" module CAN SET."}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  options"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"services"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"hello"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    enable"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" mkEnableOption"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"hello service\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    greeter"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" mkOption"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"      type"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" types"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"str"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"      default"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"world\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"    };"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"  };"}]}],"\n",["$","span",null,{"className":"line"}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#6a737d","--shiki-dark":"#6A737D"},"children":"  # Define what other settings, services and resources should be active IF"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#6a737d","--shiki-dark":"#6A737D"},"children":"  # a user of this \"hello.nix\" module ENABLED this module"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#6a737d","--shiki-dark":"#6A737D"},"children":"  # by setting \"services.hello.enable = true;\"."}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  config"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" mkIf"}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" cfg"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"enable"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    systemd"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"services"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"hello"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"      wantedBy"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" [ "}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"\"multi-user.target\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" ];"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"      serviceConfig"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"ExecStart"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8","fontStyle":"italic","--shiki-dark-font-style":"italic"},"children":"$${"}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF","fontStyle":"italic","--shiki-dark-font-style":"italic"},"children":"pkgs"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583","fontStyle":"italic","--shiki-dark-font-style":"italic"},"children":"."}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF","fontStyle":"italic","--shiki-dark-font-style":"italic"},"children":"hello"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8","fontStyle":"italic","--shiki-dark-font-style":"italic"},"children":"}"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"/bin/hello -g'Hello, "}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8","fontStyle":"italic","--shiki-dark-font-style":"italic"},"children":"$${"}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF","fontStyle":"italic","--shiki-dark-font-style":"italic"},"children":"escapeShellArg"}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF","fontStyle":"italic","--shiki-dark-font-style":"italic"},"children":" cfg"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583","fontStyle":"italic","--shiki-dark-font-style":"italic"},"children":"."}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF","fontStyle":"italic","--shiki-dark-font-style":"italic"},"children":"greeter"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8","fontStyle":"italic","--shiki-dark-font-style":"italic"},"children":"}"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"!'\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"    };"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"  };"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"}"}]}],"\n",["$","span",null,{"className":"line"}]]}]}],["$","p",null,{"children":["The file above adds the ",["$","code",null,{"children":"services.hello"}]," option. When enabled NixOS will make a system service called ",["$","code",null,{"children":"hello.service"}]," which will log ",["$","code",null,{"children":"Hello <greeter>!"}],". The module/options it defined can be used like this"]}],["$","div",null,{"className":"remark-code-title","children":"configuration.nix"}],["$","$L11",null,{"className":"shiki shiki-themes github-light github-dark","style":{"backgroundColor":"#fff","--shiki-dark-bg":"#24292e","color":"#24292e","--shiki-dark":"#e1e4e8"},"tabIndex":"0","children":["$","code",null,{"children":[["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"{"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  imports"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" [ "}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"./hello.nix"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" ];"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"  ..."}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  services"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"hello"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    enable"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" true"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    greeter"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"Bob\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"  };"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"}"}]}],"\n",["$","span",null,{"className":"line"}]]}]}],["$","p",null,{"children":["this file imports the module so the ",["$","code",null,{"children":"services.hello"}]," exists and can be used. It also set the ",["$","code",null,{"children":"greeter"}]," option we defined so the ",["$","code",null,{"children":"hello.service"}]," will log ",["$","code",null,{"children":"Hello Bob!"}]]}],["$","p",null,{"children":["There are many options defined in the NixOS ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://nixos.org/manual/nixos/stable/options","children":"standard library"}],". Many programs can be installed and configured with NixOS options people have put together. For example to install steam I can add"]}],["$","$L11",null,{"className":"shiki shiki-themes github-light github-dark","style":{"backgroundColor":"#fff","--shiki-dark-bg":"#24292e","color":"#24292e","--shiki-dark":"#e1e4e8"},"tabIndex":"0","children":["$","code",null,{"children":[["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"{"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    programs"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"steam"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"enable"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" true"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"}"}]}],"\n",["$","span",null,{"className":"line"}]]}]}],["$","p",null,{"children":["That single line will do a lot of work for you as you can see ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://github.com/NixOS/nixpkgs/blob/9075cba53e86dc318d159aee55dc9a7c9a4829c1/nixos/modules/programs/steam.nix#L112","children":"here"}],". Enabling steam will also make sure you have OpenGL enabled, open firewall ports, and can be further configured if other steam options are set."]}],["$","p",null,{"children":"That is the magic of NixOS to me, many people have spent time figuring out all the edge cases/things you would normally need to do if you just installed a package and automates it all away for you."}],["$","p",null,{"children":["The ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://search.nixos.org/options","children":"search page"}]," is a great reference to find options defined in the standard library."]}],["$","h3",null,{"id":"using-nixos","children":[["$","a",null,{"href":"#using-nixos","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"Using NixOS"]}],["$","p",null,{"children":["That example is fine, but what do I actually do? My ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://github.com/JRMurr/NixOsConfig","children":"NixOS config repo"}]," is organized as follows"]}],["$","$L11",null,{"className":"shiki shiki-themes github-light github-dark","style":{"backgroundColor":"#fff","--shiki-dark-bg":"#24292e","color":"#24292e","--shiki-dark":"#e1e4e8"},"tabIndex":"0","children":["$","code",null,{"children":[["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"❯"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" exa"}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" --tree"}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" --level"}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" 2"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" common"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" audio.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" autorandr.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" containers.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" default.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" devlopment.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" essentials.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" fonts.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" gestures"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" homemanager"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" kernel.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" myOptions"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" network-shares.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" plymouth.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" programs.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" ssh.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" sudo.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" tailscale.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" users"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  └──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" xserver.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" default.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" flake.lock"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" flake.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" hosts"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" desktop"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" framework"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" thicc-server"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  └──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" wsl"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" legacyCommon.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" pkgs"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" caddy-with-plugins"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" default.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  └──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" overlay.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"└──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" README.md"}]]}],"\n",["$","span",null,{"className":"line"}]]}]}],["$","p",null,{"children":["The ",["$","code",null,{"children":"flake.nix"}]," file is the entry point for everything, it roughly looks like this"]}],["$","div",null,{"className":"remark-code-title","children":"flake.nix"}],["$","$L11",null,{"className":"shiki shiki-themes github-light github-dark","style":{"backgroundColor":"#fff","--shiki-dark-bg":"#24292e","color":"#24292e","--shiki-dark":"#e1e4e8"},"tabIndex":"0","children":["$","code",null,{"children":[["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"{"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  inputs"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#6a737d","--shiki-dark":"#6A737D"},"children":"    # ommited"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"  };"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  outputs"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" { self"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":","}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" nixpkgs"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":","}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" home-manager"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":","}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" wsl"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":","}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" flake-utils"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":","}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ... "}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"}@inputs:"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"    let"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"      overlays"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" ["}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"        inputs"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"attic"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"overlays"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"default"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"        inputs"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"agenix"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"overlays"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"default"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"        ("}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":"import"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" ./pkgs/overlay.nix"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":")"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"      ];"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"      defaultModules"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" ["}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"        { "}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"_module"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"args"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" { "}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"inherit"}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":" inputs"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"; }; }"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"        inputs"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"agenix"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"nixosModules"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"default"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"        home-manager"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"nixosModules"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"home-manager"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"        {"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"          home-manager"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"useGlobalPkgs"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" true"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"          home-manager"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"useUserPackages"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" true"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"        }"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"      ];"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"      mkPkgs"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" system:"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":"        import"}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" nixpkgs"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"          inherit"}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":" system"}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":" overlays"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"          config"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"allowUnfree"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" true"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"        };"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"      mkSystem"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" extraModules:"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"        nixpkgs"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"lib"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"nixosSystem"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" rec"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"          pkgs"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" mkPkgs"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"x86_64-linux\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"          system"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"x86_64-linux\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"          modules"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" defaultModules"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ++"}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" extraModules"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"        };"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"    in"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"      nixosConfigurations"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"        nixos-john"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" mkSystem"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" [ "}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"./hosts/desktop"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" ];"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"        wsl"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" mkSystem"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" [ "}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"wsl"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"nixosModules"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"wsl"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" ./hosts/wsl"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" ];"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"        framework"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" mkSystem"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" ["}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"          inputs"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"nixos-hardware"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"nixosModules"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"framework"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"          ./hosts/framework"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"        ];"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"        thicc-server"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" mkSystem"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" ["}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"          ./hosts/thicc-server"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"          inputs"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"vscode-server"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"nixosModule"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"          inputs"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"attic"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"nixosModules"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"atticd"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"          ({ config"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":","}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" pkgs"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":","}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ... "}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"}: { "}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"services"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"vscode-server"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"enable"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" true"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"; })"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"        ];"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"      };"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"    };"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"}"}]}],"\n",["$","span",null,{"className":"line"}]]}]}],["$","p",null,{"children":["I trimmed this file down to just the most important bit of the ",["$","code",null,{"children":"nixosConfigurations"}]," section in the ",["$","code",null,{"children":"outputs"}],". That section is a mapping of ",["$","code",null,{"children":"hostname => nixosConfigOptions"}],", so the ",["$","code",null,{"children":"framework"}]," key is for my laptop, ",["$","code",null,{"children":"thicc-server"}]," is my server, and so on. The ",["$","code",null,{"children":"mkSystem"}]," function will add some default modules for setting up ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://github.com/nix-community/home-manager","children":"Home Manager"}]," and ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://github.com/ryantm/agenix","children":"agenix"}]," (will explain those later), and adds in the specified modules for that host."]}],["$","p",null,{"children":["You may have noticed in the list of modules some elements are file paths like ",["$","code",null,{"children":"./hosts/thicc-server"}],", some are just variables like ",["$","code",null,{"children":"inputs.nixos-hardware.nixosModules.framework"}],", and some are inline functions like ",["$","code",null,{"children":"({ config, pkgs, ... }: { services.vscode-server.enable = true; })"}],". Each is functionally the same, they all will turn into a module function like I showed at the beginning of this post."]}],["$","h2",null,{"id":"diving-into-my-server-config","children":[["$","a",null,{"href":"#diving-into-my-server-config","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"Diving into my Server Config"]}],["$","p",null,{"children":["I briefly covered how NixOS modules works and how you might organize your systems, but what does a single system look like? So now lets dive into my server (",["$","code",null,{"children":"thicc-server"}],") config."]}],["$","p",null,{"children":["The main part of the config lives in the ",["$","code",null,{"children":"./hosts/thicc-server"}]," folder, which looks like this"]}],["$","$L11",null,{"className":"shiki shiki-themes github-light github-dark","style":{"backgroundColor":"#fff","--shiki-dark-bg":"#24292e","color":"#24292e","--shiki-dark":"#e1e4e8"},"tabIndex":"0","children":["$","code",null,{"children":[["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"❯"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" exa"}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" --tree"}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" --level"}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" 2"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" ./hosts/thicc-server/"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"./hosts/thicc-server"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" attic.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" blocky"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" default.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  └──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" whitelist.txt"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" caddy"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" default.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" options.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  └──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" reverse-proxies.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" dashy.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" default.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" freshrss.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" hardware-configuration.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" it-tools.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" linkding.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" monitoring"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" default.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" grafana.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" loki.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"│"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  └──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" prometheus.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" mopidy.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"└──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" postgres.nix"}]]}],"\n",["$","span",null,{"className":"line"}]]}]}],["$","p",null,{"children":["When you reference a folder in nix import, nix will read from the ",["$","code",null,{"children":"default.nix"}]," (similar to how JS will import a ",["$","code",null,{"children":"index.js"}]," file if you import from a folder)."]}],["$","div",null,{"className":"remark-code-title","children":"hosts/thicc-server/default.nix"}],["$","$L11",null,{"className":"shiki shiki-themes github-light github-dark","style":{"backgroundColor":"#fff","--shiki-dark-bg":"#24292e","color":"#24292e","--shiki-dark":"#e1e4e8"},"tabIndex":"0","children":["$","code",null,{"children":[["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"{ config"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":","}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" pkgs"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":","}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ... "}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"}: {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  imports"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" ["}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"    ./hardware-configuration.nix"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"    ../../common"}]}],"\n",["$","span",null,{"className":"line"}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"    ./attic.nix"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"    ./blocky"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"    ./caddy"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"    ./dashy.nix"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"    ./freshrss.nix"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"    ./it-tools.nix"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"    ./monitoring"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"    ./linkding.nix"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"    ./mopidy.nix"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"    ./postgres.nix"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"  ];"}]}],"\n",["$","span",null,{"className":"line"}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  time"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"timeZone"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"America/New_York\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  networking"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"hostName"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"thicc-server\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line"}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  myOptions"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    graphics"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"enable"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" false"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    networkShares"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"enable"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" true"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    containers"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"enable"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" true"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"  };"}]}],"\n",["$","span",null,{"className":"line"}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  boot"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"loader"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    systemd-boot"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"enable"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" true"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    efi"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"canTouchEfiVariables"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" true"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"  };"}]}],"\n",["$","span",null,{"className":"line"}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  services"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"openssh"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    enable"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" true"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    settings"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"PermitRootLogin"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"yes\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"  };"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  virtualisation"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"docker"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"enable"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" true"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line"}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  system"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"stateVersion"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"21.11\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"}"}]}],"\n",["$","span",null,{"className":"line"}]]}]}],["$","p",null,{"children":["So this file does some \"core\" options like hostname, timezone, enabling some of my custom options (in the ",["$","code",null,{"children":"myOptions"}]," section), and it imports the other files in this folder and from ",["$","code",null,{"children":"common"}]]}],["$","h3",null,{"id":"managing-complex-services","children":[["$","a",null,{"href":"#managing-complex-services","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"Managing complex services"]}],["$","p",null,{"children":"Where NixOS really shines is how you manage services that need a lot of configuration like Grafana or Prometheus. People have either done a lot of groundwork for you and exposed a simple interface to get something spun up. If not, it's easy to make your own abstraction."}],["$","p",null,{"children":"For example here is my config to set up Grafana"}],["$","$L11",null,{"className":"shiki shiki-themes github-light github-dark","style":{"backgroundColor":"#fff","--shiki-dark-bg":"#24292e","color":"#24292e","--shiki-dark":"#e1e4e8"},"tabIndex":"0","children":["$","code",null,{"children":[["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"{ config"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":","}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ... "}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"}:"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"let"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  myDomain"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" config"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"myCaddy"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"domain"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  grafanaDomain"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"grafana."}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8","fontStyle":"italic","--shiki-dark-font-style":"italic"},"children":"$${"}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF","fontStyle":"italic","--shiki-dark-font-style":"italic"},"children":"myDomain"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8","fontStyle":"italic","--shiki-dark-font-style":"italic"},"children":"}"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  port"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" 3030"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"in"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  services"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"grafana"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    enable"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" true"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    settings"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"      server"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"        http_addr"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"0.0.0.0\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"        http_port"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" port"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"        domain"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" grafanaDomain"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"      };"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"    };"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    provision"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"enable"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" true"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"  };"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  myCaddy"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"reverseProxies"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"\"grafana\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"upstream"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \":"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8","fontStyle":"italic","--shiki-dark-font-style":"italic"},"children":"$${"}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF","fontStyle":"italic","--shiki-dark-font-style":"italic"},"children":"builtins"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583","fontStyle":"italic","--shiki-dark-font-style":"italic"},"children":"."}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF","fontStyle":"italic","--shiki-dark-font-style":"italic"},"children":"toString"}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF","fontStyle":"italic","--shiki-dark-font-style":"italic"},"children":" port"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8","fontStyle":"italic","--shiki-dark-font-style":"italic"},"children":"}"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"}"}]}],"\n",["$","span",null,{"className":"line"}]]}]}],["$","p",null,{"children":"This file is almost like a docker compose where you set some env vars for ports and listening addresses, but I have the benefit of reading from other NixOS options to set variables (and it won't run in a container)."}],["$","p",null,{"children":["For example at the top I read in ",["$","code",null,{"children":"myDomain = config.myCaddy.domain;"}],", this is an option I set ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://github.com/JRMurr/NixOsConfig/blob/main/hosts/thicc-server/caddy/options.nix#L51","children":"here"}]," that is just a variable holding the domain for my home lab. This way the Grafana domain will change automatically if I decide to change my domain (unlikely but DRY, so it makes me feel good)."]}],["$","p",null,{"children":["I also use ",["$","code",null,{"children":"myCaddy.reverseProxies.\"grafana\".upstream"}]," which is another custom option of mine to generate a reverse proxy config in caddy. This will make a URL for Grafana at ",["$","code",null,{"children":"https://grafana.<mydomain>"}],"."]}],["$","p",null,{"children":"To me this is magic, one file has all the config needed to spin up Grafana and set the necessary caddy options for me. If I decide to stop using Grafana, I can delete this file, and It's as if it never existed with no dangling reverse proxies going to nowhere."}],["$","p",null,{"children":["For some slightly more involved config, see my ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://github.com/JRMurr/NixOsConfig/blob/main/hosts/thicc-server/monitoring/prometheus.nix#L4","children":"Prometheus config"}],", it references some Grafana options to auto register data sources for me."]}],["$","h2",null,{"id":"managing-secrets","children":[["$","a",null,{"href":"#managing-secrets","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"Managing secrets"]}],["$","p",null,{"children":"When configuring services you will eventually need to manage secrets somehow. Some services will need an API key or password to function and leaving that in plain text in git or the nix store is a no-no (since they can be read easily). Up until recently I didn't really care, I didn't configure too many services that needed it, so I would either not care or use some hacky workaround."}],["$","p",null,{"children":["Now I use ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://github.com/ryantm/agenix","children":"agenix"}]," to encrypt my secrets. At a high level agenix is a wrapper around ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://github.com/FiloSottile/age","children":"age"}]," which uses ssh keys to encrypt and decrypt files. The nice part is you can specify multiple keys to use as encryption and decryption. So for example I can list my user ssh key and the root ssh key for my server. So when adding/editing secrets I just need my private ssh key to decrypt, then using my public keys I can encrypt the updated secret."]}],["$","p",null,{"children":"agenix adds NixOS options like"}],["$","$L11",null,{"className":"shiki shiki-themes github-light github-dark","style":{"backgroundColor":"#fff","--shiki-dark-bg":"#24292e","color":"#24292e","--shiki-dark":"#e1e4e8"},"tabIndex":"0","children":["$","code",null,{"children":[["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"{"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#6a737d","--shiki-dark":"#6A737D"},"children":"  # register the secret"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  age"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"secrets"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"caddy-cloudflare"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    file"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8","fontStyle":"italic","--shiki-dark-font-style":"italic"},"children":"$${"}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF","fontStyle":"italic","--shiki-dark-font-style":"italic"},"children":"inputs"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583","fontStyle":"italic","--shiki-dark-font-style":"italic"},"children":"."}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF","fontStyle":"italic","--shiki-dark-font-style":"italic"},"children":"secrets"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8","fontStyle":"italic","--shiki-dark-font-style":"italic"},"children":"}"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"/secrets/caddy-cloudflare.age\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"; "}],["$","span",null,{"style":{"color":"#6a737d","--shiki-dark":"#6A737D"},"children":"# path to encrpyted secret file"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#6a737d","--shiki-dark":"#6A737D"},"children":"    # let the caddy user read the secret"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    owner"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" config"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"services"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"caddy"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"user"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    group"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" config"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"services"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"caddy"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"group"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"  };"}]}],"\n",["$","span",null,{"className":"line"}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  systemd"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"services"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"caddy"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"serviceConfig"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#6a737d","--shiki-dark":"#6A737D"},"children":"    # read the secret"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    EnvironmentFile"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" config"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"age"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"secrets"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"caddy-cloudflare"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"path"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"  };"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"}"}]}],"\n",["$","span",null,{"className":"line"}]]}]}],["$","p",null,{"children":["The first option will tell agenix to decrypt the secret file ",["$","code",null,{"children":"caddy-cloudflare.age"}]," when building the system config, and it will put the decrypted file at a path only readable by root (or in this case the caddy user since I set those options)."]}],["$","p",null,{"children":["Then you need to use the file, most services in NixOS will have some option to read secrets set at a path, so in this case ",["$","code",null,{"children":"systemd.services.caddy.serviceConfig.EnvironmentFile"}]," will have systemd read the path specified on startup."]}],["$","h3",null,{"id":"the-secret-repo","children":[["$","a",null,{"href":"#the-secret-repo","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"The Secret Repo"]}],["$","p",null,{"children":"In my nix config I keep my secrets in a separate private repo, It's not necessary since the age encrypted files will exist in the nix store anyway but gives me a little piece of mind just in case I mess up somehow."}],["$","p",null,{"children":"That repo looks like this"}],["$","$L11",null,{"className":"shiki shiki-themes github-light github-dark","style":{"backgroundColor":"#fff","--shiki-dark-bg":"#24292e","color":"#24292e","--shiki-dark":"#e1e4e8"},"tabIndex":"0","children":["$","code",null,{"children":[["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"❯"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" exa"}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" --tree"}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" --level"}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" 2"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":"."}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" flake.lock"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" flake.nix"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"└──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" secrets"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"   ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" attic-admin-token.age"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"   ├──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" attic-creds.age"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":"    ..."}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"   └──"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" secrets.nix"}]]}],"\n",["$","span",null,{"className":"line"}]]}]}],["$","p",null,{"children":"where the flake is"}],["$","div",null,{"className":"remark-code-title","children":"flake.nix"}],["$","$L11",null,{"className":"shiki shiki-themes github-light github-dark","style":{"backgroundColor":"#fff","--shiki-dark-bg":"#24292e","color":"#24292e","--shiki-dark":"#e1e4e8"},"tabIndex":"0","children":["$","code",null,{"children":[["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"{"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  inputs"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    nixpkgs"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"url"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"github:nixos/nixpkgs/nixos-unstable\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    flake-utils"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"url"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"github:numtide/flake-utils\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    agenix"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"url"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"github:ryantm/agenix\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"  };"}]}],"\n",["$","span",null,{"className":"line"}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  outputs"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" { self"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":","}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" nixpkgs"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":","}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" flake-utils"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":","}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ... "}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"}@inputs:"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"    let"}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":" overlays"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" [ "}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"inputs"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"agenix"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"overlays"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"default"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" ];"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"    in"}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" flake-utils"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"lib"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"eachDefaultSystem"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" (system:"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"      let"}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":" pkgs"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" import"}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" nixpkgs"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" { "}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"inherit"}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":" system"}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":" overlays"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"; };"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"      in"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"        devShells"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"          default"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" pkgs"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"mkShell"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" { "}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"buildInputs"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" with"}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" pkgs"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"; [ "}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"agenix"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" ]; };"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"        };"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"        secrets"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" ./secrets"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"      });"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"}"}]}],"\n",["$","span",null,{"className":"line"}]]}]}],["$","p",null,{"children":["So TLDR just exposes a flake output of ",["$","code",null,{"children":"secrets"}]," which is a directory containing all my age encrypted files. This lets me reference the encrypted files like ",["$","code",null,{"children":"\"${inputs.secrets}/secrets/caddy-cloudflare.age\";"}]," in my main nix config repo."]}],["$","p",null,{"children":"This is the main file that does the magic for what keys are valid for each secret"}],["$","div",null,{"className":"remark-code-title","children":"secrets.nix"}],["$","$L11",null,{"className":"shiki shiki-themes github-light github-dark","style":{"backgroundColor":"#fff","--shiki-dark-bg":"#24292e","color":"#24292e","--shiki-dark":"#e1e4e8"},"tabIndex":"0","children":["$","code",null,{"children":[["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"let"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#6a737d","--shiki-dark":"#6A737D"},"children":"  # all public keys in this file"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  githubKeys"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" ["}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#6a737d","--shiki-dark":"#6A737D"},"children":"    # https://github.com/jrmurr.keys"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#b31d28","--shiki-dark":"#FDAEB7","fontStyle":"italic","--shiki-dark-font-style":"italic"},"children":"    ..."}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"  ];"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#6a737d","--shiki-dark":"#6A737D"},"children":"  # ssh-keyscan <ip> or sudo cat /etc/ssh/ssh_host_ed25519_key.pub for root keys"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  linux-desktop"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    root"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"ssh-ed25519 ...\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    user"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"ssh-ed25519 ...\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"  };"}]}],"\n",["$","span",null,{"className":"line"}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  thicc-server"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    root"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"ssh-ed25519 ...\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    user"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"ssh-ed25519 ..\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"  };"}]}],"\n",["$","span",null,{"className":"line"}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  framework"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    root"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"ssh-ed25519 ...\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    user"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"ssh-ed25519 ...\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"  };"}]}],"\n",["$","span",null,{"className":"line"}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  hosts"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" [ "}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"linux-desktop"}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" thicc-server"}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" framework"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" ];"}]]}],"\n",["$","span",null,{"className":"line"}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  getUser"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" host: "}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"host"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"user"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  getRoot"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" host: "}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"host"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"root"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  getAllKeysForHost"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" host: [ ("}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"getUser"}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" host"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":") ("}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"getRoot"}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" host"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":") ];"}]]}],"\n",["$","span",null,{"className":"line"}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  knownUsers"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" ("}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":"builtins"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":"map"}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" getUser"}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" hosts"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":");"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  users"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" githubKeys"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ++"}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" knownUsers"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  systems"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" ("}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":"builtins"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":"map"}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" getRoot"}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" hosts"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":");"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  allKeys"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" users"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ++"}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" systems"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line"}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  serverSecretKeys"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" knownUsers"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ++"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" ["}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"    ("}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"getRoot"}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" thicc-server"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":")"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"  ]; "}],["$","span",null,{"style":{"color":"#6a737d","--shiki-dark":"#6A737D"},"children":"# allow all user keys to modify the thicc server secrets"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"in"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  \"jr-pass.age\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"publicKeys"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" allKeys"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  \"mopidy-spotify.age\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"publicKeys"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" allKeys"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line"}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  \"freshrss-user-pass.age\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"publicKeys"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" serverSecretKeys"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"  \"caddy-cloudflare.age\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"publicKeys"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" serverSecretKeys"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#6a737d","--shiki-dark":"#6A737D"},"children":"  # other stuff ..."}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"}"}]}],"\n",["$","span",null,{"className":"line"}]]}]}],["$","p",null,{"children":["so in the let block I define all my systems with their user keys and root system keys. Then some helper functions for getting a key I want from a host. Finally, I make a list of ",["$","code",null,{"children":"allKeys"}]," so every one of my user and root keys and encrypt/decrypt some common secrets like my user password and some API keys. The other list is ",["$","code",null,{"children":"serverSecretKeys"}]," which is the root key for my server (which has the most secrets) and all user keys. This lets me modify the secret on all my system, but the only root account to encrypt/decrypt is my server."]}],["$","p",null,{"children":["When I want to add a new secret I add a new file name in the ",["$","code",null,{"children":"attrset"}]," at the bottom of the file with the list of keys which are valid to encrypt/decrypt and run ",["$","code",null,{"children":"agenix -e <filename>"}],", once my editor closes the file will be created."]}],["$","h2",null,{"id":"managing-dotfiles-with-home-manager","children":[["$","a",null,{"href":"#managing-dotfiles-with-home-manager","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"Managing Dotfiles with Home Manager"]}],["$","p",null,{"children":"Everything I showed is dope for complex services you would run on a server, but what about dotfiles like my fish, git, and i3 config?"}],["$","p",null,{"children":["This is where ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://github.com/nix-community/home-manager","children":"Home Manager"}]," comes in. Home Manger gives you the NixOS module system for things that are configured in your user's home directory."]}],["$","p",null,{"children":"For example this"}],["$","$L11",null,{"className":"shiki shiki-themes github-light github-dark","style":{"backgroundColor":"#fff","--shiki-dark-bg":"#24292e","color":"#24292e","--shiki-dark":"#e1e4e8"},"tabIndex":"0","children":["$","code",null,{"children":[["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"{"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  home-manager"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"users"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"jr"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    programs"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"kitty"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"      enable"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" true"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"      shellIntegration"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"enableFishIntegration"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" true"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"      settings"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"        font_family"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"FiraCode Nerd Font\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"        bold_font"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"auto\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"        italic_font"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"auto\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"        bold_italic_font"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"auto\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"        enable_audio_bell"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" false"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"        scrollback_lines"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" -"}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":"1"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"        tab_bar_edge"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"top\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"        allow_remote_control"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"yes\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"        shell_integration"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"enabled\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"        macos_option_as_alt"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"yes\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"        shell"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"fish\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"      };"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"      theme"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"Dracula\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"    };"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"  };"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"}"}]}],"\n",["$","span",null,{"className":"line"}]]}]}],["$","p",null,{"children":["When home manager is run (as a NixOS module or stand alone), it will install ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://sw.kovidgoyal.net/kitty/","children":"kitty"}]," if we don't have it, and generate the kitty config file at ",["$","code",null,{"children":"~/.config/kitty/kitty.conf"}]," (for the user ",["$","code",null,{"children":"jr"}]," in this example), and since I set ",["$","code",null,{"children":"shellIntegration.enableFishIntegration"}],", it will add lines to my fish config to add kitty completions."]}],["$","p",null,{"children":"Personally I found Home Manager to be much more useful than \"normal\" NixOS at first, I had an annoying way of managing my dot files across machines and Home Manager simplified it greatly. It also works for macOS, so you can share cross-platform config easily."}],["$","p",null,{"children":["I put most of my Home Manager config into a separate ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://github.com/JRMurr/NixOsConfig/tree/main/common/homemanager","children":"home manager folder/module"}],", I then don't reference the ",["$","code",null,{"children":"home-manager.users.<username>"}]," prefix in any of those files. So for example in the kitty config above I only export ",["$","code",null,{"children":"programs.kitty = { ... }"}]," and not ",["$","code",null,{"children":"home-manager.users.jr.programs.kitty = {...}"}],". This lets me share the same home manager config for multiple NixOS users (if I wanted) and standalone home manager on macOS."]}],["$","p",null,{"children":"For example, my NixOS user has something like"}],["$","$L11",null,{"className":"shiki shiki-themes github-light github-dark","style":{"backgroundColor":"#fff","--shiki-dark-bg":"#24292e","color":"#24292e","--shiki-dark":"#e1e4e8"},"tabIndex":"0","children":["$","code",null,{"children":[["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"{"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"home-manager"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"users"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"jr"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" ("}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":"import"}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" ./hm.nix"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {});"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"}"}]}],"\n",["$","span",null,{"className":"line"}]]}]}],["$","p",null,{"children":["this will add all the options in ",["$","code",null,{"children":"jr-hm.nix"}]," under ",["$","code",null,{"children":"home-manager.users.jr"}]]}],["$","p",null,{"children":["and the ",["$","code",null,{"children":"hm.nix"}]," file will import my home manager module like so"]}],["$","div",null,{"className":"remark-code-title","children":"hm.nix"}],["$","$L11",null,{"className":"shiki shiki-themes github-light github-dark","style":{"backgroundColor":"#fff","--shiki-dark-bg":"#24292e","color":"#24292e","--shiki-dark":"#e1e4e8"},"tabIndex":"0","children":["$","code",null,{"children":[["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"{ "}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"... "}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"}: {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  imports"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" [ "}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":"../../homemanager"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" ];"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#6a737d","--shiki-dark":"#6A737D"},"children":"  # Everything in this file will be under home-manager.users.<name>"}]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#6a737d","--shiki-dark":"#6A737D"},"children":"  # https://rycee.gitlab.io/home-manager/options.html"}]}],"\n",["$","span",null,{"className":"line"}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  xdg"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"enable"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":" true"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line"}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#6a737d","--shiki-dark":"#6A737D"},"children":"  # https://nix-community.github.io/home-manager/release-notes.html#sec-release-22.11-highlights"}]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  home"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"stateVersion"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#032f62","--shiki-dark":"#9ECBFF"},"children":" \"18.09\""}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"}"}]}],"\n",["$","span",null,{"className":"line"}]]}]}],["$","p",null,{"children":["To see the real example see ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://github.com/JRMurr/NixOsConfig/blob/main/common/users/jr.nix","children":"here"}]]}],["$","h3",null,{"id":"home-manager-on-mac","children":[["$","a",null,{"href":"#home-manager-on-mac","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"Home Manager on Mac"]}],["$","p",null,{"children":["For macOS once you have nix installed you can follow ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://nix-community.github.io/home-manager/index.html#ch-nix-flakes","children":"this guide"}]," to enable flakes and do some home manager init if you don't have a config already."]}],["$","p",null,{"children":["For my case since I already had my NixOS flake, I just needed to add a new flake output ",["$","code",null,{"children":"homeConfiguration.<macOSUserName>"}],", see ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://github.com/JRMurr/NixOsConfig/blob/556f48bfa290185b595b71c4a8d2124efd0d851f/flake.nix#L170","children":"here"}]," for my setup."]}],["$","p",null,{"children":["Then you can run ",["$","code",null,{"children":"home-manager switch --flake <pathToFlake>#<macOSUserName>"}]," to install/update your config."]}],["$","p",null,{"children":["One thing to note when sharing config cross-platform is certain programs/options might not work on macOS, to gate that in your config you can use ",["$","code",null,{"children":"pkgs.stdenv.isDarwin"}]," which will be true on macOS and false elsewhere. The ",["$","code",null,{"children":"lib.mkIf"}]," function will let you conditionally add settings based on a condition. So for example to disable i3 on macOS you could do"]}],["$","div",null,{"className":"remark-code-title","children":"i3.nix"}],["$","$L11",null,{"className":"shiki shiki-themes github-light github-dark","style":{"backgroundColor":"#fff","--shiki-dark-bg":"#24292e","color":"#24292e","--shiki-dark":"#e1e4e8"},"tabIndex":"0","children":["$","code",null,{"children":[["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"{pkgs"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":",..."}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"}: {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"  config"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":" lib"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"mkIf"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" !"}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"pkgs"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"stdenv"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":"."}],["$","span",null,{"style":{"color":"#e36209","--shiki-dark":"#FFAB70"},"children":"isDarwin"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" {"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"    xsession"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"windowManager"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"."}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"i3"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":" { "}],["$","span",null,{"style":{"color":"#6f42c1","--shiki-dark":"#B392F0"},"children":"enable"}],["$","span",null,{"style":{"color":"#d73a49","--shiki-dark":"#F97583"},"children":" ="}],["$","span",null,{"style":{"color":"#005cc5","--shiki-dark":"#79B8FF"},"children":"true"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"; ...}"}]]}],"\n",["$","span",null,{"className":"line","children":[["$","span",null,{"style":{"color":"#b31d28","--shiki-dark":"#FDAEB7","fontStyle":"italic","--shiki-dark-font-style":"italic"},"children":"  }"}],["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":";"}]]}],"\n",["$","span",null,{"className":"line","children":["$","span",null,{"style":{"color":"#24292e","--shiki-dark":"#E1E4E8"},"children":"}"}]}],"\n",["$","span",null,{"className":"line"}]]}]}],["$","h2",null,{"id":"wrap-up","children":[["$","a",null,{"href":"#wrap-up","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"Wrap up"]}],["$","p",null,{"children":"NixOS + Home Manager feels like something from the future (even though nix is like 20 years old....). The freedom you have to change and experiment is amazing. I didn't even go into some other awesome features like system rollback, distributed builds, and making your own configuration options."}],["$","p",null,{"children":["If you want to give NixOS a shot I think ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://github.com/JRMurr/NixOsConfig/tree/main","children":"my config"}]," is hopefully easy to follow. Leave a comment if you want any help!"]}]]]}],["$","div",null,{"children":[["$","div",null,{"className":"pb-6 pt-6 text-sm text-gray-700 dark:text-gray-300","children":[["$","a",null,{"target":"_blank","rel":"nofollow","href":"https://mobile.twitter.com/search?q=https%3A%2F%2Fjohns.codes%2Fblog%2Forganizing-system-configs-with-nixos","children":"Discuss on Twitter"}]," • ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://github.com/JRMurr/JRMurr.github.io/blob/main/content/blog/organizing-system-configs-with-nixos.md","children":"View on GitHub"}]]}],["$","div",null,{"className":"pb-6 pt-6 text-center text-gray-700 dark:text-gray-300","id":"comment","children":["$","$L12",null,{}]}],"$undefined"]}]]}],["$","footer",null,{"children":["$","div",null,{"className":"flex flex-col text-sm font-medium sm:flex-row sm:justify-between sm:text-base","children":[["$","div",null,{"className":"pt-4 xl:pt-8","children":["$","$L9",null,{"href":"/blog/exposing-a-rust-library-to-node-with-napirs","className":"text-primary-500 hover:text-primary-600 dark:hover:text-primary-400","aria-label":"Previous post: Exposing a Rust Library to Node with Napi-rs","children":["← ","Exposing a Rust Library to Node with Napi-rs"]}]}],["$","div",null,{"className":"pt-4 xl:pt-8","children":["$","$L9",null,{"href":"/blog/efficient-nix-derivations-with-file-sets","className":"text-primary-500 hover:text-primary-600 dark:hover:text-primary-400","aria-label":"Next post: Efficient Nix Derivations with File Sets","children":["Efficient Nix Derivations with File Sets"," →"]}]}]]}]}]]}]]}]}]]}]]
e:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"Organizing system configs with NixOS | John's Codes"}],["$","meta","3",{"name":"description","content":"How I organize and manage my system and user configs with NixOS and homemanager"}],["$","meta","4",{"name":"robots","content":"index, follow"}],["$","meta","5",{"name":"googlebot","content":"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1"}],["$","link","6",{"rel":"canonical","href":"https://johns.codes/blog/organizing-system-configs-with-nixos"}],["$","link","7",{"rel":"alternate","type":"application/rss+xml","href":"https://johns.codes/feed.xml"}],["$","meta","8",{"property":"og:title","content":"Organizing system configs with NixOS"}],["$","meta","9",{"property":"og:description","content":"How I organize and manage my system and user configs with NixOS and homemanager"}],["$","meta","10",{"property":"og:url","content":"https://johns.codes/blog/organizing-system-configs-with-nixos"}],["$","meta","11",{"property":"og:site_name","content":"John's Codes"}],["$","meta","12",{"property":"og:locale","content":"en_US"}],["$","meta","13",{"property":"og:type","content":"article"}],["$","meta","14",{"property":"article:published_time","content":"2023-10-09T07:14:19.315Z"}],["$","meta","15",{"property":"article:modified_time","content":"2023-10-09T07:14:19.315Z"}],["$","meta","16",{"property":"article:author","content":"John Murray"}],["$","meta","17",{"name":"twitter:card","content":"summary_large_image"}],["$","meta","18",{"name":"twitter:title","content":"Organizing system configs with NixOS"}],["$","meta","19",{"name":"twitter:description","content":"How I organize and manage my system and user configs with NixOS and homemanager"}],["$","meta","20",{"name":"next-size-adjust"}]]
1:null
