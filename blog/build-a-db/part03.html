<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" content="#000000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');if("system"===e||(!e&&true)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><title>Building a Simple DB in Rust - Part 3 - Less Basic Execution</title><meta name="robots" content="follow, index"/><meta name="description" content="Cleaning up existing execution logic"/><meta property="og:url" content="https://johns.codes/blog/build-a-db/part03"/><meta property="og:type" content="article"/><meta property="og:site_name" content="John&#x27;s Codes"/><meta property="og:description" content="Cleaning up existing execution logic"/><meta property="og:title" content="Building a Simple DB in Rust - Part 3 - Less Basic Execution"/><meta property="og:image" content="https://johns.codes/static/images/twitter-card.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="https://twitter.com/JRMurrCodes"/><meta name="twitter:title" content="Building a Simple DB in Rust - Part 3 - Less Basic Execution"/><meta name="twitter:description" content="Cleaning up existing execution logic"/><meta name="twitter:image" content="https://johns.codes/static/images/twitter-card.png"/><meta property="article:published_time" content="2023-04-04T00:01:55.249Z"/><link rel="canonical" href="https://johns.codes/blog/build-a-db/part03"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://johns.codes/blog/build-a-db/part03"
  },
  "headline": "Building a Simple DB in Rust - Part 3 - Less Basic Execution",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://johns.codes/static/images/twitter-card.png"
    }
  ],
  "datePublished": "2023-04-04T00:01:55.249Z",
  "dateModified": "2023-04-04T00:01:55.249Z",
  "author": [
    {
      "@type": "Person",
      "name": "John Murray"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "John Murray",
    "logo": {
      "@type": "ImageObject",
      "url": "https://johns.codes/static/images/logo.png"
    }
  },
  "description": "Cleaning up existing execution logic"
}</script><meta name="next-head-count" content="20"/><link rel="preload" href="/_next/static/css/ff7a91e18d57a2d6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/ff7a91e18d57a2d6.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-a0fb203be75c9eb6.js" defer=""></script><script src="/_next/static/chunks/main-b77bb48dcc3828e6.js" defer=""></script><script src="/_next/static/chunks/pages/_app-861f57e6bedfde14.js" defer=""></script><script src="/_next/static/chunks/framework-327e104994690a53.js" defer=""></script><script src="/_next/static/chunks/675-374a5a75205d32da.js" defer=""></script><script src="/_next/static/chunks/266-365d5fff0af19ac8.js" defer=""></script><script src="/_next/static/chunks/545-446f5effbf4e5f11.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-c8a468ed53b4c5d2.js" defer=""></script><script src="/_next/static/VjYh7k8e50Akk-SVaYPII/_buildManifest.js" defer=""></script><script src="/_next/static/VjYh7k8e50Akk-SVaYPII/_ssgManifest.js" defer=""></script><script src="/_next/static/VjYh7k8e50Akk-SVaYPII/_middlewareManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap">@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuLyfMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuGKYMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuFuYMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body class="antialiased text-black bg-white dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex flex-col justify-between h-screen"><header class="flex items-center justify-between py-10"><div><a aria-label="John&#x27;s Codes" href="/"><div class="flex items-center justify-between"><div class="hidden h-6 text-2xl font-semibold sm:block">John&#x27;s Codes</div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/blog">Blog</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/tags">Tags</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/projects">Projects</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/about">About</a></div><button aria-label="Toggle Dark Mode" type="button" class="w-8 h-8 p-1 ml-1 mr-1 rounded sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button><div class="sm:hidden"><button type="button" class="w-8 h-8 py-1 ml-1 mr-1 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed w-full h-full top-24 right-0 bg-gray-200 dark:bg-gray-800 opacity-95 z-10 transform ease-in-out duration-300 translate-x-full"><button type="button" aria-label="toggle modal" class="fixed w-full h-full cursor-auto focus:outline-none"></button><nav class="fixed h-full mt-8"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog">Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">Tags</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/projects">Projects</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/about">About</a></div></nav></div></div></div></header><main class="mb-auto"><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-5xl xl:px-0"><div class="fixed flex-col hidden gap-3 right-8 bottom-8 md:hidden"><button aria-label="Scroll To Comment" type="button" class="p-2 text-gray-500 transition-all bg-gray-200 rounded-full dark:text-gray-400 dark:bg-gray-700 dark:hover:bg-gray-600 hover:bg-gray-300"><svg class="w-5 h-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"></path></svg></button><button aria-label="Scroll To Top" type="button" class="p-2 text-gray-500 transition-all bg-gray-200 rounded-full dark:text-gray-400 dark:bg-gray-700 dark:hover:bg-gray-600 hover:bg-gray-300"><svg class="w-5 h-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-4 md:space-y-2 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="flex justify-center items-center text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2023-04-04T00:01:55.249Z">Tuesday, April 4, 2023</time><span class="mx-2">-</span><div class="flex items-center"><span class="ml-1">6 min read</span></div></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">Building a Simple DB in Rust - Part 3 - Less Basic Execution</h1></div></div></header><div class="pb-8 divide-y divide-gray-200 xl:divide-y-0 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6" style="grid-template-rows:auto 1fr"><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:pb-0 xl:col-span-4 xl:row-span-2"><div class="pt-10 pb-8 prose dark:prose-dark max-w-none"><div class="pb-2"><p>This article is part of the <!-- -->Building a Simple DB in Rust<!-- --> series.</p><select class="block w-3/12 px-4 py-2 text-gray-900 bg-white border border-gray-300 rounded-md dark:border-gray-900 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-800 dark:text-gray-100"><option value="/blog/build-a-db/part01">Part 1 - Parsing</option><option value="/blog/build-a-db/part02">Part 2 - Basic Execution</option><option selected="" value="/blog/build-a-db/part03">Part 3 - Less Basic Execution</option></select></div><details open=""><summary class="pt-2 pb-2 ml-6 text-xl font-bold">Table of Contents</summary><div class="ml-6"><ul><li class="false"><a href="#where-we-left-off">Where we left off</a></li><li class="false"><a href="#actually-selecting-columns">Actually selecting columns</a></li><li class="false"><a href="#for-real-lets-do-a-select">For real let&#x27;s do a select</a></li><li class="false"><a href="#doing-type-checking">Doing type checking</a></li><li class="false"><a href="#wrap-up">Wrap up</a></li></ul></div></details>
<h1 id="where-we-left-off"><a href="#where-we-left-off" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Where we left off</h1>
<p>In the last post we ended up with extremely basic query execution. We could parse queries, update our tables in memory, and read full tables back;
all while having decent error messages throughout.</p>
<p>While that was a great milestone it leaves a lot to be desired</p>
<ul>
<li>While we parse columns in select queries, we never actually project/use them, so you always get all the columns back</li>
<li>We aren&#x27;t validating types on insert, so the column types mean nothing</li>
</ul>
<p>So those main points are what I want to tackle for this post</p>
<div class="grid place-content-center"><div class="dark:bg-gray-800 bg-gray-100 rounded"><div class="box-content px-3 py-0"><p>This post is much less of a tutorial/guide than the previous posts. I needed to cleanup what I have so the changes are pretty straightforward, small, and all over. Check the <a target="_blank" rel="noopener noreferrer" href="https://github.com/JRMurr/SQLJr">repo</a> for more detailed changes.</p></div></div></div>
<h1 id="actually-selecting-columns"><a href="#actually-selecting-columns" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Actually selecting columns</h1>
<p>For a refresher, here&#x27;s what the select response looks like</p>
<div class="relative"><pre class="shiki dracula"><div class="language-id">rust</div><div class="code-container"><code><div class="line"><span style="color:#FF79C6">pub</span><span style="color:#F8F8F2"> </span><span style="color:#FF79C6">enum</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">ExecResponse</span><span style="color:#F8F8F2">&lt;&#x27;</span><span style="color:#8BE9FD">a</span><span style="color:#F8F8F2">&gt; {</span></div><div class="line"><span style="color:#F8F8F2">    </span><span style="color:#50FA7B">Select</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">Vec</span><span style="color:#F8F8F2">&lt;</span><span style="color:#8BE9FD">Row</span><span style="color:#F8F8F2">&lt;&#x27;</span><span style="color:#8BE9FD">a</span><span style="color:#F8F8F2">&gt;&gt;),</span></div><div class="line"><span style="color:#F8F8F2">    </span><span style="color:#8BE9FD">Insert</span><span style="color:#F8F8F2">,</span></div><div class="line"><span style="color:#F8F8F2">    </span><span style="color:#8BE9FD">Create</span><span style="color:#F8F8F2">,</span></div><div class="line"><span style="color:#F8F8F2">}</span></div><div class="line"></div><div class="line"><span style="color:#FF79C6">pub</span><span style="color:#F8F8F2"> </span><span style="color:#FF79C6">struct</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">Row</span><span style="color:#F8F8F2">&lt;&#x27;</span><span style="color:#8BE9FD">a</span><span style="color:#F8F8F2">&gt; {</span></div><div class="line"><span style="color:#F8F8F2">    id</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">usize</span><span style="color:#F8F8F2">,</span></div><div class="line"><span style="color:#F8F8F2">    columns</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">Rc</span><span style="color:#F8F8F2">&lt;</span><span style="color:#8BE9FD">ColumnInfo</span><span style="color:#F8F8F2">&gt;,</span></div><div class="line"><span style="color:#F8F8F2">    data</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> </span><span style="color:#FF79C6">&amp;</span><span style="color:#F8F8F2">&#x27;</span><span style="color:#8BE9FD">a</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">HashMap</span><span style="color:#F8F8F2">&lt;</span><span style="color:#8BE9FD">String</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">String</span><span style="color:#F8F8F2">&gt;,</span><span style="color:#6272A4"> // reference to the actual row in the table struct</span></div><div class="line"><span style="color:#F8F8F2">}</span></div></code></div></pre></div>
<p>So the select response is just a <code>Vec</code> over rows, each row holding info on the columns of the table and the data for that row.</p>
<p>There&#x27;s a few things not great about this</p>
<ul>
<li>Why return a <code>Vec</code> when we could just return an iterator, the consumer is going to iterate over it anyway</li>
<li>The select response does not return any column info outside of the rows, so empty results would not give any column info</li>
<li>The data in the row is just a reference to the table, not horrible for <code>select *</code> but need to modify it to only hold the columns we care about
<ul>
<li>We probably will update this type over time to reduce space but for now we&#x27;ll stick with a hash map</li>
</ul>
</li>
</ul>
<p>To address the first 2 issues, we can just return our existing <code>TableIter</code> struct, this is an iterator, and it holds column info</p>
<div class="relative"><pre class="shiki dracula"><div class="language-id">rust</div><div class="code-container"><code><div class="line"><span style="color:#FF79C6">pub</span><span style="color:#F8F8F2"> </span><span style="color:#FF79C6">enum</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">ExecResponse</span><span style="color:#F8F8F2">&lt;&#x27;</span><span style="color:#8BE9FD">a</span><span style="color:#F8F8F2">&gt; {</span></div><div class="line"><span style="color:#F8F8F2">    </span><span style="color:#50FA7B">Select</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">TableIter</span><span style="color:#F8F8F2">&lt;&#x27;</span><span style="color:#8BE9FD">a</span><span style="color:#F8F8F2">&gt;),</span></div><div class="line"><span style="color:#F8F8F2">    </span><span style="color:#8BE9FD">Insert</span><span style="color:#F8F8F2">,</span></div><div class="line"><span style="color:#F8F8F2">    </span><span style="color:#8BE9FD">Create</span><span style="color:#F8F8F2">,</span></div><div class="line"><span style="color:#F8F8F2">}</span></div></code></div></pre></div>
<h2 id="for-real-lets-do-a-select"><a href="#for-real-lets-do-a-select" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>For real let&#x27;s do a select</h2>
<p>We didn&#x27;t actually have a select function on <code>Table</code> before, so let&#x27;s add one that&#x27;s validates the columns we pass in actually exist</p>
<div class="remark-code-title">table.rs</div>
<div class="relative"><pre class="shiki dracula"><div class="language-id">rust</div><div class="code-container"><code><div class="line"><span style="color:#F8F8F2">#[derive(</span><span style="color:#8BE9FD">Debug</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">Clone</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">Default</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">Serialize</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">Deserialize</span><span style="color:#F8F8F2">, derive_more</span><span style="color:#FF79C6">::</span><span style="color:#8BE9FD">From</span><span style="color:#F8F8F2">)]</span></div><div class="line"><span style="color:#FF79C6">pub</span><span style="color:#F8F8F2"> </span><span style="color:#FF79C6">struct</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">ColumnInfo</span><span style="color:#F8F8F2"> {</span></div><div class="line"><span style="color:#F8F8F2">    columns</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">Vec</span><span style="color:#F8F8F2">&lt;</span><span style="color:#8BE9FD">Column</span><span style="color:#F8F8F2">&gt;,</span></div><div class="line"><span style="color:#F8F8F2">}</span></div><div class="line"></div><div class="line"><span style="color:#FF79C6">impl</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">ColumnInfo</span><span style="color:#F8F8F2"> {</span></div><div class="line"><span style="color:#F8F8F2">    </span><span style="color:#FF79C6">pub</span><span style="color:#F8F8F2"> </span><span style="color:#FF79C6">fn</span><span style="color:#F8F8F2"> </span><span style="color:#50FA7B">iter</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">&amp;</span><span style="color:#BD93F9">self</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">-&gt;</span><span style="color:#F8F8F2"> </span><span style="color:#FF79C6">impl</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">Iterator</span><span style="color:#F8F8F2">&lt;</span><span style="color:#8BE9FD">Item</span><span style="color:#F8F8F2"> </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> </span><span style="color:#FF79C6">&amp;</span><span style="color:#8BE9FD">Column</span><span style="color:#F8F8F2">&gt; {</span></div><div class="line"><span style="color:#F8F8F2">        </span><span style="color:#BD93F9">self</span><span style="color:#FF79C6">.</span><span style="color:#F8F8F2">columns</span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">iter</span><span style="color:#F8F8F2">()</span></div><div class="line"><span style="color:#F8F8F2">    }</span></div><div class="line"></div><div class="line"><span style="color:#F8F8F2">    </span><span style="color:#FF79C6">pub</span><span style="color:#F8F8F2"> </span><span style="color:#FF79C6">fn</span><span style="color:#F8F8F2"> </span><span style="color:#50FA7B">find_column</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">&amp;</span><span style="color:#BD93F9">self</span><span style="color:#F8F8F2">, column_name</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> </span><span style="color:#FF79C6">&amp;</span><span style="color:#8BE9FD">String</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">-&gt;</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">Result</span><span style="color:#F8F8F2">&lt;</span><span style="color:#FF79C6">&amp;</span><span style="color:#8BE9FD">Column</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">QueryExecutionError</span><span style="color:#F8F8F2">&gt; {</span></div><div class="line"><span style="color:#F8F8F2">        </span><span style="color:#BD93F9">self</span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">iter</span><span style="color:#F8F8F2">()</span></div><div class="line"><span style="color:#F8F8F2">            </span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">find</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">|</span><span style="color:#F8F8F2">col</span><span style="color:#FF79C6">|</span><span style="color:#F8F8F2"> col</span><span style="color:#FF79C6">.</span><span style="color:#F8F8F2">name </span><span style="color:#FF79C6">==</span><span style="color:#F8F8F2"> </span><span style="color:#FF79C6">*</span><span style="color:#F8F8F2">column_name)</span></div><div class="line"><span style="color:#F8F8F2">            </span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">ok_or_else</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">||</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">QueryExecutionError</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">ColumnDoesNotExist</span><span style="color:#F8F8F2">(column_name</span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">to_owned</span><span style="color:#F8F8F2">()))</span></div><div class="line"><span style="color:#F8F8F2">    }</span></div><div class="line"><span style="color:#F8F8F2">}</span></div><div class="line"></div><div class="line"><span style="color:#6272A4">// Also updated Table.columns to be `ColumnInfo` instead of Vec&lt;Column&gt;</span></div><div class="line"></div><div class="line"><span style="color:#FF79C6">impl</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">Table</span><span style="color:#F8F8F2"> {</span></div><div class="line"><span style="color:#F8F8F2">    </span><span style="color:#FF79C6">pub</span><span style="color:#F8F8F2"> </span><span style="color:#FF79C6">fn</span><span style="color:#F8F8F2"> </span><span style="color:#50FA7B">select</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">&amp;</span><span style="color:#BD93F9">self</span><span style="color:#F8F8F2">, columns</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">Vec</span><span style="color:#F8F8F2">&lt;</span><span style="color:#8BE9FD">String</span><span style="color:#F8F8F2">&gt;) </span><span style="color:#FF79C6">-&gt;</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">Result</span><span style="color:#F8F8F2">&lt;</span><span style="color:#8BE9FD">TableIter</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">QueryExecutionError</span><span style="color:#F8F8F2">&gt; {</span></div><div class="line"><span style="color:#F8F8F2">        </span><span style="color:#FF79C6">let</span><span style="color:#F8F8F2"> selected_columns </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> columns</span></div><div class="line"><span style="color:#F8F8F2">            </span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">into_iter</span><span style="color:#F8F8F2">()</span></div><div class="line"><span style="color:#F8F8F2">            </span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">map</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">|</span><span style="color:#F8F8F2">column_name</span><span style="color:#FF79C6">|</span><span style="color:#F8F8F2"> {</span></div><div class="line"><span style="color:#F8F8F2">                </span><span style="color:#BD93F9">self</span><span style="color:#FF79C6">.</span><span style="color:#F8F8F2">columns</span></div><div class="line"><span style="color:#F8F8F2">                    </span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">find_column</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">&amp;</span><span style="color:#F8F8F2">column_name)</span></div><div class="line"><span style="color:#F8F8F2">                    </span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">map</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">|</span><span style="color:#F8F8F2">col</span><span style="color:#FF79C6">|</span><span style="color:#F8F8F2"> col</span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">clone</span><span style="color:#F8F8F2">())</span></div><div class="line"><span style="color:#F8F8F2">            })</span></div><div class="line"><span style="color:#F8F8F2">            </span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">collect</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">&lt;</span><span style="color:#8BE9FD">Result</span><span style="color:#F8F8F2">&lt;</span><span style="color:#8BE9FD">Vec</span><span style="color:#F8F8F2">&lt;_&gt;, _&gt;&gt;()</span><span style="color:#FF79C6">?</span><span style="color:#F8F8F2">;</span></div><div class="line"></div><div class="line"><span style="color:#F8F8F2">        </span><span style="color:#FF79C6">let</span><span style="color:#F8F8F2"> col_info</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">Rc</span><span style="color:#F8F8F2">&lt;</span><span style="color:#8BE9FD">ColumnInfo</span><span style="color:#F8F8F2">&gt; </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">Rc</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">new</span><span style="color:#F8F8F2">(selected_columns</span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">into</span><span style="color:#F8F8F2">());</span></div><div class="line"></div><div class="line"><span style="color:#F8F8F2">        </span><span style="color:#8BE9FD">Ok</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">TableIter</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">new</span><span style="color:#F8F8F2">(</span><span style="color:#BD93F9">self</span><span style="color:#FF79C6">.</span><span style="color:#F8F8F2">rows</span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">iter</span><span style="color:#F8F8F2">(), col_info))</span></div><div class="line"><span style="color:#F8F8F2">    }</span></div><div class="line"><span style="color:#F8F8F2">}</span></div></code></div></pre></div>
<p>Since the select function validates all the columns exist, the iterator can avoid the same error checking like so</p>
<div class="remark-code-title">table.rs</div>
<div class="relative"><pre class="shiki dracula"><div class="language-id">rust</div><div class="code-container"><code><div class="line"><span style="color:#FF79C6">impl</span><span style="color:#F8F8F2">&lt;&#x27;</span><span style="color:#8BE9FD">a</span><span style="color:#F8F8F2">&gt; </span><span style="color:#8BE9FD">Iterator</span><span style="color:#F8F8F2"> </span><span style="color:#FF79C6">for</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">TableIter</span><span style="color:#F8F8F2">&lt;&#x27;</span><span style="color:#8BE9FD">a</span><span style="color:#F8F8F2">&gt; {</span></div><div class="line"><span style="color:#F8F8F2">    </span><span style="color:#FF79C6">type</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">Item</span><span style="color:#F8F8F2"> </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">Row</span><span style="color:#F8F8F2">&lt;&#x27;</span><span style="color:#8BE9FD">a</span><span style="color:#F8F8F2">&gt;;</span></div><div class="line"></div><div class="line"><span style="color:#F8F8F2">    </span><span style="color:#FF79C6">fn</span><span style="color:#F8F8F2"> </span><span style="color:#50FA7B">next</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">&amp;mut</span><span style="color:#F8F8F2"> </span><span style="color:#BD93F9">self</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">-&gt;</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">Option</span><span style="color:#F8F8F2">&lt;</span><span style="color:#BD93F9">Self</span><span style="color:#FF79C6">::</span><span style="color:#8BE9FD">Item</span><span style="color:#F8F8F2">&gt; {</span></div><div class="line"><span style="color:#F8F8F2">        </span><span style="color:#BD93F9">self</span><span style="color:#FF79C6">.</span><span style="color:#F8F8F2">map_iter</span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">next</span><span style="color:#F8F8F2">()</span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">map</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">|</span><span style="color:#F8F8F2">(id, data)</span><span style="color:#FF79C6">|</span><span style="color:#F8F8F2"> {</span></div><div class="line"><span style="color:#F8F8F2">            </span><span style="color:#FF79C6">let</span><span style="color:#F8F8F2"> projected_data </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> data</span></div><div class="line"><span style="color:#F8F8F2">                </span><span style="color:#FF79C6">.</span><span style="color:#F8F8F2">data</span><span style="color:#6272A4"> // the stored row hashmap</span></div><div class="line"><span style="color:#F8F8F2">                </span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">iter</span><span style="color:#F8F8F2">()</span></div><div class="line"><span style="color:#F8F8F2">                </span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">filter_map</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">|</span><span style="color:#F8F8F2">(key, value)</span><span style="color:#FF79C6">|</span><span style="color:#F8F8F2"> </span><span style="color:#BD93F9">self</span><span style="color:#FF79C6">.</span><span style="color:#F8F8F2">columns</span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">find_column</span><span style="color:#F8F8F2">(key)</span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">ok</span><span style="color:#F8F8F2">()</span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">map</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">|</span><span style="color:#F8F8F2">_</span><span style="color:#FF79C6">|</span><span style="color:#F8F8F2"> (key, value)))</span></div><div class="line"><span style="color:#F8F8F2">                </span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">collect</span><span style="color:#F8F8F2">();</span></div><div class="line"></div><div class="line"><span style="color:#F8F8F2">            </span><span style="color:#8BE9FD">Row</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">new</span><span style="color:#F8F8F2">(</span><span style="color:#BD93F9">self</span><span style="color:#FF79C6">.</span><span style="color:#F8F8F2">columns</span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">clone</span><span style="color:#F8F8F2">(), </span><span style="color:#FF79C6">*</span><span style="color:#F8F8F2">id, projected_data)</span></div><div class="line"><span style="color:#F8F8F2">        })</span></div><div class="line"><span style="color:#F8F8F2">    }</span></div><div class="line"><span style="color:#F8F8F2">}</span></div></code></div></pre></div>
<p>All the iterator does is go over the stored table&#x27;s b-tree, for each row it filters the hash map of row data to only the columns we selected.</p>
<h1 id="doing-type-checking"><a href="#doing-type-checking" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Doing type checking</h1>
<p>Right now we track column types when you create tables</p>
<div class="relative"><pre class="shiki dracula"><div class="language-id">sql</div><div class="code-container"><code><div class="line"><span style="color:#FF79C6">CREATE</span><span style="color:#F8F8F2"> </span><span style="color:#FF79C6">TABLE</span><span style="color:#F8F8F2"> foo (</span></div><div class="line"><span style="color:#F8F8F2">    col1 </span><span style="color:#FF79C6">int</span><span style="color:#F8F8F2">,</span></div><div class="line"><span style="color:#F8F8F2">    col2 string</span></div><div class="line"><span style="color:#F8F8F2">);</span></div></code></div></pre></div>
<p>but we can just throw anything in there</p>
<div class="relative"><pre class="shiki dracula"><div class="language-id">sql</div><div class="code-container"><code><div class="line"><span style="color:#FF79C6">INSERT</span><span style="color:#F8F8F2"> </span><span style="color:#FF79C6">INTO</span><span style="color:#F8F8F2"> foo</span></div><div class="line"><span style="color:#F8F8F2">    </span><span style="color:#FF79C6">VALUES</span></div><div class="line"><span style="color:#F8F8F2">        thisIsNotAnInt, </span><span style="color:#BD93F9">3</span></div></code></div></pre></div>
<p>to have proper type checking we first need to update the insert statement to be type aware (instead of having every value be strings).</p>
<p>So let&#x27;s make a SQL value type</p>
<div class="remark-code-title">parser/value.rs</div>
<div class="relative"><pre class="shiki dracula"><div class="language-id">rust</div><div class="code-container"><code><div class="line"><span style="color:#F8F8F2">#[derive(</span><span style="color:#8BE9FD">Debug</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">Clone</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">PartialEq</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">Eq</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">Hash</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">Serialize</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">Deserialize</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">Display</span><span style="color:#F8F8F2">)]</span></div><div class="line"><span style="color:#FF79C6">pub</span><span style="color:#F8F8F2"> </span><span style="color:#FF79C6">enum</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">Value</span><span style="color:#F8F8F2"> {</span></div><div class="line"><span style="color:#F8F8F2">    </span><span style="color:#50FA7B">Number</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">BigDecimal</span><span style="color:#F8F8F2">),</span></div><div class="line"><span style="color:#F8F8F2">    </span><span style="color:#50FA7B">String</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">String</span><span style="color:#F8F8F2">),</span></div><div class="line"><span style="color:#F8F8F2">}</span></div></code></div></pre></div>
<p>Here we just make an enum of what types/values we support in our SQL language. Here I decided to have one number representation with <code>BigDecimal</code>
instead of having <code>Int</code>/<code>Float</code> types. Eventually I will, I&#x27;m just getting the basics in.</p>
<p>Now we need to parse these values</p>
<div class="remark-code-title">parser/value.rs</div>
<div class="relative"><pre class="shiki dracula"><div class="language-id">rust</div><div class="code-container"><code><div class="line"><span style="color:#6272A4">/// Parse a single quoted string value</span></div><div class="line"><span style="color:#FF79C6">fn</span><span style="color:#F8F8F2"> </span><span style="color:#50FA7B">parse_string_value</span><span style="color:#F8F8F2">(input</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">RawSpan</span><span style="color:#F8F8F2">&lt;&#x27;</span><span style="color:#8BE9FD">_</span><span style="color:#F8F8F2">&gt;) </span><span style="color:#FF79C6">-&gt;</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">ParseResult</span><span style="color:#F8F8F2">&lt;&#x27;</span><span style="color:#8BE9FD">_</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">Value</span><span style="color:#F8F8F2">&gt; {</span></div><div class="line"><span style="color:#6272A4">    // TODO: look into https://github.com/rust-bakery/nom/blob/main/examples/string.rs</span></div><div class="line"><span style="color:#6272A4">    // for escaped strings</span></div><div class="line"><span style="color:#F8F8F2">    </span><span style="color:#FF79C6">let</span><span style="color:#F8F8F2"> (remaining, (_, str_value, _)) </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> </span><span style="color:#50FA7B">context</span><span style="color:#F8F8F2">(</span></div><div class="line"><span style="color:#F8F8F2">        </span><span style="color:#F1FA8C">&quot;String Literal&quot;</span><span style="color:#F8F8F2">,</span></div><div class="line"><span style="color:#F8F8F2">        </span><span style="color:#50FA7B">tuple</span><span style="color:#F8F8F2">((</span></div><div class="line"><span style="color:#F8F8F2">            </span><span style="color:#50FA7B">tag</span><span style="color:#F8F8F2">(</span><span style="color:#F1FA8C">&quot;&#x27;&quot;</span><span style="color:#F8F8F2">),</span></div><div class="line"><span style="color:#F8F8F2">            </span><span style="color:#50FA7B">take_until</span><span style="color:#F8F8F2">(</span><span style="color:#F1FA8C">&quot;&#x27;&quot;</span><span style="color:#F8F8F2">)</span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">map</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">|</span><span style="color:#F8F8F2">s</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">RawSpan</span><span style="color:#FF79C6">|</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">Value</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">String</span><span style="color:#F8F8F2">(s</span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">fragment</span><span style="color:#F8F8F2">()</span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">to_string</span><span style="color:#F8F8F2">())),</span></div><div class="line"><span style="color:#F8F8F2">            </span><span style="color:#50FA7B">tag</span><span style="color:#F8F8F2">(</span><span style="color:#F1FA8C">&quot;&#x27;&quot;</span><span style="color:#F8F8F2">),</span><span style="color:#6272A4"> // take_until does not consume the ending quote</span></div><div class="line"><span style="color:#F8F8F2">        )),</span></div><div class="line"><span style="color:#F8F8F2">    )(input)</span><span style="color:#FF79C6">?</span><span style="color:#F8F8F2">;</span></div><div class="line"></div><div class="line"><span style="color:#F8F8F2">    </span><span style="color:#8BE9FD">Ok</span><span style="color:#F8F8F2">((remaining, str_value))</span></div><div class="line"><span style="color:#F8F8F2">}</span></div><div class="line"></div><div class="line"><span style="color:#6272A4">/// Parse a numeric literal</span></div><div class="line"><span style="color:#FF79C6">fn</span><span style="color:#F8F8F2"> </span><span style="color:#50FA7B">parse_number_value</span><span style="color:#F8F8F2">(input</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">RawSpan</span><span style="color:#F8F8F2">&lt;&#x27;</span><span style="color:#8BE9FD">_</span><span style="color:#F8F8F2">&gt;) </span><span style="color:#FF79C6">-&gt;</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">ParseResult</span><span style="color:#F8F8F2">&lt;&#x27;</span><span style="color:#8BE9FD">_</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">Value</span><span style="color:#F8F8F2">&gt; {</span></div><div class="line"><span style="color:#F8F8F2">    </span><span style="color:#FF79C6">let</span><span style="color:#F8F8F2"> (remaining, digits) </span><span style="color:#FF79C6">=</span></div><div class="line"><span style="color:#F8F8F2">        </span><span style="color:#50FA7B">context</span><span style="color:#F8F8F2">(</span><span style="color:#F1FA8C">&quot;Number Literal&quot;</span><span style="color:#F8F8F2">, </span><span style="color:#50FA7B">take_while</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">|</span><span style="color:#F8F8F2">c</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">char</span><span style="color:#FF79C6">|</span><span style="color:#F8F8F2"> c</span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">is_numeric</span><span style="color:#F8F8F2">()))(input)</span><span style="color:#FF79C6">?</span><span style="color:#F8F8F2">;</span><span style="color:#6272A4"> // TODO: handle floats</span></div><div class="line"></div><div class="line"><span style="color:#F8F8F2">    </span><span style="color:#FF79C6">let</span><span style="color:#F8F8F2"> digits </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> digits</span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">fragment</span><span style="color:#F8F8F2">();</span></div><div class="line"></div><div class="line"><span style="color:#F8F8F2">    </span><span style="color:#8BE9FD">Ok</span><span style="color:#F8F8F2">((</span></div><div class="line"><span style="color:#F8F8F2">        remaining,</span></div><div class="line"><span style="color:#F8F8F2">        </span><span style="color:#8BE9FD">Value</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">Number</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">BigDecimal</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">from_str</span><span style="color:#F8F8F2">(digits)</span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">unwrap</span><span style="color:#F8F8F2">()),</span></div><div class="line"><span style="color:#F8F8F2">    ))</span></div><div class="line"><span style="color:#F8F8F2">}</span></div><div class="line"></div><div class="line"><span style="color:#FF79C6">impl</span><span style="color:#F8F8F2">&lt;&#x27;</span><span style="color:#8BE9FD">a</span><span style="color:#F8F8F2">&gt; </span><span style="color:#8BE9FD">Parse</span><span style="color:#F8F8F2">&lt;&#x27;</span><span style="color:#8BE9FD">a</span><span style="color:#F8F8F2">&gt; </span><span style="color:#FF79C6">for</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">Value</span><span style="color:#F8F8F2"> {</span></div><div class="line"><span style="color:#F8F8F2">    </span><span style="color:#FF79C6">fn</span><span style="color:#F8F8F2"> </span><span style="color:#50FA7B">parse</span><span style="color:#F8F8F2">(input</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">RawSpan</span><span style="color:#F8F8F2">&lt;&#x27;</span><span style="color:#8BE9FD">a</span><span style="color:#F8F8F2">&gt;) </span><span style="color:#FF79C6">-&gt;</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">ParseResult</span><span style="color:#F8F8F2">&lt;&#x27;</span><span style="color:#8BE9FD">a</span><span style="color:#F8F8F2">, </span><span style="color:#BD93F9">Self</span><span style="color:#F8F8F2">&gt; {</span></div><div class="line"><span style="color:#F8F8F2">        </span><span style="color:#50FA7B">context</span><span style="color:#F8F8F2">(</span></div><div class="line"><span style="color:#F8F8F2">            </span><span style="color:#F1FA8C">&quot;Value&quot;</span><span style="color:#F8F8F2">,</span></div><div class="line"><span style="color:#F8F8F2">            </span><span style="color:#50FA7B">preceded</span><span style="color:#F8F8F2">(</span></div><div class="line"><span style="color:#F8F8F2">                multispace0,</span></div><div class="line"><span style="color:#F8F8F2">                </span><span style="color:#50FA7B">terminated</span><span style="color:#F8F8F2">(</span></div><div class="line"><span style="color:#6272A4">                    // peek_then_cut will give better errors so if we see</span></div><div class="line"><span style="color:#6272A4">                    // a quote we knows to only try to parse a string</span></div><div class="line"><span style="color:#F8F8F2">                    </span><span style="color:#50FA7B">alt</span><span style="color:#F8F8F2">((</span><span style="color:#50FA7B">peek_then_cut</span><span style="color:#F8F8F2">(</span><span style="color:#F1FA8C">&quot;&#x27;&quot;</span><span style="color:#F8F8F2">, parse_string_value), parse_number_value)),</span></div><div class="line"><span style="color:#F8F8F2">                    multispace0,</span></div><div class="line"><span style="color:#F8F8F2">                ),</span></div><div class="line"><span style="color:#F8F8F2">            ),</span></div><div class="line"><span style="color:#F8F8F2">        )(input)</span></div><div class="line"><span style="color:#F8F8F2">    }</span></div><div class="line"><span style="color:#F8F8F2">}</span></div></code></div></pre></div>
<p>The parsing logic is mostly straightforward, the main weirdness you might be confused by is why the calls to <code>.fragment()</code>? That is because the input to the parse functions is a <code>RawSpan</code>, you need to call <code>fragment()</code> to get the actual string from the span.</p>
<p>Now when we wants strings we will need to quote them like <code>&quot;aString&quot;</code></p>
<p>Now that we have this value type, we need to replace all our string values with this new type. This change was sorta all over, if you want a good diff this <a target="_blank" rel="noopener noreferrer" href="https://github.com/JRMurr/SQLJr/commit/55d66244a573a371983d75534b99577035ead478#diff-01c60d528deeaabdcb2502648bce756b7aa879d131d966016939ca85de7a039c">commit</a> has the needed changes for that. This is still probably a little wasteful representation, but it starts us on the path to better types and performance.</p>
<p>We can now check the value on insert and see if it lines up with the given column&#x27;s data type</p>
<div class="remark-code-title">table.rs</div>
<div class="relative"><pre class="shiki dracula"><div class="language-id">rust</div><div class="code-container"><code><div class="line"><span style="color:#FF79C6">impl</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">Table</span><span style="color:#F8F8F2"> {</span></div><div class="line"><span style="color:#F8F8F2">    </span><span style="color:#FF79C6">pub</span><span style="color:#F8F8F2"> </span><span style="color:#FF79C6">fn</span><span style="color:#F8F8F2"> </span><span style="color:#50FA7B">insert</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">&amp;mut</span><span style="color:#F8F8F2"> </span><span style="color:#BD93F9">self</span><span style="color:#F8F8F2">, values</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">Vec</span><span style="color:#F8F8F2">&lt;</span><span style="color:#8BE9FD">Value</span><span style="color:#F8F8F2">&gt;) </span><span style="color:#FF79C6">-&gt;</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">Result</span><span style="color:#F8F8F2">&lt;(), </span><span style="color:#8BE9FD">QueryExecutionError</span><span style="color:#F8F8F2">&gt; {</span></div><div class="line"><span style="color:#F8F8F2">        </span><span style="color:#FF79C6">let</span><span style="color:#F8F8F2"> id </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> </span><span style="color:#BD93F9">self</span></div><div class="line"><span style="color:#F8F8F2">            </span><span style="color:#FF79C6">.</span><span style="color:#F8F8F2">rows</span></div><div class="line"><span style="color:#F8F8F2">            </span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">last_key_value</span><span style="color:#F8F8F2">()</span></div><div class="line"><span style="color:#F8F8F2">            </span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">map_or</span><span style="color:#F8F8F2">(</span><span style="color:#BD93F9">0</span><span style="color:#F8F8F2">, </span><span style="color:#FF79C6">|</span><span style="color:#F8F8F2">(max_id, _)</span><span style="color:#FF79C6">|</span><span style="color:#F8F8F2"> max_id </span><span style="color:#FF79C6">+</span><span style="color:#F8F8F2"> </span><span style="color:#BD93F9">1</span><span style="color:#F8F8F2">);</span></div><div class="line"></div><div class="line"><span style="color:#F8F8F2">        </span><span style="color:#FF79C6">let</span><span style="color:#F8F8F2"> row </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> values</span></div><div class="line"><span style="color:#F8F8F2">            </span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">into_iter</span><span style="color:#F8F8F2">()</span></div><div class="line"><span style="color:#F8F8F2">            </span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">zip</span><span style="color:#F8F8F2">(</span><span style="color:#BD93F9">self</span><span style="color:#FF79C6">.</span><span style="color:#F8F8F2">columns</span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">iter</span><span style="color:#F8F8F2">())</span></div><div class="line"><span style="color:#F8F8F2">            </span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">map</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">|</span><span style="color:#F8F8F2">(value, col)</span><span style="color:#FF79C6">|</span><span style="color:#F8F8F2"> </span><span style="color:#FF79C6">match</span><span style="color:#F8F8F2"> (col</span><span style="color:#FF79C6">.</span><span style="color:#F8F8F2">type_info, value) {</span></div><div class="line"><span style="color:#F8F8F2">                (</span><span style="color:#8BE9FD">SqlTypeInfo</span><span style="color:#FF79C6">::</span><span style="color:#8BE9FD">String</span><span style="color:#F8F8F2">, v </span><span style="color:#FF79C6">@</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">Value</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">String</span><span style="color:#F8F8F2">(_)) </span><span style="color:#FF79C6">=&gt;</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">Ok</span><span style="color:#F8F8F2">((col</span><span style="color:#FF79C6">.</span><span style="color:#F8F8F2">name</span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">to_owned</span><span style="color:#F8F8F2">(), v)),</span></div><div class="line"><span style="color:#F8F8F2">                (</span><span style="color:#8BE9FD">SqlTypeInfo</span><span style="color:#FF79C6">::</span><span style="color:#8BE9FD">Int</span><span style="color:#F8F8F2">, v </span><span style="color:#FF79C6">@</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">Value</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">Number</span><span style="color:#F8F8F2">(_)) </span><span style="color:#FF79C6">=&gt;</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">Ok</span><span style="color:#F8F8F2">((col</span><span style="color:#FF79C6">.</span><span style="color:#F8F8F2">name</span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">to_owned</span><span style="color:#F8F8F2">(), v)),</span><span style="color:#6272A4"> // TODO: when we add floats make sure number is an int</span></div><div class="line"><span style="color:#F8F8F2">                (_,v) </span><span style="color:#FF79C6">=&gt;</span><span style="color:#F8F8F2"> </span><span style="color:#8BE9FD">Err</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD">QueryExecutionError</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">InsertTypeMismatch</span><span style="color:#F8F8F2">(col</span><span style="color:#FF79C6">.</span><span style="color:#F8F8F2">type_info, v)),</span></div><div class="line"><span style="color:#F8F8F2">            })</span></div><div class="line"><span style="color:#F8F8F2">            </span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">collect</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">&lt;</span><span style="color:#8BE9FD">Result</span><span style="color:#F8F8F2">&lt;</span><span style="color:#8BE9FD">HashMap</span><span style="color:#F8F8F2">&lt;_, _&gt;,_&gt;&gt;()</span><span style="color:#FF79C6">?</span><span style="color:#F8F8F2">;</span></div><div class="line"></div><div class="line"><span style="color:#F8F8F2">        </span><span style="color:#BD93F9">self</span><span style="color:#FF79C6">.</span><span style="color:#F8F8F2">rows</span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">insert</span><span style="color:#F8F8F2">(id, row</span><span style="color:#FF79C6">.</span><span style="color:#50FA7B">into</span><span style="color:#F8F8F2">());</span></div><div class="line"><span style="color:#F8F8F2">        </span><span style="color:#8BE9FD">Ok</span><span style="color:#F8F8F2">(())</span></div><div class="line"><span style="color:#F8F8F2">    }</span></div><div class="line"><span style="color:#F8F8F2">}</span></div></code></div></pre></div>
<p>Here it&#x27;s pretty basic, we match on the tuple of column type and value, if the value and type match up we allow the insert, otherwise error with a type mismatch.
Later on we could add some logic for implicit conversions for things like converting <code>int</code>s to <code>float</code>s but for now we are going to be strict.</p>
<p>So now we can run</p>
<div class="relative"><pre class="shiki dracula"><div class="language-id">sql</div><div class="code-container"><code><div class="line"><span style="color:#FF79C6">CREATE</span><span style="color:#F8F8F2"> </span><span style="color:#FF79C6">TABLE</span><span style="color:#F8F8F2"> sad (</span></div><div class="line"><span style="color:#F8F8F2">    col1 </span><span style="color:#FF79C6">int</span><span style="color:#F8F8F2">,</span></div><div class="line"><span style="color:#F8F8F2">    col2 string</span></div><div class="line"><span style="color:#F8F8F2">);</span></div><div class="line"></div><div class="line"><span style="color:#FF79C6">INSERT</span><span style="color:#F8F8F2"> </span><span style="color:#FF79C6">INTO</span><span style="color:#F8F8F2"> sad</span></div><div class="line"><span style="color:#F8F8F2">    </span><span style="color:#FF79C6">VALUES</span></div><div class="line"><span style="color:#F8F8F2">        </span><span style="color:#BD93F9">1</span><span style="color:#F8F8F2">, </span><span style="color:#BD93F9">2</span><span style="color:#F8F8F2">;</span></div></code></div></pre></div>
<p>and get back</p>
<div class="relative"><pre class="shiki dracula"><div class="code-container"><code><div class="line"><span style="color:undefined"> × Value 2 can not be inserted into a String column</span></div></code></div></pre></div>
<p>For the happy path</p>
<div class="relative"><pre class="shiki dracula"><div class="language-id">sql</div><div class="code-container"><code><div class="line"><span style="color:#FF79C6">CREATE</span><span style="color:#F8F8F2"> </span><span style="color:#FF79C6">TABLE</span><span style="color:#F8F8F2"> foo (</span></div><div class="line"><span style="color:#F8F8F2">    col1 </span><span style="color:#FF79C6">int</span><span style="color:#F8F8F2">,</span></div><div class="line"><span style="color:#F8F8F2">    col2 string</span></div><div class="line"><span style="color:#F8F8F2">);</span></div><div class="line"></div><div class="line"><span style="color:#FF79C6">INSERT</span><span style="color:#F8F8F2"> </span><span style="color:#FF79C6">INTO</span><span style="color:#F8F8F2"> foo</span></div><div class="line"><span style="color:#F8F8F2">    </span><span style="color:#FF79C6">VALUES</span></div><div class="line"><span style="color:#F8F8F2">        </span><span style="color:#BD93F9">1</span><span style="color:#F8F8F2">, </span><span style="color:#E9F284">&#x27;</span><span style="color:#F1FA8C">aString</span><span style="color:#E9F284">&#x27;</span><span style="color:#F8F8F2">;</span></div><div class="line"></div><div class="line"><span style="color:#FF79C6">INSERT</span><span style="color:#F8F8F2"> </span><span style="color:#FF79C6">INTO</span><span style="color:#F8F8F2"> foo</span></div><div class="line"><span style="color:#F8F8F2">    </span><span style="color:#FF79C6">VALUES</span></div><div class="line"><span style="color:#F8F8F2">        </span><span style="color:#BD93F9">4</span><span style="color:#F8F8F2">, </span><span style="color:#E9F284">&#x27;</span><span style="color:#F1FA8C">aDiffString with spaces</span><span style="color:#E9F284">&#x27;</span><span style="color:#F8F8F2">;</span></div><div class="line"></div><div class="line"><span style="color:#FF79C6">SELECT</span></div><div class="line"><span style="color:#F8F8F2">    col1,</span></div><div class="line"><span style="color:#F8F8F2">    col2</span></div><div class="line"><span style="color:#FF79C6">FROM</span></div><div class="line"><span style="color:#F8F8F2">    foo;</span></div></code></div></pre></div>
<p>will return</p>
<div class="relative"><pre class="shiki dracula"><div class="code-container"><code><div class="line"><span style="color:undefined">+------+-------------------------+
| col1 | col2                    |
+------+-------------------------+
| 1    | aString                 |
+------+-------------------------+
| 4    | aDiffString with spaces |
+------+-------------------------+</span></div></code></div></pre></div>
<h2 id="wrap-up"><a href="#wrap-up" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Wrap up</h2>
<p>This is definitely getting to the point in every personal project where the initial burst of interest starts to wane.
While I would love to focus on more &quot;sexy&quot; features like where clauses, joins, and saving the DB to disk;
I really needed to clean up what I had.</p>
<p>I do plan on focusing on some other side projects for now (and may write some posts on them), but I do plan on focusing more on the DB soon.</p>
<p>If you really want some more I would highly recommend trying this yourself! As you can probably tell from reading this posts, I&#x27;m far from a DB expert. Just start somewhere, you would be impressed with how much you can accomplish already and how much you will learn as you go!</p></div></div></div></div></article></div></main><footer><div class="flex flex-col items-center mt-16"><div class="flex mb-3 space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer me" href="https://github.com/JRMurr"><span class="sr-only">github</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer me" href="https://twitter.com/JRMurrCodes"><span class="sr-only">twitter</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M23.953 4.57a10 10 0 0 1-2.825.775 4.958 4.958 0 0 0 2.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 0 0-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 0 0-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 0 1-2.228-.616v.06a4.923 4.923 0 0 0 3.946 4.827 4.996 4.996 0 0 1-2.212.085 4.936 4.936 0 0 0 4.604 3.417 9.867 9.867 0 0 1-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 0 0 7.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0 0 24 4.59z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer me" href="https://hachyderm.io/@jrmurr"><span class="sr-only">mastodon</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-8 w-8"><path d="M23.268 5.313c-.35-2.578-2.617-4.61-5.304-5.004C17.51.242 15.792 0 11.813 0h-.03c-3.98 0-4.835.242-5.288.309C3.882.692 1.496 2.518.917 5.127.64 6.412.61 7.837.661 9.143c.074 1.874.088 3.745.26 5.611.118 1.24.325 2.47.62 3.68.55 2.237 2.777 4.098 4.96 4.857 2.336.792 4.849.923 7.256.38.265-.061.527-.132.786-.213.585-.184 1.27-.39 1.774-.753a.057.057 0 0 0 .023-.043v-1.809a.052.052 0 0 0-.02-.041.053.053 0 0 0-.046-.01 20.282 20.282 0 0 1-4.709.545c-2.73 0-3.463-1.284-3.674-1.818a5.593 5.593 0 0 1-.319-1.433.053.053 0 0 1 .066-.054c1.517.363 3.072.546 4.632.546.376 0 .75 0 1.125-.01 1.57-.044 3.224-.124 4.768-.422.038-.008.077-.015.11-.024 2.435-.464 4.753-1.92 4.989-5.604.008-.145.03-1.52.03-1.67.002-.512.167-3.63-.024-5.545zm-3.748 9.195h-2.561V8.29c0-1.309-.55-1.976-1.67-1.976-1.23 0-1.846.79-1.846 2.35v3.403h-2.546V8.663c0-1.56-.617-2.35-1.848-2.35-1.112 0-1.668.668-1.67 1.977v6.218H4.822V8.102c0-1.31.337-2.35 1.011-3.12.696-.77 1.608-1.164 2.74-1.164 1.311 0 2.302.5 2.962 1.498l.638 1.06.638-1.06c.66-.999 1.65-1.498 2.96-1.498 1.13 0 2.043.395 2.74 1.164.675.77 1.012 1.81 1.012 3.12z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer me" href="/feed.xml"><span class="sr-only">rss</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24.912 24.912" style="enable-background:new 0 0 24.912 24.912" xml:space="preserve" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M3.692 17.517A3.696 3.696 0 0 0 0 21.211C0 23.244 1.656 24.9 3.692 24.9s3.694-1.657 3.694-3.689a3.697 3.697 0 0 0-3.694-3.694z"></path><path d="M.384 8.142A.386.386 0 0 0 0 8.527v4.688c0 .211.173.383.384.383 6.02 0 10.919 4.898 10.919 10.92 0 .209.171.383.384.383h4.705a.385.385 0 0 0 .387-.383l-.018-.121C16.692 15.423 9.37 8.142.384 8.142z"></path><path d="M24.89 24.397C24.825 10.936 13.854.011.384.011A.385.385 0 0 0 0 .397v4.824c0 .212.173.383.384.383 10.429 0 18.913 8.486 18.913 18.914 0 .209.172.383.382.383h4.845a.39.39 0 0 0 .388-.383l-.022-.121z"></path></svg></a></div><div class="flex mb-2 space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>John Murray</div><div> • </div><div>© 2023</div><div> • </div><a href="/">John&#x27;s Codes</a></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var h=Object.create;var r=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var i=n=\u003er(n,\"__esModule\",{value:!0});var v=(n,s)=\u003e()=\u003e(s||n((s={exports:{}}).exports,s),s.exports),C=(n,s)=\u003e{i(n);for(var c in s)r(n,c,{get:s[c],enumerable:!0})},N=(n,s,c)=\u003e{if(s\u0026\u0026typeof s==\"object\"||typeof s==\"function\")for(let e of y(s))!u.call(n,e)\u0026\u0026e!==\"default\"\u0026\u0026r(n,e,{get:()=\u003es[e],enumerable:!(c=p(s,e))||c.enumerable});return n},B=n=\u003eN(i(r(n!=null?h(m(n)):{},\"default\",n\u0026\u0026n.__esModule\u0026\u0026\"default\"in n?{get:()=\u003en.default,enumerable:!0}:{value:n,enumerable:!0})),n);var d=v((A,a)=\u003e{a.exports=_jsx_runtime});var f={};C(f,{default:()=\u003eE,frontmatter:()=\u003eD});var l=B(d()),D={title:\"Building a Simple DB in Rust - Part 3 - Less Basic Execution\",seriesTitle:\"Part 3 - Less Basic Execution\",date:new Date(1680566515249),tags:[\"rust\",\"database\",\"repl\"],draft:!1,summary:\"Cleaning up existing execution logic\",images:[],layout:\"PostLayout\"};function g(n={}){let{wrapper:s}=n.components||{};return s?(0,l.jsx)(s,Object.assign({},n,{children:(0,l.jsx)(c,{})})):c();function c(){let e=Object.assign({h1:\"h1\",a:\"a\",span:\"span\",p:\"p\",ul:\"ul\",li:\"li\",pre:\"pre\",div:\"div\",code:\"code\",h2:\"h2\"},n.components),{TOCInline:o,Note:F}=e;return F||t(\"Note\",!0),o||t(\"TOCInline\",!0),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(o,{toc:n.toc,asDisclosure:!0}),`\n`,(0,l.jsxs)(e.h1,{id:\"where-we-left-off\",children:[(0,l.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#where-we-left-off\",children:(0,l.jsx)(e.span,{className:\"icon icon-link\"})}),\"Where we left off\"]}),`\n`,(0,l.jsx)(e.p,{children:`In the last post we ended up with extremely basic query execution. We could parse queries, update our tables in memory, and read full tables back;\nall while having decent error messages throughout.`}),`\n`,(0,l.jsx)(e.p,{children:\"While that was a great milestone it leaves a lot to be desired\"}),`\n`,(0,l.jsxs)(e.ul,{children:[`\n`,(0,l.jsx)(e.li,{children:\"While we parse columns in select queries, we never actually project/use them, so you always get all the columns back\"}),`\n`,(0,l.jsx)(e.li,{children:\"We aren't validating types on insert, so the column types mean nothing\"}),`\n`]}),`\n`,(0,l.jsx)(e.p,{children:\"So those main points are what I want to tackle for this post\"}),`\n`,(0,l.jsx)(F,{children:(0,l.jsxs)(e.p,{children:[\"This post is much less of a tutorial/guide than the previous posts. I needed to cleanup what I have so the changes are pretty straightforward, small, and all over. Check the \",(0,l.jsx)(e.a,{href:\"https://github.com/JRMurr/SQLJr\",children:\"repo\"}),\" for more detailed changes.\"]})}),`\n`,(0,l.jsxs)(e.h1,{id:\"actually-selecting-columns\",children:[(0,l.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#actually-selecting-columns\",children:(0,l.jsx)(e.span,{className:\"icon icon-link\"})}),\"Actually selecting columns\"]}),`\n`,(0,l.jsx)(e.p,{children:\"For a refresher, here's what the select response looks like\"}),`\n`,(0,l.jsxs)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:[(0,l.jsx)(e.div,{className:\"language-id\",children:\"rust\"}),(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsxs)(e.code,{children:[(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"pub\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"enum\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"ExecResponse\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003e {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"Select\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Vec\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Row\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003e\u003e),\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Insert\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\",\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Create\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\",\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"pub\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"struct\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Row\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003e {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    id\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"usize\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\",\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    columns\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Rc\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"ColumnInfo\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003e,\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    data\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"\u0026\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"HashMap\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"String\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"String\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003e,\"}),(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\" // reference to the actual row in the table struct\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})})]})})]}),`\n`,(0,l.jsxs)(e.p,{children:[\"So the select response is just a \",(0,l.jsx)(e.code,{children:\"Vec\"}),\" over rows, each row holding info on the columns of the table and the data for that row.\"]}),`\n`,(0,l.jsx)(e.p,{children:\"There's a few things not great about this\"}),`\n`,(0,l.jsxs)(e.ul,{children:[`\n`,(0,l.jsxs)(e.li,{children:[\"Why return a \",(0,l.jsx)(e.code,{children:\"Vec\"}),\" when we could just return an iterator, the consumer is going to iterate over it anyway\"]}),`\n`,(0,l.jsx)(e.li,{children:\"The select response does not return any column info outside of the rows, so empty results would not give any column info\"}),`\n`,(0,l.jsxs)(e.li,{children:[\"The data in the row is just a reference to the table, not horrible for \",(0,l.jsx)(e.code,{children:\"select *\"}),` but need to modify it to only hold the columns we care about\n`,(0,l.jsxs)(e.ul,{children:[`\n`,(0,l.jsx)(e.li,{children:\"We probably will update this type over time to reduce space but for now we'll stick with a hash map\"}),`\n`]}),`\n`]}),`\n`]}),`\n`,(0,l.jsxs)(e.p,{children:[\"To address the first 2 issues, we can just return our existing \",(0,l.jsx)(e.code,{children:\"TableIter\"}),\" struct, this is an iterator, and it holds column info\"]}),`\n`,(0,l.jsxs)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:[(0,l.jsx)(e.div,{className:\"language-id\",children:\"rust\"}),(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsxs)(e.code,{children:[(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"pub\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"enum\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"ExecResponse\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003e {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"Select\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"TableIter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003e),\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Insert\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\",\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Create\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\",\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})})]})})]}),`\n`,(0,l.jsxs)(e.h2,{id:\"for-real-lets-do-a-select\",children:[(0,l.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#for-real-lets-do-a-select\",children:(0,l.jsx)(e.span,{className:\"icon icon-link\"})}),\"For real let's do a select\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"We didn't actually have a select function on \",(0,l.jsx)(e.code,{children:\"Table\"}),\" before, so let's add one that's validates the columns we pass in actually exist\"]}),`\n`,(0,l.jsx)(\"div\",{className:\"remark-code-title\",children:\"table.rs\"}),`\n`,(0,l.jsxs)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:[(0,l.jsx)(e.div,{className:\"language-id\",children:\"rust\"}),(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsxs)(e.code,{children:[(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"#[derive(\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Debug\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Clone\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Default\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Serialize\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Deserialize\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", derive_more\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"From\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\")]\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"pub\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"struct\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"ColumnInfo\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    columns\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Vec\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Column\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003e,\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"impl\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"ColumnInfo\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"pub\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"fn\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"iter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"\u0026\"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"-\u003e\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"impl\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Iterator\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Item\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"\u0026\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Column\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003e {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"columns\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"iter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"()\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    }\"})}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"pub\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"fn\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"find_column\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"\u0026\"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", column_name\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"\u0026\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"String\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"-\u003e\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Result\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"\u0026\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Column\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"QueryExecutionError\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003e {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"iter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"()\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"find\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"col\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" col\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"name \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"==\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"*\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"column_name)\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"ok_or_else\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"||\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"QueryExecutionError\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"ColumnDoesNotExist\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(column_name\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"to_owned\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"()))\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    }\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"// Also updated Table.columns to be `ColumnInfo` instead of Vec\u003cColumn\u003e\"})}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"impl\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Table\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"pub\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"fn\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"select\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"\u0026\"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", columns\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Vec\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"String\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003e) \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"-\u003e\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Result\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"TableIter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"QueryExecutionError\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003e {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" selected_columns \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" columns\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"into_iter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"()\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"map\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"column_name\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"columns\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"find_column\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"\u0026\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"column_name)\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"map\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"col\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" col\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"clone\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"())\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            })\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"collect\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Result\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Vec\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c_\u003e, _\u003e\u003e()\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"?\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\";\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" col_info\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Rc\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"ColumnInfo\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003e \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Rc\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"new\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(selected_columns\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"into\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"());\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Ok\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"TableIter\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"new\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"rows\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"iter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(), col_info))\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    }\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})})]})})]}),`\n`,(0,l.jsx)(e.p,{children:\"Since the select function validates all the columns exist, the iterator can avoid the same error checking like so\"}),`\n`,(0,l.jsx)(\"div\",{className:\"remark-code-title\",children:\"table.rs\"}),`\n`,(0,l.jsxs)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:[(0,l.jsx)(e.div,{className:\"language-id\",children:\"rust\"}),(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsxs)(e.code,{children:[(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"impl\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003e \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Iterator\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"for\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"TableIter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003e {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"type\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Item\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Row\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003e;\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"fn\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"next\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"\u0026mut\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"-\u003e\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Option\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c\"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"Self\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Item\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003e {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"map_iter\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"next\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"()\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"map\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(id, data)\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" projected_data \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" data\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"data\"}),(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\" // the stored row hashmap\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"iter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"()\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"filter_map\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(key, value)\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"columns\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"find_column\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(key)\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"ok\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"()\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"map\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"_\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" (key, value)))\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"collect\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"();\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Row\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"new\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"columns\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"clone\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(), \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"*\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"id, projected_data)\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        })\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    }\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})})]})})]}),`\n`,(0,l.jsx)(e.p,{children:\"All the iterator does is go over the stored table's b-tree, for each row it filters the hash map of row data to only the columns we selected.\"}),`\n`,(0,l.jsxs)(e.h1,{id:\"doing-type-checking\",children:[(0,l.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#doing-type-checking\",children:(0,l.jsx)(e.span,{className:\"icon icon-link\"})}),\"Doing type checking\"]}),`\n`,(0,l.jsx)(e.p,{children:\"Right now we track column types when you create tables\"}),`\n`,(0,l.jsxs)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:[(0,l.jsx)(e.div,{className:\"language-id\",children:\"sql\"}),(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsxs)(e.code,{children:[(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"CREATE\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"TABLE\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" foo (\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    col1 \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"int\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\",\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    col2 string\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\");\"})})]})})]}),`\n`,(0,l.jsx)(e.p,{children:\"but we can just throw anything in there\"}),`\n`,(0,l.jsxs)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:[(0,l.jsx)(e.div,{className:\"language-id\",children:\"sql\"}),(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsxs)(e.code,{children:[(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"INSERT\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"INTO\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" foo\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"VALUES\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        thisIsNotAnInt, \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"3\"})]})]})})]}),`\n`,(0,l.jsx)(e.p,{children:\"to have proper type checking we first need to update the insert statement to be type aware (instead of having every value be strings).\"}),`\n`,(0,l.jsx)(e.p,{children:\"So let's make a SQL value type\"}),`\n`,(0,l.jsx)(\"div\",{className:\"remark-code-title\",children:\"parser/value.rs\"}),`\n`,(0,l.jsxs)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:[(0,l.jsx)(e.div,{className:\"language-id\",children:\"rust\"}),(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsxs)(e.code,{children:[(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"#[derive(\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Debug\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Clone\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"PartialEq\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Eq\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Hash\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Serialize\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Deserialize\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Display\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\")]\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"pub\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"enum\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Value\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"Number\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"BigDecimal\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"),\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"String\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"String\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"),\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})})]})})]}),`\n`,(0,l.jsxs)(e.p,{children:[\"Here we just make an enum of what types/values we support in our SQL language. Here I decided to have one number representation with \",(0,l.jsx)(e.code,{children:\"BigDecimal\"}),`\ninstead of having `,(0,l.jsx)(e.code,{children:\"Int\"}),\"/\",(0,l.jsx)(e.code,{children:\"Float\"}),\" types. Eventually I will, I'm just getting the basics in.\"]}),`\n`,(0,l.jsx)(e.p,{children:\"Now we need to parse these values\"}),`\n`,(0,l.jsx)(\"div\",{className:\"remark-code-title\",children:\"parser/value.rs\"}),`\n`,(0,l.jsxs)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:[(0,l.jsx)(e.div,{className:\"language-id\",children:\"rust\"}),(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsxs)(e.code,{children:[(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"/// Parse a single quoted string value\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"fn\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"parse_string_value\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(input\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"RawSpan\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"_\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003e) \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"-\u003e\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"ParseResult\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"_\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Value\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003e {\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"    // TODO: look into https://github.com/rust-bakery/nom/blob/main/examples/string.rs\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"    // for escaped strings\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" (remaining, (_, str_value, _)) \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"context\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#F1FA8C\"},children:'\"String Literal\"'}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\",\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"tuple\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"((\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"tag\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#F1FA8C\"},children:`\"'\"`}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"),\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"take_until\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#F1FA8C\"},children:`\"'\"`}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\")\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"map\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"s\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"RawSpan\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Value\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"String\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(s\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"fragment\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"()\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"to_string\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"())),\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"tag\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#F1FA8C\"},children:`\"'\"`}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"),\"}),(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\" // take_until does not consume the ending quote\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        )),\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    )(input)\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"?\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\";\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Ok\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"((remaining, str_value))\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"/// Parse a numeric literal\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"fn\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"parse_number_value\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(input\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"RawSpan\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"_\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003e) \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"-\u003e\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"ParseResult\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"_\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Value\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003e {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" (remaining, digits) \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"context\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#F1FA8C\"},children:'\"Number Literal\"'}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"take_while\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"c\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"char\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" c\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"is_numeric\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"()))(input)\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"?\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\";\"}),(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\" // TODO: handle floats\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" digits \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" digits\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"fragment\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"();\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Ok\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"((\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        remaining,\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Value\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"Number\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"BigDecimal\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"from_str\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(digits)\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"unwrap\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"()),\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    ))\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"impl\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003e \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Parse\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003e \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"for\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Value\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"fn\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"parse\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(input\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"RawSpan\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003e) \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"-\u003e\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"ParseResult\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"Self\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003e {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"context\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#F1FA8C\"},children:'\"Value\"'}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\",\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"preceded\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                multispace0,\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"terminated\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"                    // peek_then_cut will give better errors so if we see\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"                    // a quote we knows to only try to parse a string\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                    \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"alt\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"((\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"peek_then_cut\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#F1FA8C\"},children:`\"'\"`}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", parse_string_value), parse_number_value)),\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                    multispace0,\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                ),\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            ),\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        )(input)\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    }\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})})]})})]}),`\n`,(0,l.jsxs)(e.p,{children:[\"The parsing logic is mostly straightforward, the main weirdness you might be confused by is why the calls to \",(0,l.jsx)(e.code,{children:\".fragment()\"}),\"? That is because the input to the parse functions is a \",(0,l.jsx)(e.code,{children:\"RawSpan\"}),\", you need to call \",(0,l.jsx)(e.code,{children:\"fragment()\"}),\" to get the actual string from the span.\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"Now when we wants strings we will need to quote them like \",(0,l.jsx)(e.code,{children:'\"aString\"'})]}),`\n`,(0,l.jsxs)(e.p,{children:[\"Now that we have this value type, we need to replace all our string values with this new type. This change was sorta all over, if you want a good diff this \",(0,l.jsx)(e.a,{href:\"https://github.com/JRMurr/SQLJr/commit/55d66244a573a371983d75534b99577035ead478#diff-01c60d528deeaabdcb2502648bce756b7aa879d131d966016939ca85de7a039c\",children:\"commit\"}),\" has the needed changes for that. This is still probably a little wasteful representation, but it starts us on the path to better types and performance.\"]}),`\n`,(0,l.jsx)(e.p,{children:\"We can now check the value on insert and see if it lines up with the given column's data type\"}),`\n`,(0,l.jsx)(\"div\",{className:\"remark-code-title\",children:\"table.rs\"}),`\n`,(0,l.jsxs)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:[(0,l.jsx)(e.div,{className:\"language-id\",children:\"rust\"}),(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsxs)(e.code,{children:[(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"impl\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Table\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"pub\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"fn\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"insert\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"\u0026mut\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", values\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Vec\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Value\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003e) \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"-\u003e\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Result\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c(), \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"QueryExecutionError\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003e {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" id \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"rows\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"last_key_value\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"()\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"map_or\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"0\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(max_id, _)\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" max_id \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"+\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"1\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\");\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" row \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" values\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"into_iter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"()\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"zip\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"columns\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"iter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"())\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"map\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(value, col)\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"match\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" (col\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"type_info, value) {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                (\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"SqlTypeInfo\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"String\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", v \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"@\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Value\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"String\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(_)) \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\u003e\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Ok\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"((col\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"name\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"to_owned\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(), v)),\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                (\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"SqlTypeInfo\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Int\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", v \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"@\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Value\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"Number\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(_)) \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\u003e\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Ok\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"((col\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"name\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"to_owned\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(), v)),\"}),(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\" // TODO: when we add floats make sure number is an int\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                (_,v) \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\u003e\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Err\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"QueryExecutionError\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"InsertTypeMismatch\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(col\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"type_info, v)),\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            })\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"collect\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Result\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"HashMap\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"\u003c_, _\u003e,_\u003e\u003e()\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"?\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\";\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"rows\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"insert\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(id, row\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"into\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"());\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Ok\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(())\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    }\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})})]})})]}),`\n`,(0,l.jsxs)(e.p,{children:[`Here it's pretty basic, we match on the tuple of column type and value, if the value and type match up we allow the insert, otherwise error with a type mismatch.\nLater on we could add some logic for implicit conversions for things like converting `,(0,l.jsx)(e.code,{children:\"int\"}),\"s to \",(0,l.jsx)(e.code,{children:\"float\"}),\"s but for now we are going to be strict.\"]}),`\n`,(0,l.jsx)(e.p,{children:\"So now we can run\"}),`\n`,(0,l.jsxs)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:[(0,l.jsx)(e.div,{className:\"language-id\",children:\"sql\"}),(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsxs)(e.code,{children:[(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"CREATE\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"TABLE\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" sad (\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    col1 \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"int\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\",\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    col2 string\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\");\"})}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"INSERT\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"INTO\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" sad\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"VALUES\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"1\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"2\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\";\"})]})]})})]}),`\n`,(0,l.jsx)(e.p,{children:\"and get back\"}),`\n`,(0,l.jsx)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsx)(e.code,{children:(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"undefined\"},children:\" \\xD7 Value 2 can not be inserted into a String column\"})})})})}),`\n`,(0,l.jsx)(e.p,{children:\"For the happy path\"}),`\n`,(0,l.jsxs)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:[(0,l.jsx)(e.div,{className:\"language-id\",children:\"sql\"}),(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsxs)(e.code,{children:[(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"CREATE\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"TABLE\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" foo (\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    col1 \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"int\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\",\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    col2 string\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\");\"})}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"INSERT\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"INTO\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" foo\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"VALUES\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"1\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#E9F284\"},children:\"'\"}),(0,l.jsx)(e.span,{style:{color:\"#F1FA8C\"},children:\"aString\"}),(0,l.jsx)(e.span,{style:{color:\"#E9F284\"},children:\"'\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\";\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"INSERT\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"INTO\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" foo\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"VALUES\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"4\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#E9F284\"},children:\"'\"}),(0,l.jsx)(e.span,{style:{color:\"#F1FA8C\"},children:\"aDiffString with spaces\"}),(0,l.jsx)(e.span,{style:{color:\"#E9F284\"},children:\"'\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\";\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"SELECT\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    col1,\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    col2\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"FROM\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    foo;\"})})]})})]}),`\n`,(0,l.jsx)(e.p,{children:\"will return\"}),`\n`,(0,l.jsx)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsx)(e.code,{children:(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"undefined\"},children:`+------+-------------------------+\n| col1 | col2                    |\n+------+-------------------------+\n| 1    | aString                 |\n+------+-------------------------+\n| 4    | aDiffString with spaces |\n+------+-------------------------+`})})})})}),`\n`,(0,l.jsxs)(e.h2,{id:\"wrap-up\",children:[(0,l.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#wrap-up\",children:(0,l.jsx)(e.span,{className:\"icon icon-link\"})}),\"Wrap up\"]}),`\n`,(0,l.jsx)(e.p,{children:`This is definitely getting to the point in every personal project where the initial burst of interest starts to wane.\nWhile I would love to focus on more \"sexy\" features like where clauses, joins, and saving the DB to disk;\nI really needed to clean up what I had.`}),`\n`,(0,l.jsx)(e.p,{children:\"I do plan on focusing on some other side projects for now (and may write some posts on them), but I do plan on focusing more on the DB soon.\"}),`\n`,(0,l.jsx)(e.p,{children:\"If you really want some more I would highly recommend trying this yourself! As you can probably tell from reading this posts, I'm far from a DB expert. Just start somewhere, you would be impressed with how much you can accomplish already and how much you will learn as you go!\"})]})}}var E=g;function t(n,s){throw new Error(\"Expected \"+(s?\"component\":\"object\")+\" `\"+n+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return f;})();\n;return Component;","toc":[{"value":"Where we left off","url":"#where-we-left-off","depth":1},{"value":"Actually selecting columns","url":"#actually-selecting-columns","depth":1},{"value":"For real let's do a select","url":"#for-real-lets-do-a-select","depth":2},{"value":"Doing type checking","url":"#doing-type-checking","depth":1},{"value":"Wrap up","url":"#wrap-up","depth":2}],"frontMatter":{"readingTime":{"text":"6 min read","minutes":5.670833333333333,"time":340250,"words":1361},"slug":"build-a-db/part03","fileName":"build-a-db/part03.md","title":"Building a Simple DB in Rust - Part 3 - Less Basic Execution","seriesTitle":"Part 3 - Less Basic Execution","date":"2023-04-04T00:01:55.249Z","tags":["rust","database","repl"],"draft":false,"summary":"Cleaning up existing execution logic","images":[],"layout":"PostLayout"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.17916666666666667,"time":10750,"words":43},"slug":["default"],"fileName":"default.md","name":"John Murray","avatar":"/static/images/me.jpg","occupation":"Software Engineer","github":"https://github.com/JRMurr","twitter":"https://twitter.com/JRMurrCodes","mastodon":"https://hachyderm.io/@jrmurr","email":"johnreillymurray@gmail.com","date":null}],"series":{"title":"Building a Simple DB in Rust","posts":[{"title":"Building a Simple DB in Rust - Part 1 - Parsing","seriesTitle":"Part 1 - Parsing","date":"2023-01-02T05:19:22.985Z","tags":["rust","database","parsing"],"draft":false,"summary":"building a basic database in rust","images":[],"layout":"PostLayout","slug":"build-a-db/part01"},{"title":"Building a Simple DB in Rust - Part 2 - Basic Execution","seriesTitle":"Part 2 - Basic Execution","date":"2023-01-23T14:01:22.231Z","tags":["rust","database"],"draft":false,"summary":"Building a basic database in rust","images":[],"layout":"PostLayout","slug":"build-a-db/part02"},{"title":"Building a Simple DB in Rust - Part 3 - Less Basic Execution","seriesTitle":"Part 3 - Less Basic Execution","date":"2023-04-04T00:01:55.249Z","tags":["rust","database","repl"],"draft":false,"summary":"Cleaning up existing execution logic","images":[],"layout":"PostLayout","slug":"build-a-db/part03"}]}},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["build-a-db","part03"]},"buildId":"VjYh7k8e50Akk-SVaYPII","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>