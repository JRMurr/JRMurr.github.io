<!DOCTYPE html><html lang="en-us" class="__variable_587f35 scroll-smooth"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/2d141e1a38819612-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="https://upload.wikimedia.org/wikipedia/commons/6/65/B-tree.svg"/><link rel="stylesheet" href="/_next/static/css/895662d5d095c22a.css" crossorigin="" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/14fb540b7a3ad639.css" crossorigin="" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-278bcb5a0daf8917.js" crossorigin=""/><script src="/_next/static/chunks/fd9d1056-28d8581e6e02654e.js" async="" crossorigin=""></script><script src="/_next/static/chunks/69-dbeadf5c9f0cdabc.js" async="" crossorigin=""></script><script src="/_next/static/chunks/main-app-bef4f1fcfc072c84.js" async="" crossorigin=""></script><script src="/_next/static/chunks/250-a30085ccab20449f.js" async=""></script><script src="/_next/static/chunks/781-9238b26c3a132736.js" async=""></script><script src="/_next/static/chunks/app/layout-9608048ecb38eb6e.js" async=""></script><script src="/_next/static/chunks/749-ed776d54eb5c7205.js" async=""></script><script src="/_next/static/chunks/app/blog/%5B...slug%5D/page-fd9b73ee915812e8.js" async=""></script><title>Building a Simple DB in Rust - Part 2 - Basic Execution | John&#x27;s Codes</title><meta name="description" content="Building a basic database in rust"/><meta name="robots" content="index, follow"/><meta name="googlebot" content="index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1"/><link rel="canonical" href="https://johns.codes/blog/build-a-db/part02"/><link rel="alternate" type="application/rss+xml" href="https://johns.codes/feed.xml"/><meta property="og:title" content="Building a Simple DB in Rust - Part 2 - Basic Execution"/><meta property="og:description" content="Building a basic database in rust"/><meta property="og:url" content="https://johns.codes/blog/build-a-db/part02"/><meta property="og:site_name" content="John&#x27;s Codes"/><meta property="og:locale" content="en_US"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2023-01-23T14:01:22.231Z"/><meta property="article:modified_time" content="2023-01-23T14:01:22.231Z"/><meta property="article:author" content="John Murray"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Building a Simple DB in Rust - Part 2 - Basic Execution"/><meta name="twitter:description" content="Building a basic database in rust"/><meta name="next-size-adjust"/><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body class="bg-white text-black antialiased dark:bg-gray-950 dark:text-white"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><section class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex h-screen flex-col justify-between font-sans"><header class="flex items-center justify-between py-10"><div><a aria-label="John&#x27;s Codes" href="/"><div class="flex items-center justify-between"><div class="hidden h-6 text-2xl font-semibold sm:block">John&#x27;s Codes</div></div></a></div><div class="flex items-center space-x-4 leading-5 sm:space-x-6"><a class="hidden font-medium text-gray-900 dark:text-gray-100 sm:block" href="/blog">Blog</a><a class="hidden font-medium text-gray-900 dark:text-gray-100 sm:block" href="/tags">Tags</a><a class="hidden font-medium text-gray-900 dark:text-gray-100 sm:block" href="/projects">Projects</a><a class="hidden font-medium text-gray-900 dark:text-gray-100 sm:block" href="/about">About</a><button aria-label="Search"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-6 w-6 text-gray-900 dark:text-gray-100"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg></button><button aria-label="Toggle Menu" class="sm:hidden"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-8 w-8 text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed left-0 top-0 z-10 h-full w-full transform bg-white opacity-95 duration-300 ease-in-out dark:bg-gray-950 dark:opacity-[0.98] translate-x-full"><div class="flex justify-end"><button class="mr-8 mt-11 h-8 w-8" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><nav class="fixed mt-8 h-full"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/">Home</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog">Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">Tags</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/projects">Projects</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/about">About</a></div></nav></div></div></header><main class="mb-auto"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"Building a Simple DB in Rust - Part 2 - Basic Execution","datePublished":"2023-01-23T14:01:22.231Z","dateModified":"2023-01-23T14:01:22.231Z","description":"Building a basic database in rust","author":[{"@type":"Person","name":"John Murray"}]}</script><section class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="fixed bottom-8 right-8 hidden flex-col gap-3 md:hidden"><button aria-label="Scroll To Comment" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"></path></svg></button><button aria-label="Scroll To Top" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div><header><div class="space-y-1 border-b border-gray-200 pb-10 text-center dark:border-gray-700"><dl><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2023-01-23T14:01:22.231Z">January 23, 2023</time><span class="mx-2">-</span><span class="ml-1">9<!-- --> min read</span></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">Building a Simple DB in Rust - Part 2 - Basic Execution</h1></div></div></header><div class="grid-rows-[auto_1fr] divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:divide-y-0"><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="prose max-w-none pb-8 pt-10 dark:prose-invert"><div class="pb-2"><p>This article is part of the <!-- -->Building a Simple DB in Rust<!-- --> series.</p><select class="block w-3/12 rounded-md border border-gray-300 bg-white px-4 py-2 text-gray-900 focus:border-primary-500 focus:ring-primary-500 dark:border-gray-900 dark:bg-gray-800 dark:text-gray-100"><option value="/blog/build-a-db/part01">Part 1 - Parsing</option><option value="/blog/build-a-db/part02" selected="">Part 2 - Basic Execution</option><option value="/blog/build-a-db/part03">Part 3 - Less Basic Execution</option></select></div><details open=""><summary class="ml-6 pb-2 pt-2 text-xl font-bold">Table of Contents</summary><div class="ml-6"><ul class=""><li><a href="#feedback-from-part-1">Feedback from part 1</a></li><li><a href="#execution">Execution</a><ul class=""><li><a href="#actually-do-stuff">Actually do stuff</a></li><li><a href="#handling-sql-queries">Handling SQL Queries</a></li><li><a href="#bringing-it-all-together">Bringing it all together</a></li><li><a href="#better-display-for-repl">Better display for REPL</a></li><li><a href="#wrap-up">Wrap up</a></li></ul></li></ul></div></details><h1 id="feedback-from-part-1"><a href="#feedback-from-part-1" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Feedback from part 1</h1><p>I got some very nice feedback from the <a href="/blog/build-a-db/part01">first part of this series</a>. The main suggestions were to use some different parsing libraries like <a target="_blank" rel="noopener noreferrer" href="https://docs.rs/chumsky/latest/chumsky/">chumsky</a> or use an existing SQL parser like <a target="_blank" rel="noopener noreferrer" href="https://github.com/sqlparser-rs/sqlparser-rs">sqlparser-rs</a>.</p><p><code>chumsky</code> looks like it handles a lot of the error handling logic I had to do myself while still being defined in rust (no extra language). If I had known of this before I would have used it. Might switch to it later on if our grammar gets more involved. Thanks <a target="_blank" rel="noopener noreferrer" href="https://hachyderm.io/@hjvt/109620348134117972">@hjvt@hachyderm.io</a> for the recommendation!</p><p><code>sqlparser-rs</code> on the other hand looks very well maintained and handles many existing SQL dialects. If this was not a toy project I would have probably started off with this to get going faster without writing any parser logic.</p><p>Enough feedback, let&#x27;s get into actually running queries.</p><h1 id="execution"><a href="#execution" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Execution</h1><p>To get started on execution let&#x27;s make a new crate for it with <code>cargo new sql_jr_execution</code>. We will need the parser crate for our types we made and some other workspace dependencies.</p><div class="remark-code-title">sql_jr_execution/Cargo.toml</div><div class="relative"><pre class="rounded-lg border shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8"><code><span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">[</span><span style="color:#6f42c1;--shiki-dark:#B392F0">package</span><span style="color:#24292e;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">name = </span><span style="color:#032f62;--shiki-dark:#9ECBFF">&quot;sql_jr_execution&quot;</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">version = </span><span style="color:#032f62;--shiki-dark:#9ECBFF">&quot;0.1.0&quot;</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">edition = </span><span style="color:#032f62;--shiki-dark:#9ECBFF">&quot;2021&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">[</span><span style="color:#6f42c1;--shiki-dark:#B392F0">dependencies</span><span style="color:#24292e;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">miette = {workspace = </span><span style="color:#005cc5;--shiki-dark:#79B8FF">true</span><span style="color:#24292e;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">serde = {workspace = </span><span style="color:#005cc5;--shiki-dark:#79B8FF">true</span><span style="color:#24292e;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">sql_jr_parser = { path = </span><span style="color:#032f62;--shiki-dark:#9ECBFF">&quot;../sql_jr_parser&quot;</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> }</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">thiserror = {workspace = </span><span style="color:#005cc5;--shiki-dark:#79B8FF">true</span><span style="color:#24292e;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span></code></pre></div><p>Since we will need to operate on tables, let&#x27;s start by defining our table type. For now, we will only deal with in memory execution. Soon enough we can handle reading from disk.</p><div class="remark-code-title">table.rs</div><div class="relative"><pre class="rounded-lg border shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8"><code><span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">use</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> std</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">collections</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#24292e;--shiki-dark:#E1E4E8">{</span><span style="color:#6f42c1;--shiki-dark:#B392F0">BTreeMap</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, </span><span style="color:#6f42c1;--shiki-dark:#B392F0">HashMap</span><span style="color:#24292e;--shiki-dark:#E1E4E8">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">use</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> serde</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#24292e;--shiki-dark:#E1E4E8">{</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Deserialize</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, </span><span style="color:#6f42c1;--shiki-dark:#B392F0">Serialize</span><span style="color:#24292e;--shiki-dark:#E1E4E8">};</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">use</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> sql_jr_parser</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Column</span><span style="color:#24292e;--shiki-dark:#E1E4E8">; </span><span style="color:#6a737d;--shiki-dark:#6A737D">// See part 1 for this type def. Just column name and sql data type (string or int)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6a737d;--shiki-dark:#6A737D">// NOTE: For now just a mapping of col name =&gt; data as a str. Will change later</span></span>
<span class="line"><span style="color:#6a737d;--shiki-dark:#6A737D">/// A row stored in a table</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">type</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> StoredRow</span><span style="color:#d73a49;--shiki-dark:#F97583"> =</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> HashMap</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">String</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, </span><span style="color:#6f42c1;--shiki-dark:#B392F0">String</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt;;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6a737d;--shiki-dark:#6A737D">/// List of column info</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">type</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> ColumnInfo</span><span style="color:#d73a49;--shiki-dark:#F97583"> =</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Vec</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Column</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt;;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">#[derive(</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Debug</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, </span><span style="color:#6f42c1;--shiki-dark:#B392F0">Clone</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, </span><span style="color:#6f42c1;--shiki-dark:#B392F0">Default</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, </span><span style="color:#6f42c1;--shiki-dark:#B392F0">Serialize</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, </span><span style="color:#6f42c1;--shiki-dark:#B392F0">Deserialize</span><span style="color:#24292e;--shiki-dark:#E1E4E8">)]</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">pub</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#d73a49;--shiki-dark:#F97583">crate</span><span style="color:#24292e;--shiki-dark:#E1E4E8">) </span><span style="color:#d73a49;--shiki-dark:#F97583">struct</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Table</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#6a737d;--shiki-dark:#6A737D">    /// row id to row</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    rows</span><span style="color:#d73a49;--shiki-dark:#F97583">:</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> BTreeMap</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">usize</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, </span><span style="color:#6f42c1;--shiki-dark:#B392F0">StoredRow</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt;,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6a737d;--shiki-dark:#6A737D">    /// Column info for all columns in the table</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    columns</span><span style="color:#d73a49;--shiki-dark:#F97583">:</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> ColumnInfo</span><span style="color:#24292e;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span></code></pre></div><p>The <code>Table</code> struct is basically just a wrapper around Rust&#x27;s <a target="_blank" rel="noopener noreferrer" href="https://doc.rust-lang.org/stable/std/collections/struct.BTreeMap.html#">Btree</a> with some extra column info.</p><h3 id="what-is-a-b-tree"><a href="#what-is-a-b-tree" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>What is a B-Tree?</h3><p>A <a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/B-tree">B-Tree</a> is a generalized Binary Search Tree (BST). BSTs are great in theory but in practice, they kinda suck for cache locality, nodes only store 1 piece of data, have the potential to be unbalanced, and require a heap allocation for each insertion. In &quot;current year&quot; CPUs are insanely fast, so we need data structures that are better for reducing memory access.</p><p><em>insert rant about why data oriented design is GOATED here</em>.</p><p>Alexis Beingessner in <a target="_blank" rel="noopener noreferrer" href="https://cglab.ca/~abeinges/blah/rust-btree-case/#what&#x27;s-a-b-tree?-why&#x27;s-a-b-tree?">Rust Collections Case Study: BTreeMap</a> described B-Trees as</p><blockquote><p>B-Trees take the idea of a BST, and say &quot;lets put some arrays in there; computers love arrays&quot;. Rather than each node consisting of a single element with two children, B-Tree nodes have an array of elements with an array of children</p></blockquote><p>I won&#x27;t go into too much detail on B-Tree implementation, since I&#x27;m just using rust&#x27;s built-in for now. If you&#x27;re interested here are some good resources on B-Trees.</p><ul><li><a target="_blank" rel="noopener noreferrer" href="https://cglab.ca/~abeinges/blah/rust-btree-case">Rust Collections Case Study: BTreeMap</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/B-tree">Wikipedia</a></li><li><a target="_blank" rel="noopener noreferrer" href="http://opendatastructures.org/ods-python/14_2_B_Trees.html">Open Data Structures</a></li></ul><p>With that said, let&#x27;s walk through a basic example</p><p><img alt="B-Tree example" src="https://upload.wikimedia.org/wikipedia/commons/6/65/B-tree.svg"/></p><p>Here the internal node (the root) has 3 children. All keys <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mn>7</mn></mrow><annotation encoding="application/x-tex">&lt; 7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span style="height:.5782em;vertical-align:-.0391em" class="strut"></span><span class="mrel">&lt;</span><span style="margin-right:.2778em" class="mspace"></span></span><span class="base"><span style="height:.6444em" class="strut"></span><span class="mord">7</span></span></span></span> are in the left child, keys <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&gt;</mo><mn>7</mn></mrow><annotation encoding="application/x-tex">&gt; 7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span style="height:.5782em;vertical-align:-.0391em" class="strut"></span><span class="mrel">&gt;</span><span style="margin-right:.2778em" class="mspace"></span></span><span class="base"><span style="height:.6444em" class="strut"></span><span class="mord">7</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mo>=</mo><mn>16</mn></mrow><annotation encoding="application/x-tex">&lt;= 16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span style="height:.5782em;vertical-align:-.0391em" class="strut"></span><span class="mrel">&lt;=</span><span style="margin-right:.2778em" class="mspace"></span></span><span class="base"><span style="height:.6444em" class="strut"></span><span class="mord">16</span></span></span></span> are in the middle, and finally, keys <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&gt;</mo><mn>16</mn></mrow><annotation encoding="application/x-tex">&gt; 16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span style="height:.5782em;vertical-align:-.0391em" class="strut"></span><span class="mrel">&gt;</span><span style="margin-right:.2778em" class="mspace"></span></span><span class="base"><span style="height:.6444em" class="strut"></span><span class="mord">16</span></span></span></span> are in the right child.</p><p>You can customize the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span style="height:.6833em" class="strut"></span><span style="margin-right:.05017em" class="mord mathnormal">B</span></span></span></span> constant to have nodes store more/fewer keys and have more/fewer children. The average Lookup for a B-tree with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span style="height:.6833em" class="strut"></span><span style="margin-right:.10903em" class="mord mathnormal">N</span></span></span></span> keys is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><msub><mrow></mrow><mn>2</mn></msub><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(\log{_2}N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span style="height:1em;vertical-align:-.25em" class="strut"></span><span style="margin-right:.02778em" class="mord mathcal">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:.01389em">g</span></span><span style="margin-right:.1667em" class="mspace"></span><span class="mord"><span class="mord"><span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span style="height:.3011em" class="vlist"><span style="top:-2.55em;margin-right:.05em"><span style="height:2.7em" class="pstrut"></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span style="height:.15em" class="vlist"><span></span></span></span></span></span></span></span><span style="margin-right:.10903em" class="mord mathnormal">N</span><span class="mclose">)</span></span></span></span> which is the same for a BST.</p><h3 id="why-b-tree"><a href="#why-b-tree" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Why B-Tree?</h3><p>As I mentioned before B-Trees are great for cache locality. Also, you can make each node the size of a memory/disk block. This way you can minimize reads by chunking up the data more efficiently.</p><h2 id="actually-do-stuff"><a href="#actually-do-stuff" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Actually do stuff</h2><p>Nerd stuff aside, let&#x27;s add actual logic for our table</p><div class="relative"><pre class="rounded-lg border shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8"><code><span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">impl</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Table</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6a737d;--shiki-dark:#6A737D">    // Create a table with the given column definitions</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">    pub</span><span style="color:#d73a49;--shiki-dark:#F97583"> fn</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> new</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(columns</span><span style="color:#d73a49;--shiki-dark:#F97583">:</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Vec</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Column</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt;) </span><span style="color:#d73a49;--shiki-dark:#F97583">-&gt;</span><span style="color:#005cc5;--shiki-dark:#79B8FF"> Self</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#005cc5;--shiki-dark:#79B8FF">        Self</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">            rows</span><span style="color:#d73a49;--shiki-dark:#F97583">:</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> BTreeMap</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">new</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(),</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">            columns,</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6a737d;--shiki-dark:#6A737D">    /// Insert values (a row) into the table</span></span>
<span class="line"><span style="color:#6a737d;--shiki-dark:#6A737D">    ///</span></span>
<span class="line"><span style="color:#6a737d;--shiki-dark:#6A737D">    /// assumes the values are in the same order of the columns passed to create</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">    pub</span><span style="color:#d73a49;--shiki-dark:#F97583"> fn</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> insert</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#d73a49;--shiki-dark:#F97583">&amp;mut</span><span style="color:#005cc5;--shiki-dark:#79B8FF"> self</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, values</span><span style="color:#d73a49;--shiki-dark:#F97583">:</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Vec</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">String</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt;) {</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">        let</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> id </span><span style="color:#d73a49;--shiki-dark:#F97583">=</span><span style="color:#005cc5;--shiki-dark:#79B8FF"> self</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">            .</span><span style="color:#24292e;--shiki-dark:#E1E4E8">rows</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">            .</span><span style="color:#6f42c1;--shiki-dark:#B392F0">last_key_value</span><span style="color:#24292e;--shiki-dark:#E1E4E8">()</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">            .</span><span style="color:#6f42c1;--shiki-dark:#B392F0">map_or</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#005cc5;--shiki-dark:#79B8FF">0</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, </span><span style="color:#d73a49;--shiki-dark:#F97583">|</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(max_id, _)</span><span style="color:#d73a49;--shiki-dark:#F97583">|</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> max_id </span><span style="color:#d73a49;--shiki-dark:#F97583">+</span><span style="color:#005cc5;--shiki-dark:#79B8FF"> 1</span><span style="color:#24292e;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">        let</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> row</span><span style="color:#d73a49;--shiki-dark:#F97583">:</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> StoredRow</span><span style="color:#d73a49;--shiki-dark:#F97583"> =</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> values</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">            .</span><span style="color:#6f42c1;--shiki-dark:#B392F0">into_iter</span><span style="color:#24292e;--shiki-dark:#E1E4E8">()</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">            .</span><span style="color:#6f42c1;--shiki-dark:#B392F0">zip</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#005cc5;--shiki-dark:#79B8FF">self</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#24292e;--shiki-dark:#E1E4E8">columns</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">iter</span><span style="color:#24292e;--shiki-dark:#E1E4E8">())</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">            .</span><span style="color:#6f42c1;--shiki-dark:#B392F0">map</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#d73a49;--shiki-dark:#F97583">|</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(v, col)</span><span style="color:#d73a49;--shiki-dark:#F97583">|</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> (col</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#24292e;--shiki-dark:#E1E4E8">name</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">to_owned</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(), v))</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">            .</span><span style="color:#6f42c1;--shiki-dark:#B392F0">collect</span><span style="color:#24292e;--shiki-dark:#E1E4E8">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#005cc5;--shiki-dark:#79B8FF">        self</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#24292e;--shiki-dark:#E1E4E8">rows</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">insert</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(id, row);</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span></code></pre></div><p>Here we create a table with the given column definitions (from the create table sql command). For insert, we get an ID for the new row which is just an ID sequence starting at 0 for the first row. We then insert the values into the B-TreeMap with that ID as the key and the row&#x27;s values as a hash map of the column name to a string of the value to insert.</p><p>Those two functions can handle creating tables (mostly) and inserting data, but how should we handle select? A simple first step is to re-use the <a target="_blank" rel="noopener noreferrer" href="https://doc.rust-lang.org/std/iter/trait.Iterator.html">Iterator</a> on <a target="_blank" rel="noopener noreferrer" href="https://doc.rust-lang.org/std/collections/struct.BTreeMap.html#method.iter">BTreeMap</a>.</p><div class="relative"><pre class="rounded-lg border shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8"><code><span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">impl</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Table</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">    pub</span><span style="color:#d73a49;--shiki-dark:#F97583"> fn</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> iter</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#d73a49;--shiki-dark:#F97583">&amp;</span><span style="color:#005cc5;--shiki-dark:#79B8FF">self</span><span style="color:#24292e;--shiki-dark:#E1E4E8">) </span><span style="color:#d73a49;--shiki-dark:#F97583">-&gt;</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> std</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">collections</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">btree_map</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Iter</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">usize</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, </span><span style="color:#6f42c1;--shiki-dark:#B392F0">Row</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt; {</span></span>
<span class="line"><span style="color:#005cc5;--shiki-dark:#79B8FF">        self</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#24292e;--shiki-dark:#E1E4E8">rows</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">iter</span><span style="color:#24292e;--shiki-dark:#E1E4E8">()</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span></code></pre></div><p>This will give us an <code>Iterator</code> over <code>(row_id, row_values)</code>.</p><p>Re-using the iterator from BTreeMap is fine, but I like how many Rust DB libraries have a <code>Row</code> trait/struct that gives you extra information. For example, <a target="_blank" rel="noopener noreferrer" href="https://github.com/launchbadge/sqlx">SQLX</a> has a <a target="_blank" rel="noopener noreferrer" href="https://docs.rs/sqlx/latest/sqlx/trait.Row.html">Row trait</a> that lets you get column info back for the query you ran, safe/unsafe conversions into rust types, and a few other helpers. So let&#x27;s make our <code>Row</code> struct and iterator, so we can add these features later on.</p><div class="relative"><pre class="rounded-lg border shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8"><code><span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">use</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> std</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#24292e;--shiki-dark:#E1E4E8">{</span><span style="color:#6f42c1;--shiki-dark:#B392F0">collections</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">HashMap</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, </span><span style="color:#6f42c1;--shiki-dark:#B392F0">rc</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Rc</span><span style="color:#24292e;--shiki-dark:#E1E4E8">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">use</span><span style="color:#d73a49;--shiki-dark:#F97583"> crate::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">table</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">ColumnInfo</span><span style="color:#24292e;--shiki-dark:#E1E4E8">; </span><span style="color:#6a737d;--shiki-dark:#6A737D">// Vec&lt;Column&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6a737d;--shiki-dark:#6A737D">/// A Row in a Query response</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">#[derive(</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Debug</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, </span><span style="color:#6f42c1;--shiki-dark:#B392F0">Clone</span><span style="color:#24292e;--shiki-dark:#E1E4E8">)]</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">pub</span><span style="color:#d73a49;--shiki-dark:#F97583"> struct</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Row</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;&#x27;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">a</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt; {</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    id</span><span style="color:#d73a49;--shiki-dark:#F97583">:</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> usize</span><span style="color:#24292e;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    columns</span><span style="color:#d73a49;--shiki-dark:#F97583">:</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Rc</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">ColumnInfo</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt;,</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    data</span><span style="color:#d73a49;--shiki-dark:#F97583">:</span><span style="color:#d73a49;--shiki-dark:#F97583"> &amp;</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&#x27;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">a</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> HashMap</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">String</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, </span><span style="color:#6f42c1;--shiki-dark:#B392F0">String</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt;,</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span></code></pre></div><p>Here I made the decision that this <code>Row</code> struct will not own the data it&#x27;s showing. Therefore, it needs a reference to the data stored in the table. I also want to have the row have access to the <code>ColumnInfo</code> from the table. Since every row will be holding a reference to the same <code>ColumnInfo</code>, I went with an <a target="_blank" rel="noopener noreferrer" href="https://doc.rust-lang.org/std/rc/index.html">RC</a> to avoid extra lifetime parameters on the row struct.</p><p>Now we can implement <code>Iterator</code> for the table. We can just wrap the existing <code>Iterator</code> from <code>BTreeMap</code> and transform each response into our <code>Row</code> struct.</p><div class="relative"><pre class="rounded-lg border shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8"><code><span class="line"><span style="color:#6a737d;--shiki-dark:#6A737D">/// Iterator of [`Row`]s from a table</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">pub</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#d73a49;--shiki-dark:#F97583">crate</span><span style="color:#24292e;--shiki-dark:#E1E4E8">) </span><span style="color:#d73a49;--shiki-dark:#F97583">struct</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> TableIter</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;&#x27;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">a</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt; {</span></span>
<span class="line"><span style="color:#6a737d;--shiki-dark:#6A737D">    /// Underlying iterator over the btree_map</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    map_iter</span><span style="color:#d73a49;--shiki-dark:#F97583">:</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> std</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">collections</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">btree_map</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Iter</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;&#x27;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">a</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, </span><span style="color:#6f42c1;--shiki-dark:#B392F0">usize</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, </span><span style="color:#6f42c1;--shiki-dark:#B392F0">StoredRow</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt;,</span></span>
<span class="line"><span style="color:#6a737d;--shiki-dark:#6A737D">    /// The columns of the [`Table`]</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    columns</span><span style="color:#d73a49;--shiki-dark:#F97583">:</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Rc</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">ColumnInfo</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt;,</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">impl</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;&#x27;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">a</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt; </span><span style="color:#6f42c1;--shiki-dark:#B392F0">TableIter</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;&#x27;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">a</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt; {</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">    pub</span><span style="color:#d73a49;--shiki-dark:#F97583"> fn</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> new</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">        map_iter</span><span style="color:#d73a49;--shiki-dark:#F97583">:</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> std</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">collections</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">btree_map</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Iter</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;&#x27;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">a</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, </span><span style="color:#6f42c1;--shiki-dark:#B392F0">usize</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, </span><span style="color:#6f42c1;--shiki-dark:#B392F0">StoredRow</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt;,</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">        columns</span><span style="color:#d73a49;--shiki-dark:#F97583">:</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Rc</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">ColumnInfo</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt;,</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    ) </span><span style="color:#d73a49;--shiki-dark:#F97583">-&gt;</span><span style="color:#005cc5;--shiki-dark:#79B8FF"> Self</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#005cc5;--shiki-dark:#79B8FF">        Self</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> { map_iter, columns }</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">impl</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;&#x27;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">a</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt; </span><span style="color:#6f42c1;--shiki-dark:#B392F0">Iterator</span><span style="color:#d73a49;--shiki-dark:#F97583"> for</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> TableIter</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;&#x27;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">a</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt; {</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">    type</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Item</span><span style="color:#d73a49;--shiki-dark:#F97583"> =</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Row</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;&#x27;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">a</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt;;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">    fn</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> next</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#d73a49;--shiki-dark:#F97583">&amp;mut</span><span style="color:#005cc5;--shiki-dark:#79B8FF"> self</span><span style="color:#24292e;--shiki-dark:#E1E4E8">) </span><span style="color:#d73a49;--shiki-dark:#F97583">-&gt;</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Option</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;</span><span style="color:#005cc5;--shiki-dark:#79B8FF">Self</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Item</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt; {</span></span>
<span class="line"><span style="color:#005cc5;--shiki-dark:#79B8FF">        self</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#24292e;--shiki-dark:#E1E4E8">map_iter</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">            .</span><span style="color:#6f42c1;--shiki-dark:#B392F0">next</span><span style="color:#24292e;--shiki-dark:#E1E4E8">()</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">            .</span><span style="color:#6f42c1;--shiki-dark:#B392F0">map</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#d73a49;--shiki-dark:#F97583">|</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(id, data)</span><span style="color:#d73a49;--shiki-dark:#F97583">|</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Row</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">new</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#005cc5;--shiki-dark:#79B8FF">self</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#24292e;--shiki-dark:#E1E4E8">columns</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">clone</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(), id</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">clone</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(), data))</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"></span></code></pre></div><p>Now we can implement the <a target="_blank" rel="noopener noreferrer" href="https://doc.rust-lang.org/std/iter/trait.IntoIterator.html">IntoIterator trait</a> on <code>Table</code> for easy conversion into an iterator.</p><div class="relative"><pre class="rounded-lg border shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8"><code><span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">impl</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;&#x27;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">a</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt; </span><span style="color:#6f42c1;--shiki-dark:#B392F0">IntoIterator</span><span style="color:#d73a49;--shiki-dark:#F97583"> for</span><span style="color:#d73a49;--shiki-dark:#F97583"> &amp;</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&#x27;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">a</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Table</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">    type</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Item</span><span style="color:#d73a49;--shiki-dark:#F97583"> =</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Row</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;&#x27;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">a</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt;;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">    type</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> IntoIter</span><span style="color:#d73a49;--shiki-dark:#F97583"> =</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> TableIter</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;&#x27;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">a</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt;;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">    fn</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> into_iter</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#005cc5;--shiki-dark:#79B8FF">self</span><span style="color:#24292e;--shiki-dark:#E1E4E8">) </span><span style="color:#d73a49;--shiki-dark:#F97583">-&gt;</span><span style="color:#005cc5;--shiki-dark:#79B8FF"> Self</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">IntoIter</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">        let</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> col_info </span><span style="color:#d73a49;--shiki-dark:#F97583">=</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Rc</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">new</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#005cc5;--shiki-dark:#79B8FF">self</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#24292e;--shiki-dark:#E1E4E8">columns</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">clone</span><span style="color:#24292e;--shiki-dark:#E1E4E8">());</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6f42c1;--shiki-dark:#B392F0">        TableIter</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">new</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#005cc5;--shiki-dark:#79B8FF">self</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#24292e;--shiki-dark:#E1E4E8">rows</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">iter</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(), col_info)</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span></code></pre></div><p>now the <code>iter</code> method (not necessarily needed) on table can just call the trait method</p><div class="relative"><pre class="rounded-lg border shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8"><code><span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">impl</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Table</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">  pub</span><span style="color:#d73a49;--shiki-dark:#F97583"> fn</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> iter</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#d73a49;--shiki-dark:#F97583">&amp;</span><span style="color:#005cc5;--shiki-dark:#79B8FF">self</span><span style="color:#24292e;--shiki-dark:#E1E4E8">) </span><span style="color:#d73a49;--shiki-dark:#F97583">-&gt;</span><span style="color:#d73a49;--shiki-dark:#F97583"> impl</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Iterator</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Item</span><span style="color:#d73a49;--shiki-dark:#F97583"> =</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Row</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt; {</span></span>
<span class="line"><span style="color:#005cc5;--shiki-dark:#79B8FF">        self</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">into_iter</span><span style="color:#24292e;--shiki-dark:#E1E4E8">()</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span></code></pre></div><h2 id="handling-sql-queries"><a href="#handling-sql-queries" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Handling SQL Queries</h2><p>Now that we have a <code>Table</code> struct we need to hook up the parsed commands to create, insert, and read from tables.</p><p>First we should define the response type for an execution</p><div class="relative"><pre class="rounded-lg border shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8"><code><span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">use</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> derive_more</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Display</span><span style="color:#24292e;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">#[derive(</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Debug</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, </span><span style="color:#6f42c1;--shiki-dark:#B392F0">Display</span><span style="color:#24292e;--shiki-dark:#E1E4E8">)]</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">pub</span><span style="color:#d73a49;--shiki-dark:#F97583"> enum</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> ExecResponse</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;&#x27;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">a</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt; {</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    #[display(fmt </span><span style="color:#d73a49;--shiki-dark:#F97583">=</span><span style="color:#032f62;--shiki-dark:#9ECBFF"> &quot;{_0:?}&quot;</span><span style="color:#24292e;--shiki-dark:#E1E4E8">)] </span><span style="color:#6a737d;--shiki-dark:#6A737D">// only show the values not &quot;Select(...)&quot;</span></span>
<span class="line"><span style="color:#6f42c1;--shiki-dark:#B392F0">    Select</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Vec</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Row</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;&#x27;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">a</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt;&gt;),</span></span>
<span class="line"><span style="color:#6f42c1;--shiki-dark:#B392F0">    Insert</span><span style="color:#24292e;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#6f42c1;--shiki-dark:#B392F0">    Create</span><span style="color:#24292e;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span></code></pre></div><p>Here I use the <a target="_blank" rel="noopener noreferrer" href="https://docs.rs/derive_more/latest/derive_more/">derive_more</a> crate&#x27;s Display derive macro to avoid writing my own implementation of Display. If you&#x27;re a real one who&#x27;s been paying attention, you may have noticed that we did not implement <code>Display</code> on <code>Row</code> but the <code>Display</code> derive still compiles, this is due to us adding <code>#[display(fmt = &quot;{_0:?}&quot;)]</code> to use the debug format of <code>Vec&lt;Row&gt;</code> as the <code>Display</code> format. While we won&#x27;t use it much for select display (more on that later), for the other response cases It&#x27;s nice to have.</p><p>We also should make our own Error type for Query Execution</p><div class="relative"><pre class="rounded-lg border shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8"><code><span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">use</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> miette</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Diagnostic</span><span style="color:#24292e;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">use</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> thiserror</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Error</span><span style="color:#24292e;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6a737d;--shiki-dark:#6A737D">/// Errors during query execution</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">#[derive(</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Error</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, </span><span style="color:#6f42c1;--shiki-dark:#B392F0">Debug</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, </span><span style="color:#6f42c1;--shiki-dark:#B392F0">Diagnostic</span><span style="color:#24292e;--shiki-dark:#E1E4E8">)]</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">#[error(</span><span style="color:#032f62;--shiki-dark:#9ECBFF">&quot;Query Execution Error&quot;</span><span style="color:#24292e;--shiki-dark:#E1E4E8">)]</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">pub</span><span style="color:#d73a49;--shiki-dark:#F97583"> enum</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> QueryExecutionError</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    #[error(</span><span style="color:#032f62;--shiki-dark:#9ECBFF">&quot;Table {0} was not found&quot;</span><span style="color:#24292e;--shiki-dark:#E1E4E8">)]</span></span>
<span class="line"><span style="color:#6f42c1;--shiki-dark:#B392F0">    TableNotFound</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#6f42c1;--shiki-dark:#B392F0">String</span><span style="color:#24292e;--shiki-dark:#E1E4E8">),</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    #[error(</span><span style="color:#032f62;--shiki-dark:#9ECBFF">&quot;Table {0} already exists&quot;</span><span style="color:#24292e;--shiki-dark:#E1E4E8">)]</span></span>
<span class="line"><span style="color:#6f42c1;--shiki-dark:#B392F0">    TableAlreadyExists</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#6f42c1;--shiki-dark:#B392F0">String</span><span style="color:#24292e;--shiki-dark:#E1E4E8">),</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    #[error(</span><span style="color:#032f62;--shiki-dark:#9ECBFF">&quot;Column {0} does not exist&quot;</span><span style="color:#24292e;--shiki-dark:#E1E4E8">)]</span></span>
<span class="line"><span style="color:#6f42c1;--shiki-dark:#B392F0">    ColumnDoesNotExist</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#6f42c1;--shiki-dark:#B392F0">String</span><span style="color:#24292e;--shiki-dark:#E1E4E8">),</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span></code></pre></div><p>Like in <a href="/blog/build-a-db/part01">part1</a>, we still are using <a target="_blank" rel="noopener noreferrer" href="https://docs.rs/miette/latest/miette/">miette</a>/<a target="_blank" rel="noopener noreferrer" href="https://docs.rs/thiserror/latest/thiserror/">thiserror</a> for better looking errors.</p><p>Now we can finally actually run some queries. For a quick refresher on the <code>SqlQuery</code> type, see <a target="_blank" rel="noopener noreferrer" href="https://github.com/JRMurr/SQLJr/blob/5324c38bc74cb77d2daf035a0f3d1da3fc7b4c3b/crates/sql_jr_parser/src/ast.rs#L19">the source code</a></p><div class="relative"><pre class="rounded-lg border shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8"><code><span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">#[derive(</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Debug</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, </span><span style="color:#6f42c1;--shiki-dark:#B392F0">Default</span><span style="color:#24292e;--shiki-dark:#E1E4E8">)]</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">pub</span><span style="color:#d73a49;--shiki-dark:#F97583"> struct</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Execution</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    tables</span><span style="color:#d73a49;--shiki-dark:#F97583">:</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> HashMap</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">String</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, </span><span style="color:#6f42c1;--shiki-dark:#B392F0">Table</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt;,</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">impl</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Execution</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">    pub</span><span style="color:#d73a49;--shiki-dark:#F97583"> fn</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> new</span><span style="color:#24292e;--shiki-dark:#E1E4E8">() </span><span style="color:#d73a49;--shiki-dark:#F97583">-&gt;</span><span style="color:#005cc5;--shiki-dark:#79B8FF"> Self</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#005cc5;--shiki-dark:#79B8FF">        Self</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">            tables</span><span style="color:#d73a49;--shiki-dark:#F97583">:</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> HashMap</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">new</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(),</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">    pub</span><span style="color:#d73a49;--shiki-dark:#F97583"> fn</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> run</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#d73a49;--shiki-dark:#F97583">&amp;mut</span><span style="color:#005cc5;--shiki-dark:#79B8FF"> self</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, query</span><span style="color:#d73a49;--shiki-dark:#F97583">:</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> SqlQuery</span><span style="color:#24292e;--shiki-dark:#E1E4E8">) </span><span style="color:#d73a49;--shiki-dark:#F97583">-&gt;</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Result</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">ExecResponse</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, </span><span style="color:#6f42c1;--shiki-dark:#B392F0">QueryExecutionError</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt; {</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">        match</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> query {</span></span>
<span class="line"><span style="color:#6f42c1;--shiki-dark:#B392F0">            SqlQuery</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Select</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#d73a49;--shiki-dark:#F97583">mut</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> select) </span><span style="color:#d73a49;--shiki-dark:#F97583">=&gt;</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">                let</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> table </span><span style="color:#d73a49;--shiki-dark:#F97583">=</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> select</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#24292e;--shiki-dark:#E1E4E8">table; </span><span style="color:#6a737d;--shiki-dark:#6A737D">// the table name</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">                let</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> table </span><span style="color:#d73a49;--shiki-dark:#F97583">=</span><span style="color:#005cc5;--shiki-dark:#79B8FF"> self</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">                    .</span><span style="color:#24292e;--shiki-dark:#E1E4E8">tables</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">                    .</span><span style="color:#6f42c1;--shiki-dark:#B392F0">get</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#d73a49;--shiki-dark:#F97583">&amp;</span><span style="color:#24292e;--shiki-dark:#E1E4E8">table)</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">                    .</span><span style="color:#6f42c1;--shiki-dark:#B392F0">ok_or</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#6f42c1;--shiki-dark:#B392F0">QueryExecutionError</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">TableNotFound</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(table))</span><span style="color:#d73a49;--shiki-dark:#F97583">?</span><span style="color:#24292e;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#6a737d;--shiki-dark:#6A737D">                // not projecting to the selected columns yet</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">                let</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> rows </span><span style="color:#d73a49;--shiki-dark:#F97583">=</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> table</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">iter</span><span style="color:#24292e;--shiki-dark:#E1E4E8">()</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">collect</span><span style="color:#24292e;--shiki-dark:#E1E4E8">();</span></span>
<span class="line"><span style="color:#6f42c1;--shiki-dark:#B392F0">                Ok</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#6f42c1;--shiki-dark:#B392F0">ExecResponse</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Select</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(rows)))</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">            }</span></span>
<span class="line"><span style="color:#6f42c1;--shiki-dark:#B392F0">            SqlQuery</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Insert</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(insert) </span><span style="color:#d73a49;--shiki-dark:#F97583">=&gt;</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">                let</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Some</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(table) </span><span style="color:#d73a49;--shiki-dark:#F97583">=</span><span style="color:#005cc5;--shiki-dark:#79B8FF"> self</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#24292e;--shiki-dark:#E1E4E8">tables</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">get_mut</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#d73a49;--shiki-dark:#F97583">&amp;</span><span style="color:#24292e;--shiki-dark:#E1E4E8">insert</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#24292e;--shiki-dark:#E1E4E8">table) </span><span style="color:#d73a49;--shiki-dark:#F97583">else</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">                    return</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Err</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#6f42c1;--shiki-dark:#B392F0">QueryExecutionError</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">TableNotFound</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(insert</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#24292e;--shiki-dark:#E1E4E8">table))</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">                };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">                table</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">insert</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(insert</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#24292e;--shiki-dark:#E1E4E8">values);</span></span>
<span class="line"><span style="color:#6f42c1;--shiki-dark:#B392F0">                Ok</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#6f42c1;--shiki-dark:#B392F0">ExecResponse</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Insert</span><span style="color:#24292e;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">            }</span></span>
<span class="line"><span style="color:#6f42c1;--shiki-dark:#B392F0">            SqlQuery</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Create</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(create) </span><span style="color:#d73a49;--shiki-dark:#F97583">=&gt;</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">                let</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> table </span><span style="color:#d73a49;--shiki-dark:#F97583">=</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Table</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">new</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(create</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#24292e;--shiki-dark:#E1E4E8">columns);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#005cc5;--shiki-dark:#79B8FF">                self</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#24292e;--shiki-dark:#E1E4E8">tables</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">insert</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(create</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#24292e;--shiki-dark:#E1E4E8">table, table);</span></span>
<span class="line"><span style="color:#6f42c1;--shiki-dark:#B392F0">                Ok</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#6f42c1;--shiki-dark:#B392F0">ExecResponse</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Create</span><span style="color:#24292e;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">            }</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span></code></pre></div><p>Since we handled most of the logic in the <code>Table</code>/<code>Row</code> structs, the actual execution is mostly just wrapper around the <code>HashMap</code> of tables with some basic error handling.</p><h2 id="bringing-it-all-together"><a href="#bringing-it-all-together" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Bringing it all together</h2><p>With the <code>Execution</code> struct we can handle the parsed commands from our parser but right now we don&#x27;t have it all hooked up. We need to unify the parser and execution into one.</p><p>Ideally, we would have some new crate for the full &quot;pipeline&quot; from parsing to execution (and probably more steps we will add later), but for now having this logic in the <code>Execution</code> crate feels fine.</p><p>First, step is to combine the Error types from Parsing and Execution</p><div class="relative"><pre class="rounded-lg border shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8"><code><span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">use</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> miette</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Diagnostic</span><span style="color:#24292e;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">use</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> sql_jr_parser</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">error</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">FormattedError</span><span style="color:#24292e;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">use</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> thiserror</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Error</span><span style="color:#24292e;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6a737d;--shiki-dark:#6A737D">/// Errors at any point in the SQL &quot;pipeline&quot;</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">#[derive(</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Error</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, </span><span style="color:#6f42c1;--shiki-dark:#B392F0">Debug</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, </span><span style="color:#6f42c1;--shiki-dark:#B392F0">Diagnostic</span><span style="color:#24292e;--shiki-dark:#E1E4E8">)]</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">#[error(transparent)]</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">pub</span><span style="color:#d73a49;--shiki-dark:#F97583"> enum</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> SQLError</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;&#x27;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">a</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt; {</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    #[diagnostic(transparent)]</span></span>
<span class="line"><span style="color:#6f42c1;--shiki-dark:#B392F0">    QueryExecutionError</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(#[from] </span><span style="color:#6f42c1;--shiki-dark:#B392F0">QueryExecutionError</span><span style="color:#24292e;--shiki-dark:#E1E4E8">),</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    #[diagnostic(transparent)]</span></span>
<span class="line"><span style="color:#6f42c1;--shiki-dark:#B392F0">    ParsingError</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#6f42c1;--shiki-dark:#B392F0">FormattedError</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;&#x27;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">a</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt;),</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6a737d;--shiki-dark:#6A737D">// need a manual impl since the error #[from] seems sad on lifetimes</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">impl</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;&#x27;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">a</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt; </span><span style="color:#6f42c1;--shiki-dark:#B392F0">From</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">FormattedError</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;&#x27;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">a</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt;&gt; </span><span style="color:#d73a49;--shiki-dark:#F97583">for</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> SQLError</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;&#x27;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">a</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt; {</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">    fn</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> from</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(value</span><span style="color:#d73a49;--shiki-dark:#F97583">:</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> FormattedError</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;&#x27;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">a</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt;) </span><span style="color:#d73a49;--shiki-dark:#F97583">-&gt;</span><span style="color:#005cc5;--shiki-dark:#79B8FF"> Self</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#6f42c1;--shiki-dark:#B392F0">        SQLError</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">ParsingError</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(value)</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span></code></pre></div><p>Here <code>#[diagnostic(transparent)]</code> is similar to <code>#[error(transparent)]</code> in <code>thiserror</code>, it lets you wrap other errors but still call their <code>Display</code> trait when the error is shown.</p><p>Now we can have a function that parses and executes the query</p><div class="relative"><pre class="rounded-lg border shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8"><code><span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">impl</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Execution</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">   pub</span><span style="color:#d73a49;--shiki-dark:#F97583"> fn</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> parse_and_run</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;&#x27;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">a</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt;(</span><span style="color:#d73a49;--shiki-dark:#F97583">&amp;mut</span><span style="color:#005cc5;--shiki-dark:#79B8FF"> self</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, query</span><span style="color:#d73a49;--shiki-dark:#F97583">:</span><span style="color:#d73a49;--shiki-dark:#F97583"> &amp;</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&#x27;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">a</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> str</span><span style="color:#24292e;--shiki-dark:#E1E4E8">) </span><span style="color:#d73a49;--shiki-dark:#F97583">-&gt;</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Result</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">ExecResponse</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, </span><span style="color:#6f42c1;--shiki-dark:#B392F0">SQLError</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;&#x27;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">a</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt;&gt; {</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">        let</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> query </span><span style="color:#d73a49;--shiki-dark:#F97583">=</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> parse_sql_query</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(query)</span><span style="color:#d73a49;--shiki-dark:#F97583">?</span><span style="color:#24292e;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">        let</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> res </span><span style="color:#d73a49;--shiki-dark:#F97583">=</span><span style="color:#005cc5;--shiki-dark:#79B8FF"> self</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">run</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(query)</span><span style="color:#d73a49;--shiki-dark:#F97583">?</span><span style="color:#24292e;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#6f42c1;--shiki-dark:#B392F0">        Ok</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(res)</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span></code></pre></div><p>Which lets our REPL now look like</p><div class="relative"><pre class="rounded-lg border shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8"><code><span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">fn</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> main</span><span style="color:#24292e;--shiki-dark:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">  ...</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">  let</span><span style="color:#d73a49;--shiki-dark:#F97583"> mut</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> exec </span><span style="color:#d73a49;--shiki-dark:#F97583">=</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> sql_jr_execution</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Execution</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">new</span><span style="color:#24292e;--shiki-dark:#E1E4E8">();</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">  loop</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">        let</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> readline </span><span style="color:#d73a49;--shiki-dark:#F97583">=</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> rl</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">readline</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#032f62;--shiki-dark:#9ECBFF">&quot;&gt;&gt; &quot;</span><span style="color:#24292e;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">        match</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> readline {</span></span>
<span class="line"><span style="color:#6f42c1;--shiki-dark:#B392F0">          Ok</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(line) </span><span style="color:#d73a49;--shiki-dark:#F97583">=&gt;</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">                rl</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">add_history_entry</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(line</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">as_str</span><span style="color:#24292e;--shiki-dark:#E1E4E8">());</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">                let</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> line</span><span style="color:#d73a49;--shiki-dark:#F97583">:</span><span style="color:#d73a49;--shiki-dark:#F97583"> &amp;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">str</span><span style="color:#d73a49;--shiki-dark:#F97583"> =</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> line</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">as_ref</span><span style="color:#24292e;--shiki-dark:#E1E4E8">();</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">                let</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> res </span><span style="color:#d73a49;--shiki-dark:#F97583">=</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> exec</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">parse_and_run</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(line);</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">                match</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> res {</span></span>
<span class="line"><span style="color:#6f42c1;--shiki-dark:#B392F0">                    Ok</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(exec_res) </span><span style="color:#d73a49;--shiki-dark:#F97583">=&gt;</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> println!</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#032f62;--shiki-dark:#9ECBFF">&quot;{exec_res}&quot;</span><span style="color:#24292e;--shiki-dark:#E1E4E8">),</span></span>
<span class="line"><span style="color:#6f42c1;--shiki-dark:#B392F0">                    Err</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(e) </span><span style="color:#d73a49;--shiki-dark:#F97583">=&gt;</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">                        let</span><span style="color:#d73a49;--shiki-dark:#F97583"> mut</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> s </span><span style="color:#d73a49;--shiki-dark:#F97583">=</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> String</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">new</span><span style="color:#24292e;--shiki-dark:#E1E4E8">();</span></span>
<span class="line"><span style="color:#6f42c1;--shiki-dark:#B392F0">                        GraphicalReportHandler</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">new</span><span style="color:#24292e;--shiki-dark:#E1E4E8">()</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">                            .</span><span style="color:#6f42c1;--shiki-dark:#B392F0">with_cause_chain</span><span style="color:#24292e;--shiki-dark:#E1E4E8">()</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">                            .</span><span style="color:#6f42c1;--shiki-dark:#B392F0">with_context_lines</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#005cc5;--shiki-dark:#79B8FF">10</span><span style="color:#24292e;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">                            .</span><span style="color:#6f42c1;--shiki-dark:#B392F0">render_report</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#d73a49;--shiki-dark:#F97583">&amp;mut</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> s, </span><span style="color:#d73a49;--shiki-dark:#F97583">&amp;</span><span style="color:#24292e;--shiki-dark:#E1E4E8">e)</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">                            .</span><span style="color:#6f42c1;--shiki-dark:#B392F0">unwrap</span><span style="color:#24292e;--shiki-dark:#E1E4E8">();</span></span>
<span class="line"><span style="color:#6f42c1;--shiki-dark:#B392F0">                        println!</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#032f62;--shiki-dark:#9ECBFF">&quot;{s}&quot;</span><span style="color:#24292e;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">                    }</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">                }</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">            }</span></span>
<span class="line"><span style="color:#6a737d;--shiki-dark:#6A737D">          // other cases unchanged from part 1</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span></code></pre></div><p>The happy path in our REPL now looks like</p><div class="relative"><pre class="rounded-lg border shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8"><code><span class="line"><span>&gt;&gt; create table foo (col1 string, col2 string);</span></span>
<span class="line"><span>Create</span></span>
<span class="line"><span>&gt;&gt; insert into foo values a,b;</span></span>
<span class="line"><span>Insert</span></span>
<span class="line"><span>&gt;&gt; select col1,col2 from foo;</span></span>
<span class="line"><span>[Row { id: 0, columns: [Column { name: &quot;col1&quot;, type_info: String }, Column { name: &quot;col2&quot;, type_info: String }], data: {&quot;col1&quot;: &quot;a&quot;, &quot;col2&quot;: &quot;b&quot;} }]</span></span>
<span class="line"><span>&gt;&gt;</span></span>
<span class="line"><span></span></span></code></pre></div><h2 id="better-display-for-repl"><a href="#better-display-for-repl" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Better display for REPL</h2><p>The REPL works, but the display for select queries is pretty gross. We can use the <a target="_blank" rel="noopener noreferrer" href="https://github.com/zhiburt/tabled">tabled crate</a> to format the response as a table. We can run <code>cargo add tabled</code> in <code>crates/sql_jr_repl</code> to add the crate to the repl.</p><p>If you look at the docs for <code>tabled</code> many of the first examples involve the <code>#[derive(Tabled)]</code> macro on your structs/enums. This does not really work for select queries since the columns are dynamic. Tabled still supports this with the <a target="_blank" rel="noopener noreferrer" href="https://docs.rs/tabled/0.10.0/tabled/builder/struct.Builder.html">builder</a> to allow us to set the rows + columns dynamically.</p><p>Let&#x27;s add a new file to the REPL crate and handle display there</p><div class="remark-code-title">crates/sql_jr_repl/display.rs</div><div class="relative"><pre class="rounded-lg border shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8"><code><span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">pub</span><span style="color:#d73a49;--shiki-dark:#F97583"> fn</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> display_response</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(res</span><span style="color:#d73a49;--shiki-dark:#F97583">:</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> ExecResponse</span><span style="color:#24292e;--shiki-dark:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">    match</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> res {</span></span>
<span class="line"><span style="color:#6f42c1;--shiki-dark:#B392F0">        ExecResponse</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">Select</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(rows) </span><span style="color:#d73a49;--shiki-dark:#F97583">=&gt;</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">            let</span><span style="color:#d73a49;--shiki-dark:#F97583"> mut</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> builder </span><span style="color:#d73a49;--shiki-dark:#F97583">=</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Builder</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">default</span><span style="color:#24292e;--shiki-dark:#E1E4E8">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6a737d;--shiki-dark:#6A737D">            // Get column info from the first row</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">            let</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> row </span><span style="color:#d73a49;--shiki-dark:#F97583">=</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> rows</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">get</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#005cc5;--shiki-dark:#79B8FF">0</span><span style="color:#24292e;--shiki-dark:#E1E4E8">)</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">expect</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#032f62;--shiki-dark:#9ECBFF">&quot;For now assuming we get data back&quot;</span><span style="color:#24292e;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">            let</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> columns</span><span style="color:#d73a49;--shiki-dark:#F97583">:</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Vec</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">String</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt; </span><span style="color:#d73a49;--shiki-dark:#F97583">=</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> row</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">                .</span><span style="color:#6f42c1;--shiki-dark:#B392F0">columns</span><span style="color:#24292e;--shiki-dark:#E1E4E8">() </span><span style="color:#6a737d;--shiki-dark:#6A737D">// added helper, see below</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">                .</span><span style="color:#6f42c1;--shiki-dark:#B392F0">iter</span><span style="color:#24292e;--shiki-dark:#E1E4E8">()</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">                .</span><span style="color:#6f42c1;--shiki-dark:#B392F0">map</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#d73a49;--shiki-dark:#F97583">|</span><span style="color:#24292e;--shiki-dark:#E1E4E8">col</span><span style="color:#d73a49;--shiki-dark:#F97583">|</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> col</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#24292e;--shiki-dark:#E1E4E8">name</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">to_string</span><span style="color:#24292e;--shiki-dark:#E1E4E8">())</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">                .</span><span style="color:#6f42c1;--shiki-dark:#B392F0">collect</span><span style="color:#24292e;--shiki-dark:#E1E4E8">();</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">            builder</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">set_columns</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#d73a49;--shiki-dark:#F97583">&amp;</span><span style="color:#24292e;--shiki-dark:#E1E4E8">columns);</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">            for</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> row </span><span style="color:#d73a49;--shiki-dark:#F97583">in</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> rows</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">into_iter</span><span style="color:#24292e;--shiki-dark:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">                builder</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">add_record</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(columns</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">iter</span><span style="color:#24292e;--shiki-dark:#E1E4E8">()</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">map</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#d73a49;--shiki-dark:#F97583">|</span><span style="color:#24292e;--shiki-dark:#E1E4E8">col</span><span style="color:#d73a49;--shiki-dark:#F97583">|</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> row</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">get</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(col))); </span><span style="color:#6a737d;--shiki-dark:#6A737D">// added a get helper, see below</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">            }</span></span>
<span class="line"><span style="color:#6f42c1;--shiki-dark:#B392F0">            println!</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#032f62;--shiki-dark:#9ECBFF">&quot;{}&quot;</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, builder</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">build</span><span style="color:#24292e;--shiki-dark:#E1E4E8">())</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">        _ </span><span style="color:#d73a49;--shiki-dark:#F97583">=&gt;</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> println!</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#032f62;--shiki-dark:#9ECBFF">&quot;{res}&quot;</span><span style="color:#24292e;--shiki-dark:#E1E4E8">),</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span></code></pre></div><p>as noted in a comment I added these helpers to the row struct to make column lookup easier</p><div class="remark-code-title">crates/sql_jr_execution/row.rs</div><div class="relative"><pre class="rounded-lg border shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8"><code><span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">impl</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Row</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">     pub</span><span style="color:#d73a49;--shiki-dark:#F97583"> fn</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> columns</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#d73a49;--shiki-dark:#F97583">&amp;</span><span style="color:#005cc5;--shiki-dark:#79B8FF">self</span><span style="color:#24292e;--shiki-dark:#E1E4E8">) </span><span style="color:#d73a49;--shiki-dark:#F97583">-&gt;</span><span style="color:#d73a49;--shiki-dark:#F97583"> &amp;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">ColumnInfo</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#005cc5;--shiki-dark:#79B8FF">        self</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#24292e;--shiki-dark:#E1E4E8">columns</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">as_ref</span><span style="color:#24292e;--shiki-dark:#E1E4E8">()</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6a737d;--shiki-dark:#6A737D">    /// Get a single value from the row</span></span>
<span class="line"><span style="color:#6a737d;--shiki-dark:#6A737D">    ///</span></span>
<span class="line"><span style="color:#6a737d;--shiki-dark:#6A737D">    /// # Panics</span></span>
<span class="line"><span style="color:#6a737d;--shiki-dark:#6A737D">    ///</span></span>
<span class="line"><span style="color:#6a737d;--shiki-dark:#6A737D">    /// Panics if the column does not exist</span></span>
<span class="line"><span style="color:#6a737d;--shiki-dark:#6A737D">    /// See [`try_get`](Self::try_get) for a non-panicking</span></span>
<span class="line"><span style="color:#6a737d;--shiki-dark:#6A737D">    /// version.</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">    pub</span><span style="color:#d73a49;--shiki-dark:#F97583"> fn</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> get</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#d73a49;--shiki-dark:#F97583">&amp;</span><span style="color:#005cc5;--shiki-dark:#79B8FF">self</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, column</span><span style="color:#d73a49;--shiki-dark:#F97583">:</span><span style="color:#d73a49;--shiki-dark:#F97583"> &amp;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">String</span><span style="color:#24292e;--shiki-dark:#E1E4E8">) </span><span style="color:#d73a49;--shiki-dark:#F97583">-&gt;</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> String</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#005cc5;--shiki-dark:#79B8FF">        self</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">try_get</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(column)</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">unwrap</span><span style="color:#24292e;--shiki-dark:#E1E4E8">()</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6a737d;--shiki-dark:#6A737D">    /// Get a single value from the row</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">    pub</span><span style="color:#d73a49;--shiki-dark:#F97583"> fn</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> try_get</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#d73a49;--shiki-dark:#F97583">&amp;</span><span style="color:#005cc5;--shiki-dark:#79B8FF">self</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, column</span><span style="color:#d73a49;--shiki-dark:#F97583">:</span><span style="color:#d73a49;--shiki-dark:#F97583"> &amp;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">String</span><span style="color:#24292e;--shiki-dark:#E1E4E8">) </span><span style="color:#d73a49;--shiki-dark:#F97583">-&gt;</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Result</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&lt;</span><span style="color:#6f42c1;--shiki-dark:#B392F0">String</span><span style="color:#24292e;--shiki-dark:#E1E4E8">, </span><span style="color:#6f42c1;--shiki-dark:#B392F0">QueryExecutionError</span><span style="color:#24292e;--shiki-dark:#E1E4E8">&gt; {</span></span>
<span class="line"><span style="color:#005cc5;--shiki-dark:#79B8FF">        self</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#24292e;--shiki-dark:#E1E4E8">data</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">get</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(column)</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">map_or_else</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">            ||</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Err</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#6f42c1;--shiki-dark:#B392F0">QueryExecutionError</span><span style="color:#d73a49;--shiki-dark:#F97583">::</span><span style="color:#6f42c1;--shiki-dark:#B392F0">ColumnDoesNotExist</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(column</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">to_owned</span><span style="color:#24292e;--shiki-dark:#E1E4E8">())),</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">            |</span><span style="color:#24292e;--shiki-dark:#E1E4E8">val</span><span style="color:#d73a49;--shiki-dark:#F97583">|</span><span style="color:#6f42c1;--shiki-dark:#B392F0"> Ok</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(val</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">to_string</span><span style="color:#24292e;--shiki-dark:#E1E4E8">()),</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">        )</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#24292e;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span></code></pre></div><p>now the REPL from the example above would show</p><div class="relative"><pre class="rounded-lg border shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8"><code><span class="line"><span>&gt;&gt; select col1,col2 from foo;</span></span>
<span class="line"><span>+------+------+</span></span>
<span class="line"><span>| col1 | col2 |</span></span>
<span class="line"><span>+------+------+</span></span>
<span class="line"><span>| a    | b    |</span></span>
<span class="line"><span>+------+------+</span></span>
<span class="line"><span></span></span></code></pre></div><p><code>tabled</code> has many <a target="_blank" rel="noopener noreferrer" href="https://github.com/zhiburt/tabled#style">style options</a> if we wanted to tweak the look, but this is fine for now.</p><p>You probably noticed the line</p><div class="relative"><pre class="rounded-lg border shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8"><code><span class="line"><span style="color:#6a737d;--shiki-dark:#6A737D">//Get column info from the first row</span></span>
<span class="line"><span style="color:#d73a49;--shiki-dark:#F97583">let</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> row </span><span style="color:#d73a49;--shiki-dark:#F97583">=</span><span style="color:#24292e;--shiki-dark:#E1E4E8"> rows</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">get</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#005cc5;--shiki-dark:#79B8FF">0</span><span style="color:#24292e;--shiki-dark:#E1E4E8">)</span><span style="color:#d73a49;--shiki-dark:#F97583">.</span><span style="color:#6f42c1;--shiki-dark:#B392F0">expect</span><span style="color:#24292e;--shiki-dark:#E1E4E8">(</span><span style="color:#032f62;--shiki-dark:#9ECBFF">&quot;For now assuming we get data back&quot;</span><span style="color:#24292e;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"></span></code></pre></div><p>in our display function. This obviously would get sad on empty responses. The best decision would be to add/move <code>ColumnInfo</code> into <code>ExecResponse::Select</code>, so we return something like</p><div class="relative"><pre class="rounded-lg border shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8"><code><span class="line"><span>{columns: Rc&lt;ColumnInfo&gt;, row: Vec&lt;Row&gt;}</span></span>
<span class="line"><span></span></span></code></pre></div><p>but I&#x27;ll save that for the next post.</p><h2 id="wrap-up"><a href="#wrap-up" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Wrap up</h2><p>Having basic execution feels nice, but the real challenge will be filtering and projecting the data. We have some extra clones and <code>unwraps</code>/<code>expects</code> we need to handle once we start moving away from this extremely simple happy path but so far the high level design feels good!</p></div><div><div class="pb-6 pt-6 text-sm text-gray-700 dark:text-gray-300"><a target="_blank" rel="nofollow" href="https://mobile.twitter.com/search?q=https%3A%2F%2Fjohns.codes%2Fblog%2Fbuild-a-db%2Fpart02">Discuss on Twitter</a> • <a target="_blank" rel="noopener noreferrer" href="https://github.com/JRMurr/JRMurr.github.io/blob/main/content/blog/build-a-db/part02.md">View on GitHub</a></div><div class="pb-6 pt-6 text-center text-gray-700 dark:text-gray-300" id="comment"><button>Load Comments</button></div></div></div><footer><div class="flex flex-col text-sm font-medium sm:flex-row sm:justify-between sm:text-base"><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" aria-label="Previous post: Building a Simple DB in Rust - Part 1 - Parsing" href="/blog/build-a-db/part01">← <!-- -->Building a Simple DB in Rust - Part 1 - Parsing</a></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" aria-label="Next post: Building a Simple DB in Rust - Part 3 - Less Basic Execution" href="/blog/build-a-db/part03">Building a Simple DB in Rust - Part 3 - Less Basic Execution<!-- --> →</a></div></div></footer></div></div></article></section></main><footer><div class="mt-16 flex flex-col items-center"><div class="mb-3 flex space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/JRMurr"><span class="sr-only">github</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://twitter.com/JRMurrCodes"><span class="sr-only">twitter</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6"><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://hachyderm.io/@jrmurr"><span class="sr-only">mastodon</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6"><path d="M23.268 5.313c-.35-2.578-2.617-4.61-5.304-5.004C17.51.242 15.792 0 11.813 0h-.03c-3.98 0-4.835.242-5.288.309C3.882.692 1.496 2.518.917 5.127.64 6.412.61 7.837.661 9.143c.074 1.874.088 3.745.26 5.611.118 1.24.325 2.47.62 3.68.55 2.237 2.777 4.098 4.96 4.857 2.336.792 4.849.923 7.256.38.265-.061.527-.132.786-.213.585-.184 1.27-.39 1.774-.753a.057.057 0 0 0 .023-.043v-1.809a.052.052 0 0 0-.02-.041.053.053 0 0 0-.046-.01 20.282 20.282 0 0 1-4.709.545c-2.73 0-3.463-1.284-3.674-1.818a5.593 5.593 0 0 1-.319-1.433.053.053 0 0 1 .066-.054c1.517.363 3.072.546 4.632.546.376 0 .75 0 1.125-.01 1.57-.044 3.224-.124 4.768-.422.038-.008.077-.015.11-.024 2.435-.464 4.753-1.92 4.989-5.604.008-.145.03-1.52.03-1.67.002-.512.167-3.63-.024-5.545zm-3.748 9.195h-2.561V8.29c0-1.309-.55-1.976-1.67-1.976-1.23 0-1.846.79-1.846 2.35v3.403h-2.546V8.663c0-1.56-.617-2.35-1.848-2.35-1.112 0-1.668.668-1.67 1.977v6.218H4.822V8.102c0-1.31.337-2.35 1.011-3.12.696-.77 1.608-1.164 2.74-1.164 1.311 0 2.302.5 2.962 1.498l.638 1.06.638-1.06c.66-.999 1.65-1.498 2.96-1.498 1.13 0 2.043.395 2.74 1.164.675.77 1.012 1.81 1.012 3.12z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="/feed.xml"><span class="sr-only">rss</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6"><path d="M3.692 17.517A3.696 3.696 0 0 0 0 21.211C0 23.244 1.656 24.9 3.692 24.9s3.694-1.657 3.694-3.689a3.697 3.697 0 0 0-3.694-3.694z"></path><path d="M.384 8.142A.386.386 0 0 0 0 8.527v4.688c0 .211.173.383.384.383 6.02 0 10.919 4.898 10.919 10.92 0 .209.171.383.384.383h4.705a.385.385 0 0 0 .387-.383l-.018-.121C16.692 15.423 9.37 8.142.384 8.142z"></path><path d="M24.89 24.397C24.825 10.936 13.854.011.384.011A.385.385 0 0 0 0 .397v4.824c0 .212.173.383.384.383 10.429 0 18.913 8.486 18.913 18.914 0 .209.172.383.382.383h4.845a.39.39 0 0 0 .388-.383l-.022-.121z"></path></svg></a></div><div class="mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>John Murray</div><div> • </div><div>© 2024</div><div> • </div><a href="/">John&#x27;s Codes</a></div></div></footer></div></section><script src="/_next/static/chunks/webpack-278bcb5a0daf8917.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/media/2d141e1a38819612-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/_next/static/css/895662d5d095c22a.css\",\"style\",{\"crossOrigin\":\"\"}]\n0:\"$L3\"\n"])</script><script>self.__next_f.push([1,"4:HL[\"/_next/static/css/14fb540b7a3ad639.css\",\"style\",{\"crossOrigin\":\"\"}]\n"])</script><script>self.__next_f.push([1,"5:I[7690,[],\"\"]\n8:I[5613,[],\"\"]\na:I[1778,[],\"\"]\nb:I[8029,[\"250\",\"static/chunks/250-a30085ccab20449f.js\",\"781\",\"static/chunks/781-9238b26c3a132736.js\",\"185\",\"static/chunks/app/layout-9608048ecb38eb6e.js\"],\"ThemeProviders\"]\nc:I[5935,[\"250\",\"static/chunks/250-a30085ccab20449f.js\",\"781\",\"static/chunks/781-9238b26c3a132736.js\",\"185\",\"static/chunks/app/layout-9608048ecb38eb6e.js\"],\"\"]\nd:I[9266,[\"250\",\"static/chunks/250-a30085ccab20449f.js\",\"781\",\"static/chunks/781-9238b26c3a132736.js\",\"185\",\"static/chunks/app/lay"])</script><script>self.__next_f.push([1,"out-9608048ecb38eb6e.js\"],\"KBarSearchProvider\"]\ne:I[5250,[\"250\",\"static/chunks/250-a30085ccab20449f.js\",\"749\",\"static/chunks/749-ed776d54eb5c7205.js\",\"797\",\"static/chunks/app/blog/%5B...slug%5D/page-fd9b73ee915812e8.js\"],\"\"]\nf:I[2146,[\"250\",\"static/chunks/250-a30085ccab20449f.js\",\"781\",\"static/chunks/781-9238b26c3a132736.js\",\"185\",\"static/chunks/app/layout-9608048ecb38eb6e.js\"],\"KBarButton\"]\n10:I[5021,[\"250\",\"static/chunks/250-a30085ccab20449f.js\",\"781\",\"static/chunks/781-9238b26c3a132736.js\",\"185\",\"static/"])</script><script>self.__next_f.push([1,"chunks/app/layout-9608048ecb38eb6e.js\"],\"\"]\n11:I[123,[\"250\",\"static/chunks/250-a30085ccab20449f.js\",\"781\",\"static/chunks/781-9238b26c3a132736.js\",\"185\",\"static/chunks/app/layout-9608048ecb38eb6e.js\"],\"\"]\n14:I[8955,[],\"\"]\n9:[\"slug\",\"build-a-db/part02\",\"c\"]\n12:T44f,"])</script><script>self.__next_f.push([1,"M23.268 5.313c-.35-2.578-2.617-4.61-5.304-5.004C17.51.242 15.792 0 11.813 0h-.03c-3.98 0-4.835.242-5.288.309C3.882.692 1.496 2.518.917 5.127.64 6.412.61 7.837.661 9.143c.074 1.874.088 3.745.26 5.611.118 1.24.325 2.47.62 3.68.55 2.237 2.777 4.098 4.96 4.857 2.336.792 4.849.923 7.256.38.265-.061.527-.132.786-.213.585-.184 1.27-.39 1.774-.753a.057.057 0 0 0 .023-.043v-1.809a.052.052 0 0 0-.02-.041.053.053 0 0 0-.046-.01 20.282 20.282 0 0 1-4.709.545c-2.73 0-3.463-1.284-3.674-1.818a5.593 5.593 0 0 1-.319-1.433.053.053 0 0 1 .066-.054c1.517.363 3.072.546 4.632.546.376 0 .75 0 1.125-.01 1.57-.044 3.224-.124 4.768-.422.038-.008.077-.015.11-.024 2.435-.464 4.753-1.92 4.989-5.604.008-.145.03-1.52.03-1.67.002-.512.167-3.63-.024-5.545zm-3.748 9.195h-2.561V8.29c0-1.309-.55-1.976-1.67-1.976-1.23 0-1.846.79-1.846 2.35v3.403h-2.546V8.663c0-1.56-.617-2.35-1.848-2.35-1.112 0-1.668.668-1.67 1.977v6.218H4.822V8.102c0-1.31.337-2.35 1.011-3.12.696-.77 1.608-1.164 2.74-1.164 1.311 0 2.302.5 2.962 1.498l.638 1.06.638-1.06c.66-.999 1.65-1.498 2.96-1.498 1.13 0 2.043.395 2.74 1.164.675.77 1.012 1.81 1.012 3.12z"])</script><script>self.__next_f.push([1,"15:[]\n"])</script><script>self.__next_f.push([1,"3:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/895662d5d095c22a.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],[\"$\",\"$L5\",null,{\"buildId\":\"KJjil5QzPbaOHvzNe1zNm\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/blog/build-a-db/part02\",\"initialTree\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"build-a-db/part02\",\"c\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":[\\\"build-a-db\\\",\\\"part02\\\"]}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"build-a-db/part02\",\"c\"],{\"children\":[\"__PAGE__\",{},[\"$L6\",\"$L7\",null]]},[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"$9\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/14fb540b7a3ad639.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]]}]]},[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[null,[\"$\",\"html\",null,{\"lang\":\"en-us\",\"className\":\"__variable_587f35 scroll-smooth\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"link\",null,{\"rel\":\"apple-touch-icon\",\"sizes\":\"76x76\",\"href\":\"/static/favicons/apple-touch-icon.png\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"sizes\":\"32x32\",\"href\":\"/static/favicons/favicon-32x32.png\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"sizes\":\"16x16\",\"href\":\"/static/favicons/favicon-16x16.png\"}],[\"$\",\"link\",null,{\"rel\":\"manifest\",\"href\":\"/static/favicons/site.webmanifest\"}],[\"$\",\"link\",null,{\"rel\":\"mask-icon\",\"href\":\"/static/favicons/safari-pinned-tab.svg\",\"color\":\"#5bbad5\"}],[\"$\",\"meta\",null,{\"name\":\"msapplication-TileColor\",\"content\":\"#000000\"}],[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"media\":\"(prefers-color-scheme: light)\",\"content\":\"#fff\"}],[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"media\":\"(prefers-color-scheme: dark)\",\"content\":\"#000\"}],[\"$\",\"link\",null,{\"rel\":\"alternate\",\"type\":\"application/rss+xml\",\"href\":\"/feed.xml\"}],[\"$\",\"body\",null,{\"className\":\"bg-white text-black antialiased dark:bg-gray-950 dark:text-white\",\"children\":[\"$\",\"$Lb\",null,{\"children\":[[[\"$\",\"$Lc\",null,{\"strategy\":\"lazyOnload\",\"data-domain\":\"johns.codes\",\"data-api\":\"$undefined\",\"src\":\"https://plausible.io/js/plausible.js\"}],[\"$\",\"$Lc\",null,{\"strategy\":\"lazyOnload\",\"id\":\"plausible-script\",\"children\":\"\\n            window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }\\n        \"}]],[\"$\",\"section\",null,{\"className\":\"mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex h-screen flex-col justify-between font-sans\",\"children\":[[\"$\",\"$Ld\",null,{\"kbarConfig\":{\"searchDocumentsPath\":\"search.json\"},\"children\":[[\"$\",\"header\",null,{\"className\":\"flex items-center justify-between py-10\",\"children\":[[\"$\",\"div\",null,{\"children\":[\"$\",\"$Le\",null,{\"href\":\"/\",\"aria-label\":\"John's Codes\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-center justify-between\",\"children\":[\"$\",\"div\",null,{\"className\":\"hidden h-6 text-2xl font-semibold sm:block\",\"children\":\"John's Codes\"}]}]}]}],[\"$\",\"div\",null,{\"className\":\"flex items-center space-x-4 leading-5 sm:space-x-6\",\"children\":[[[\"$\",\"$Le\",null,{\"href\":\"/blog\",\"className\":\"hidden font-medium text-gray-900 dark:text-gray-100 sm:block\",\"children\":\"Blog\"}],[\"$\",\"$Le\",null,{\"href\":\"/tags\",\"className\":\"hidden font-medium text-gray-900 dark:text-gray-100 sm:block\",\"children\":\"Tags\"}],[\"$\",\"$Le\",null,{\"href\":\"/projects\",\"className\":\"hidden font-medium text-gray-900 dark:text-gray-100 sm:block\",\"children\":\"Projects\"}],[\"$\",\"$Le\",null,{\"href\":\"/about\",\"className\":\"hidden font-medium text-gray-900 dark:text-gray-100 sm:block\",\"children\":\"About\"}]],[\"$\",\"$Lf\",null,{\"aria-label\":\"Search\",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"fill\":\"none\",\"viewBox\":\"0 0 24 24\",\"strokeWidth\":1.5,\"stroke\":\"currentColor\",\"className\":\"h-6 w-6 text-gray-900 dark:text-gray-100\",\"children\":[\"$\",\"path\",null,{\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"d\":\"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z\"}]}]}],[\"$\",\"$L10\",null,{}],[\"$\",\"$L11\",null,{}]]}]]}],[\"$\",\"main\",null,{\"className\":\"mb-auto\",\"children\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"div\",null,{\"className\":\"flex flex-col items-start justify-start md:mt-24 md:flex-row md:items-center md:justify-center md:space-x-6\",\"children\":[[\"$\",\"div\",null,{\"className\":\"space-x-2 pb-8 pt-6 md:space-y-5\",\"children\":[\"$\",\"h1\",null,{\"className\":\"text-6xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 md:border-r-2 md:px-6 md:text-8xl md:leading-14\",\"children\":\"404\"}]}],[\"$\",\"div\",null,{\"className\":\"max-w-md\",\"children\":[[\"$\",\"p\",null,{\"className\":\"mb-4 text-xl font-bold leading-normal md:text-2xl\",\"children\":\"Sorry we couldn't find this page.\"}],[\"$\",\"p\",null,{\"className\":\"mb-8\",\"children\":\"But dont worry, you can find plenty of other things on our homepage.\"}],[\"$\",\"$Le\",null,{\"href\":\"/\",\"className\":\"focus:shadow-outline-blue inline rounded-lg border border-transparent bg-blue-600 px-4 py-2 text-sm font-medium leading-5 text-white shadow transition-colors duration-150 hover:bg-blue-700 focus:outline-none dark:hover:bg-blue-500\",\"children\":\"Back to homepage\"}]]}]]}],\"notFoundStyles\":[],\"styles\":null}]}]]}],[\"$\",\"footer\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"mt-16 flex flex-col items-center\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-3 flex space-x-4\",\"children\":[null,[\"$\",\"a\",null,{\"className\":\"text-sm text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/JRMurr\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"github\"}],[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 24 24\",\"className\":\"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6\",\"children\":[\"$\",\"path\",null,{\"d\":\"M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12\"}]}]]}],[\"$\",\"a\",null,{\"className\":\"text-sm text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://twitter.com/JRMurrCodes\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"twitter\"}],[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 24 24\",\"className\":\"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6\",\"children\":[\"$\",\"path\",null,{\"d\":\"M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z\"}]}]]}],[\"$\",\"a\",null,{\"className\":\"text-sm text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://hachyderm.io/@jrmurr\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"mastodon\"}],[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 24 24\",\"className\":\"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6\",\"children\":[\"$\",\"path\",null,{\"d\":\"$12\"}]}]]}],[\"$\",\"a\",null,{\"className\":\"text-sm text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"/feed.xml\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"rss\"}],[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 24 24\",\"className\":\"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M3.692 17.517A3.696 3.696 0 0 0 0 21.211C0 23.244 1.656 24.9 3.692 24.9s3.694-1.657 3.694-3.689a3.697 3.697 0 0 0-3.694-3.694z\"}],[\"$\",\"path\",null,{\"d\":\"M.384 8.142A.386.386 0 0 0 0 8.527v4.688c0 .211.173.383.384.383 6.02 0 10.919 4.898 10.919 10.92 0 .209.171.383.384.383h4.705a.385.385 0 0 0 .387-.383l-.018-.121C16.692 15.423 9.37 8.142.384 8.142z\"}],[\"$\",\"path\",null,{\"d\":\"M24.89 24.397C24.825 10.936 13.854.011.384.011A.385.385 0 0 0 0 .397v4.824c0 .212.173.383.384.383 10.429 0 18.913 8.486 18.913 18.914 0 .209.172.383.382.383h4.845a.39.39 0 0 0 .388-.383l-.022-.121z\"}]]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400\",\"children\":[[\"$\",\"div\",null,{\"children\":\"John Murray\"}],[\"$\",\"div\",null,{\"children\":\" • \"}],[\"$\",\"div\",null,{\"children\":\"© 2024\"}],[\"$\",\"div\",null,{\"children\":\" • \"}],[\"$\",\"$Le\",null,{\"href\":\"/\",\"children\":\"John's Codes\"}]]}]]}]}]]}]}]]}]}]]}],null]],\"initialHead\":[false,\"$L13\"],\"globalErrorComponent\":\"$14\",\"missingSlots\":\"$W15\"}]]\n"])</script><script>self.__next_f.push([1,"16:I[144,[\"250\",\"static/chunks/250-a30085ccab20449f.js\",\"749\",\"static/chunks/749-ed776d54eb5c7205.js\",\"797\",\"static/chunks/app/blog/%5B...slug%5D/page-fd9b73ee915812e8.js\"],\"\"]\n17:I[2502,[\"250\",\"static/chunks/250-a30085ccab20449f.js\",\"749\",\"static/chunks/749-ed776d54eb5c7205.js\",\"797\",\"static/chunks/app/blog/%5B...slug%5D/page-fd9b73ee915812e8.js\"],\"\"]\n1b:I[4282,[\"250\",\"static/chunks/250-a30085ccab20449f.js\",\"749\",\"static/chunks/749-ed776d54eb5c7205.js\",\"797\",\"static/chunks/app/blog/%5B...slug%5D/page-fd9b7"])</script><script>self.__next_f.push([1,"3ee915812e8.js\"],\"\"]\n1c:I[4970,[\"250\",\"static/chunks/250-a30085ccab20449f.js\",\"749\",\"static/chunks/749-ed776d54eb5c7205.js\",\"797\",\"static/chunks/app/blog/%5B...slug%5D/page-fd9b73ee915812e8.js\"],\"\"]\n18:T28c37,"])</script><script>self.__next_f.push([1,"const{Fragment:e,jsx:s,jsxs:l}=arguments[0];function _createMdxContent(i){const r={a:\"a\",code:\"code\",div:\"div\",h2:\"h2\",h3:\"h3\",li:\"li\",p:\"p\",pre:\"pre\",span:\"span\",ul:\"ul\",...i.components},{Note:a,TOCInline:n}=r;return a||_missingMdxReference(\"Note\",!0),n||_missingMdxReference(\"TOCInline\",!0),l(e,{children:[s(n,{toc:i.toc,asDisclosure:!0}),l(r.p,{children:['While I\\'ve used rust for a while and have had a few small projects in it, I felt like I was missing a truly \"systems\" project. So when I came across ',s(r.a,{href:\"https://cstack.github.io/db_tutorial/\",children:\"this series\"}),\" for making a simple DB in C, I figured why not try to make my basic DB in rust. I will roughly follow the structure of that series at first, but I will most likely deviate and focus on what interests me more.\"]}),l(r.p,{children:[\"This series will be mostly a dev log (I'm making this up as I go) but will try to do what I can to use it as tutorial content when possible. I will probably get things wrong, so please call me out in comments, on my \",s(r.a,{href:\"https://github.com/JRMurr/JRMurr.github.io\",children:\"GitHub\"}),\", or my \",s(r.a,{href:\"/about\",children:\"socials\"})]}),s(r.p,{children:\"I hate naming things, so I'll keep it basic, I will be calling my DB SQLJr\"}),l(r.p,{children:[\"If you wanna just jump to some code \",s(r.a,{href:\"https://github.com/JRMurr/SQLJr\",children:\"this is the repo for it\"}),\". It will be mostly the same with some minor tweaks here and there (and more up-to-date).\"]}),l(r.h2,{id:\"what-am-i-making\",children:[s(r.a,{href:\"#what-am-i-making\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:s(r.span,{className:\"icon icon-link\"})}),\"What am I Making\"]}),s(r.p,{children:\"I plan on mostly focusing on building my own SQL (not following any spec) that will have basic filtering, aggregates, and joins. Since rust has many B-Tree libraries (One of the core data structures for how to store/search rows), I will try to focus more on good concurrency+transaction support instead of building my own B-tree/persistence logic. Also, many Rust based tools I used have excellent error messages, so I will try to have good/informative errors for all parts of the DB.\"}),s(r.p,{children:\"I will probably end up on some side tangents from those core features, so I will follow whatever vibe I get.\"}),l(r.p,{children:[\"In this post, we will focus on getting the project setup and building a basic REPL (in a similar vein to \",s(r.a,{href:\"https://www.postgresql.org/docs/current/app-psql.html\",children:\"psql\"}),\") + parser to make it easy to interact with the rest of the DB later on.\"]}),l(r.h2,{id:\"project-setup\",children:[s(r.a,{href:\"#project-setup\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:s(r.span,{className:\"icon icon-link\"})}),\"Project setup\"]}),l(r.p,{children:[\"I love \",s(r.a,{href:\"https://nixos.org/\",children:\"Nix\"}),\", so I always start with that to get rust installed. I recently made my own \",s(r.a,{href:\"https://github.com/JRMurr/NixOsConfig/tree/main/templates\",children:\"nix flake templates\"}),\" to make starting new projects easier. You can run\"]}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"$\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:\" nix\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:\" flake\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\" --refresh\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:\" new\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\" --template\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:\" github:JRMurr/NixOsConfig#rust\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" \u003c\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:\"pathToProjectDi\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"r\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u003e\"})]}),\"\\n\",s(r.span,{className:\"line\"})]})}),l(r.p,{children:[\"to create a new folder with a \",s(r.code,{children:\"flake.nix\"}),\" file to get rust setup with nightly, update the \",s(r.code,{children:\"rust-toolchain.toml\"}),\" to the most recent nightly.\"]}),l(r.p,{children:[\"The template does not include a \",s(r.code,{children:\"Cargo.toml\"}),\" so make one with \",s(r.code,{children:\"cargo init\"}),\" or \",s(r.code,{children:\"cargo new\"}),\" to set up the crate.\"]}),l(r.h3,{id:\"cargo-workspaces\",children:[s(r.a,{href:\"#cargo-workspaces\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:s(r.span,{className:\"icon icon-link\"})}),\"Cargo Workspaces\"]}),l(r.p,{children:[\"While we could probably get away with having a \",s(r.code,{children:\"core\"}),\"/\",s(r.code,{children:\"lib\"}),\" crate and then make an \",s(r.code,{children:\"application\"}),\" crate for CLI/HTTP access to the DB, I would like to try to split up the crates across more logical boundaries. This helps out with compile times since rust can compile each crate in parallel. My current idea is a different crate for\"]}),l(r.ul,{children:[s(r.li,{children:\"a CLI/REPL to interact with a db\"}),s(r.li,{children:\"Parsing SQL\"}),s(r.li,{children:\"Query Execution\"})]}),s(r.p,{children:\"Some things like defining the different commands/queries don't quite feel right in being in the parsing/execution crates so might make sense to add a crate just for shared types.\"}),l(r.p,{children:[\"To set up cargo workspaces make a \",s(r.code,{children:\"Cargo.toml\"}),\" that looks like\"]}),s(r.div,{className:\"remark-code-title\",children:\"Cargo.toml\"}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"[\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"workspace\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"]\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"members = [\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"    # all crates in a `./crates` folder will be added to the workspace\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\\t\"crates/*\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"]\"})}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"# https://doc.rust-lang.org/nightly/cargo/reference/specifying-dependencies.html#inheriting-a-dependency-from-a-workspace\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"# Shared dependencies across all workspace crates\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"[\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"workspace\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"dependencies\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"]\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"# these are very likely to be used across all/most crates so pin the version for them all\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"miette = \"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"5.5.0\"'})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"serde = { version = \"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"1.0.151\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", features = [\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"derive\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"] }\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"thiserror = \"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"1.0.38\"'})]}),\"\\n\",s(r.span,{className:\"line\"})]})}),s(r.p,{children:\"This will tell cargo we are using workspaces. Once we start making crates I will explain how to use the shared dependencies listed above\"}),l(r.h2,{id:\"the-repl\",children:[s(r.a,{href:\"#the-repl\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:s(r.span,{className:\"icon icon-link\"})}),\"The REPL\"]}),s(r.p,{children:'While we could go right to execution or parsing and just develop with unit tests, I like having some form of interactivity as soon as possible. The unit test approach would definitely make sense if this was a \"real\" project, for personal stuff I\\'m fine being a bit in the wild west to make life easier.'}),l(r.p,{children:[\"So to get to interactivity let's make a REPL. We can make a new crate by going into the \",s(r.code,{children:\"crates\"}),\" directory and running \",s(r.code,{children:\"cargo new sql_jr_repl\"}),\". The \",s(r.a,{href:\"https://github.com/kkawakam/rustyline\",children:\"rustyline crate\"}),\" seems like it will cover the basics for a REPL, so we can add it with \",s(r.code,{children:\"cargo add rustyline\"}),\"in the\",s(r.code,{children:\"sql_jr_repl\"}),\" directory.\"]}),s(r.p,{children:\"We can copy the example with some small tweaks to get started\"}),s(r.div,{className:\"remark-code-title\",children:\"sql_jr_repl/main.rs\"}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"use\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" rustyline\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"error\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"ReadlineError\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\";\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"use\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" rustyline\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"{\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Editor\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Result\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"};\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"const\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\" HISTORY_FILE\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" \u0026\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"str\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" =\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:' \"./history.txt\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\";\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" main\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"() \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Result\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c()\u003e {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    let\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" mut\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" rl \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Editor\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c()\u003e\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"new\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"?\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\";\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    if\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" rl\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"load_history\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"HISTORY_FILE\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"is_err\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"() {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"        println!\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"No previous history.\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\");\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    loop\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"        let\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" readline \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" rl\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"readline\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"\u003e\u003e \"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\");\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"        match\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" readline {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"            Ok\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(line) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\u003e\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                rl\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"add_history_entry\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(line\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"as_str\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"());\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                println!\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"Line: {}\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", line);\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            },\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"            Err\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"ReadlineError\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Interrupted\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\") \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\u003e\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"                // CTRL-C so just skip\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            },\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"            Err\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"ReadlineError\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Eof\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\") \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\u003e\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"                // CTRL-D so exit\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                break\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            },\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"            Err\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(err) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\u003e\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                println!\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"Error: {:?}\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", err);\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                break\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    rl\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"save_history\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"HISTORY_FILE\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"})]})}),l(r.p,{children:[\"This will store the history in a local file (we can use the user's home/XDG dirs to store it elsewhere later) and allow \",s(r.code,{children:\"CTRL-C\"}),' to \"cancel\" the current input and have ',s(r.code,{children:\"CTRL-D\"}),\"/an error exit the REPL. Try it out with \",s(r.code,{children:\"cargo run\"}),\", it will just repeat the lines you send with enter and run until you hit \",s(r.code,{children:\"CTRL-D\"}),\".\"]}),l(r.h2,{id:\"parsing\",children:[s(r.a,{href:\"#parsing\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:s(r.span,{className:\"icon icon-link\"})}),\"Parsing\"]}),l(r.p,{children:[\"Now that the basic REPL is set up we can work on parsing our simple SQL. In Rust, I have usually used \",s(r.a,{href:\"https://github.com/Geal/nom\",children:\"nom\"}),' when I need to make a parser. I like that I stay in rust and don\\'t need to mess with a new \"language\" to get my parsing code. With that said ',s(r.a,{href:\"https://pest.rs/\",children:\"pest\"}),\" looks pretty great as a more generator approach and may end up switching to that later on.\"]}),l(r.h3,{id:\"nom-for-dummies\",children:[s(r.a,{href:\"#nom-for-dummies\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:s(r.span,{className:\"icon icon-link\"})}),\"nom for dummies\"]}),l(r.p,{children:[\"nom is a \",s(r.a,{href:\"https://en.wikipedia.org/wiki/Parser_combinator\",children:\"parser combinator library\"}),\". The TLDR for that is you make functions that take in parsers and output parsers to build up your grammar.\"]}),s(r.p,{children:\"Here are some examples\"}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"// IResult tracks the input type (generally string or bytes) and the output type for the parser\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" parser\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(s\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" \u0026\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"str\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\") \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" IResult\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"str\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"str\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"  tag_no_case\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"hello\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")(s)\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"// when you run a parser on some input it will return the remaining input in the first param\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"// and the matched input for that parser that ran\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"assert_eq!\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"parser\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"Hello, World!\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"), \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Ok\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"((\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\", World!\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"Hello\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")));\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"// NOTE: this is missing some trait bounds but the vibe is right\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"/// Run the given parser f on a comma seperated list\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"pub\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"crate\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\") \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" comma_sep\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"I\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"O\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"E\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"F\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e(\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    f\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" F\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\") \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" impl\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" FnMut\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"I\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\") \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" IResult\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"I\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Vec\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"O\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e, \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"E\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"where\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"{\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"    separated_list1\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"tuple\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"((multispace0, \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"char\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:\"','\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"), multispace0)), f)\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"})]})}),l(r.p,{children:[\"There are \",s(r.a,{href:\"https://github.com/Geal/nom/blob/main/doc/choosing_a_combinator.md\",children:\"many combinators\"}),\" provided by nom.\"]}),l(r.h3,{id:\"my-own-sql\",children:[s(r.a,{href:\"#my-own-sql\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:s(r.span,{className:\"icon icon-link\"})}),\"My Own SQL\"]}),s(r.p,{children:\"Right now I'm going to handle basic select, insert, and create table statements that will look like\"}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[s(r.span,{className:\"line\",children:s(r.span,{children:\"CREATE TABLE FOO (\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\"    col1 string,\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\"    col2 int\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\")\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\"INSERT INTO FOO VALUES 1,2;\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\"SELECT col1, col2 FROM foo;\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{})})]})}),l(r.p,{children:[\"To start we can make a new lib crate \",s(r.code,{children:\"sql_jr_parser\"}),\". We will add in nom, \",s(r.a,{href:\"https://github.com/fflorent/nom_locate\",children:\"nom_locate\"}),\", and \",s(r.a,{href:\"https://github.com/Lucretiel/nom-supreme\",children:\"nom_supreme\"}),\". \",s(r.code,{children:\"nom_locate\"}),\" has a nice \",s(r.code,{children:\"LocatedSpan\"}),\" type to easily track where in the source code a parser ran/threw an error. \",s(r.code,{children:\"nom_supreme\"}),\" is a nom utility lib, we will use it mostly for postfix calls on parsers to make the code a little easier to read and \",s(r.a,{href:\"https://docs.rs/nom-supreme/latest/nom_supreme/error/type.ErrorTree.html\",children:\"error tree\"}),\" to help with error formatting\"]}),l(r.p,{children:[\"To be completely honest we probably could get by without \",s(r.code,{children:\"nom_locate\"}),\" and just use \",s(r.code,{children:\"nom_supreme\"}),\" but if it's good enough for \",s(r.a,{href:\"https://fasterthanli.me/series/advent-of-code-2022/part-11#nice-parser-errors\",children:\"Amos\"}),\" it's good enough for me\"]}),l(r.h3,{id:\"actual-parsing\",children:[s(r.a,{href:\"#actual-parsing\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:s(r.span,{className:\"icon icon-link\"})}),\"Actual parsing\"]}),s(a,{children:s(r.p,{children:\"nom requires ALOT of imports so will be ignoring most of them in the code snippets\"})}),s(r.p,{children:\"First, we need to define some type aliases\"}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"// Use nom_locate's LocatedSpan as a wrapper around a string input\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" type\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" RawSpan\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" LocatedSpan\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" str\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e;\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"// the result for all of our parsers, they will have our span type as input and can have any output\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"// this will use a default error type but we will change that latter\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" type\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" ParseResult\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"T\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" IResult\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"RawSpan\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e, \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"T\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e\"})]}),\"\\n\",s(r.span,{className:\"line\"})]})}),s(r.p,{children:\"We will need to parse identifiers for columns and tables so let's make a parser for that\"}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"/// Parse a unquoted sql identifier\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"pub\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"crate\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\") \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" identifier\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(i\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" RawSpan\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\") \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" ParseResult\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"String\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"    map\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"take_while1\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"c\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" char\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" c\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"is_alphanumeric\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()), \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"s\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" RawSpan\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        s\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"fragment\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"to_string\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    })(i)\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"})]})}),l(r.p,{children:[\"Since we made the parser take in a \",s(r.code,{children:\"RawSpan\"}),\" instead of just a \",s(r.code,{children:\"\u0026 str\"}),\" or \",s(r.code,{children:\"String\"}),\" we would need to first call \",s(r.code,{children:\"LocatedSpan::new(input_str)\"}),\" to call our parsers.\"]}),l(r.h3,{id:\"helper-trait\",children:[s(r.a,{href:\"#helper-trait\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:s(r.span,{className:\"icon icon-link\"})}),\"Helper trait\"]}),s(r.p,{children:\"Since we will have a lot of different things we need to parse let's make a trait to make it easier to track what each parser is for.\"}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"/// Implement the parse function to more easily convert a span into a sql\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"/// command\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" trait\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Parse\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Sized\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"    /// Parse the given span into self\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" parse\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(input\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" RawSpan\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" ParseResult\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"Self\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e;\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"    /// Helper method for tests to convert a str into a raw span and parse\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" parse_from_raw\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(input\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" \u0026\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" str\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\") \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" ParseResult\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"Self\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"        let\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" i \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" LocatedSpan\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"new\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(input);\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"        Self\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"parse\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(i)\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"})]})}),l(r.p,{children:[\"Now anything we want to parse can implement a \",s(r.code,{children:\"Parse\"}),\" method which lets us compose types/parsers, and we can add any helper functions into this trait we need for testing or error handling.\"]}),l(r.h3,{id:\"parsing-create-table\",children:[s(r.a,{href:\"#parsing-create-table\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:s(r.span,{className:\"icon icon-link\"})}),\"Parsing Create Table\"]}),s(r.p,{children:\"Create table statements need to parse/extract 3 things\"}),l(r.ul,{children:[s(r.li,{children:\"The table name we will create\"}),s(r.li,{children:\"The column names\"}),s(r.li,{children:\"The types for those columns\"})]}),s(r.p,{children:\"So let's make a type + parser for each\"}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"// Using tag_no_case from nom_supreme since its error is nicer\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"// ParserExt is mostly for adding `.context` on calls to identifier to say what kind of identifier we want\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"use\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" nom_supreme\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"{\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"tag\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"complete\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"tag_no_case, \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"ParserExt\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"};\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"// many other imports omitted\"})}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"/// A colum's type\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"#[derive(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Debug\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Clone\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Eq\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Hash\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"PartialEq\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Serialize\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Deserialize\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")]\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" enum\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" SqlTypeInfo\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"    // these are basic for now. Will add more + size max later on\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"    String\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"    Int\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:'// parses \"string | int\"'})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"impl\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Parse\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"for\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" SqlTypeInfo\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" parse\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(input\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" RawSpan\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" ParseResult\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"Self\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"        // context will help give better error messages later on\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"        context\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'            \"Column Type\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"            // alt will try each passed parser and return what ever succeeds\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"            alt\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"((\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                map\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"tag_no_case\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"string\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"), \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"_\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\" Self\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"String\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"),\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                map\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"tag_no_case\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"int\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"), \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"_\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\" Self\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Int\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"),\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            )),\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        )(input)\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"/// A column's name + type\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"#[derive(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Debug\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Clone\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Eq\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Hash\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"PartialEq\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Serialize\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Deserialize\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")]\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" struct\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Column\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    pub\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" name\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" String\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    pub\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" type_info\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" SqlTypeInfo\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:'// parses \"\u003ccolName\u003e \u003ccolType\u003e\"'})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"impl\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Parse\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"for\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Column\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" parse\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(input\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" RawSpan\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" ParseResult\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"Self\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"        context\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'            \"Create Column\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"            map\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                separated_pair\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                    identifier\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"context\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"Column Name\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"),\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                    multispace1,\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                    SqlTypeInfo\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"parse,\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                ),\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                |\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(name, type_info)\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\" Self\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" { name, type_info },\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            ),\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        )(input)\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"/// The table and its columns to create\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"#[derive(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Clone\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Debug\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Default\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Eq\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Hash\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"PartialEq\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Serialize\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Deserialize\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")]\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" struct\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" CreateStatement\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    pub\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" table\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" String\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    pub\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" columns\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Vec\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Column\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e,\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"// parses a comma seperated list of column definitions contained in parens\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" column_definitions\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(input\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" RawSpan\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"_\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" ParseResult\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"_\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Vec\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Column\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e\u003e {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"    context\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'        \"Column Definitions\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"        map\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"            tuple\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"((\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"char\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:\"'('\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"), \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"comma_sep\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Column\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"parse), \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"char\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:\"')'\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"))),\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            |\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(_, cols, _)\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" cols,\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        ),\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    )(input)\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:'// parses \"CREATE TABLE \u003ctable name\u003e \u003ccolumn defs\u003e'})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"impl\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Parse\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"for\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" CreateStatement\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" parse\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(input\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" RawSpan\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" ParseResult\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"Self\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"        map\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"            separated_pair\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"                // table name\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                preceded\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                    tuple\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"((\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                        tag_no_case\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"create\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"),\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                        multispace1,\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                        tag_no_case\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"table\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"),\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                        multispace1,\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                    )),\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                    identifier\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"context\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"Table Name\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"),\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                ),\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                multispace1,\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"                // column defs\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                column_definitions,\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            )\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"context\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"Create Table\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"),\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            |\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(table, columns)\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\" Self\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" { table, columns },\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        )(input)\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"// I was a test hater earlier but may as well cover the basics...\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"#[cfg(test)]\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"mod\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" tests\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    use\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\" super\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::*\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\";\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    #[test]\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" test_create\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"() {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"        let\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" expected \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" CreateStatement\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            table\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:' \"foo\"'}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"into\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(),\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            columns\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" vec!\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"[\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                Column\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                    name\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:' \"col1\"'}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"into\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(),\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                    type_info\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" SqlTypeInfo\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Int\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                },\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                Column\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                    name\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:' \"col2\"'}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"into\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(),\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                    type_info\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" SqlTypeInfo\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"String\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                },\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                Column\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                    name\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:' \"col3\"'}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"into\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(),\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                    type_info\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" SqlTypeInfo\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"String\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                },\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            ],\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        };\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"        assert_eq!\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"            CreateStatement\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"parse_from_raw\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'                \"CREATE TABLE foo (col1 int, col2 string, col3 string)\"'})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            )\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"unwrap\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            .\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"1\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            expected\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        )\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"})]})}),s(r.p,{children:\"I will skip out on including the parsing for select/insert, but the vibes are similar.\"}),l(r.h3,{id:\"pulling-it-all-together\",children:[s(r.a,{href:\"#pulling-it-all-together\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:s(r.span,{className:\"icon icon-link\"})}),\"Pulling it all together\"]}),l(r.p,{children:[\"Now that we can parse each of our commands we need to tell nom to try each of them. We can do that with the \",s(r.a,{href:\"https://docs.rs/nom/latest/nom/branch/fn.alt.html\",children:\"alt combinator\"}),\" to try each parser and see which one succeeds.\"]}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"/// All possible commands\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"#[derive(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Clone\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Debug\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Eq\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Hash\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"PartialEq\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Serialize\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Deserialize\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")]\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" enum\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" SqlQuery\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"    Select\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"SelectStatement\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"),\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"    Insert\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"InsertStatement\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"),\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"    Create\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"CreateStatement\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"),\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"impl\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Parse\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"for\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" SqlQuery\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" parse\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(input\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" RawSpan\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" ParseResult\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"Self\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"        let\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" (rest, (query, _, _, _)) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" context\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'            \"Query\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"            preceded\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                multispace0,\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                tuple\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"((\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                    alt\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"((\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"                        // this feels ripe for a derive macro but another time....\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                        map\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"SelectStatement\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"parse, \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"SqlQuery\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Select\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"),\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                        map\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"InsertStatement\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"parse, \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"SqlQuery\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Insert\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"),\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                        map\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"CreateStatement\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"parse, \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"SqlQuery\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Create\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"),\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                    )),\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                    multispace0,\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                    char\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:\"';'\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"),\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                    multispace0,\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                )),\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            ),\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        )(input)\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"?\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\";\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"        Ok\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"((rest, query))\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"#[cfg(test)]\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"mod\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" tests\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    use\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\" super\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::*\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\";\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    #[test]\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" test_error\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"() {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"        let\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" query \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" SqlQuery\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"parse_from_raw\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"select fart;\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\");\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"        assert!\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(query\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"is_err\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(), \"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"expected parse to fail, got {query:?}\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\");\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    #[test]\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" test_select\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"() {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"        let\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" expected \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" SelectStatement\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            tables\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" vec!\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"[\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"t1\"'}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"to_string\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(), \"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"t2\"'}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"to_string\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()],\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            fields\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" vec!\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"[\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"foo\"'}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"to_string\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(), \"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"bar\"'}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"to_string\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()],\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        };\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"        assert_eq!\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"            SqlQuery\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"parse_from_raw\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"select foo, bar from t1,t2;\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"unwrap\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                .\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"1\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"            SqlQuery\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Select\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(expected)\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        )\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"})]})}),l(r.p,{children:[\"Now that we have command parsing we can add it to our REPL. First, we need to add our parser crate to our \",s(r.code,{children:\"Cargo.toml\"}),\" in the REPL crate\"]}),s(r.div,{className:\"remark-code-title\",children:\"sql_jr_repl/Cargo.toml\"}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#b31d28\",\"--shiki-dark\":\"#FDAEB7\",fontStyle:\"italic\",\"--shiki-dark-font-style\":\"italic\"},children:\"...\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"[\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"dependencies\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"]\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#b31d28\",\"--shiki-dark\":\"#FDAEB7\",fontStyle:\"italic\",\"--shiki-dark-font-style\":\"italic\"},children:\"...\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"sql_jr_parser = { path = \"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"../sql_jr_parser\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" }\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#b31d28\",\"--shiki-dark\":\"#FDAEB7\",fontStyle:\"italic\",\"--shiki-dark-font-style\":\"italic\"},children:\"...\"})}),\"\\n\",s(r.span,{className:\"line\"})]})}),s(r.p,{children:\"then update our main function\"}),s(r.div,{className:\"remark-code-title\",children:\"sql_jr_repl/main.rs\"}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"...\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    match\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" readline {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"            Ok\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(line) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\u003e\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                match\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" SqlQuery\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"parse_from_raw\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(line\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"as_ref\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()) {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                    Ok\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(q) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\u003e\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" println!\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"{q:?}\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"),\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                    Err\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(e) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\u003e\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" eprintln!\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"{e:?}\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"),\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            }\"})}),\"\\n\",s(r.span,{className:\"line\"})]})}),s(r.p,{children:\"Now we can finally type some stuff and have different things come back.\"}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[s(r.span,{className:\"line\",children:s(r.span,{children:\"\u003e\u003e select col1 from foo;\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:'(LocatedSpan { offset: 21, line: 1, fragment: \"\", extra: () }, Select(SelectStatement { tables: [\"foo\"], fields: [\"col1\"] }))'})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{})})]})}),s(r.p,{children:\"However, when we get an error we just get a debug out, gross... let's fix that.\"}),l(r.h3,{id:\"parser-errors\",children:[s(r.a,{href:\"#parser-errors\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:s(r.span,{className:\"icon icon-link\"})}),\"Parser Errors\"]}),s(r.p,{children:\"Errors can be a giant rabbit hole to keep improving. For now, as long as we show a span in the source tree and highlight the sad spots I'll be happy.\"}),l(r.p,{children:[\"I will be using \",s(r.a,{href:\"https://github.com/zkat/miette\",children:\"miette\"}),\" to format/display errors. It can hook into source errors very easily and can show help, context, and much more.\"]}),s(r.p,{children:\"Our error types will look like\"}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"use\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" miette\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Diagnostic\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\";\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"use\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" nom_supreme\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"error\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"{\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"BaseErrorKind\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"ErrorTree\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"GenericErrorTree\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"StackContext\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"};\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"use\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" thiserror\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Error\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\";\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"#[derive(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Error\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Debug\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Diagnostic\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")]\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"#[error(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"Parse Error\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")]\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" struct\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" FormattedError\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"b\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"    // need 'b since Diagnostic derive uses 'a\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    #[source_code]\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    src\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" \u0026\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"b\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" str\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    #[label(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"{kind}\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")]\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    span\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" miette\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"SourceSpan\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"    // will explain this later. TLDR: the parsing error\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    kind\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" BaseErrorKind\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"b\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" str\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Box\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"dyn\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" std\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"error\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Error\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" +\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Send\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" +\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Sync\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" +\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" '\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"static\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e\u003e,\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    #[related]\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    others\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Vec\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"FormattedErrorContext\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"b\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e\u003e,\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"#[derive(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Error\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Debug\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Diagnostic\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")]\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"#[error(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"Parse Error Context\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")]\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" struct\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" FormattedErrorContext\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"b\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    #[source_code]\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    src\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" \u0026\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"b\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" str\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    #[label(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"{context}\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")]\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    span\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" miette\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"SourceSpan\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    context\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" StackContext\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"b\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" str\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e,\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"})]})}),l(r.p,{children:[\"These types can be used as normal rust error types without issue but when used in a miette \",s(r.code,{children:\"Reporter\"}),\" we can get output like\"]}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[s(r.span,{className:\"line\",children:s(r.span,{children:\"\u003e\u003e select 1 fr\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\"  × Parse Error\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\"   ╭────\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\" 1 │ select 1 fr\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\"   ·          ▲\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:'   ·          ╰── expected \"from\"'})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\"   ╰────\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\"Error:\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\"  × Parse Error Context\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\"   ╭────\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\" 1 │ select 1 fr\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\"   · ▲\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:'   · ╰── in section \"Select Statement\"'})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\"   ╰────\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\"Error:\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\"  × Parse Error Context\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\"   ╭────\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\" 1 │ select 1 fr\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\"   · ▲\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:'   · ╰── in section \"Query\"'})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\"   ╰────\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{})})]})}),l(r.p,{children:[\"The main magic here is the \",s(r.code,{children:\"#[source_code]\"}),\" macro marking what the passed string was and\"]}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"#[label(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"{kind}\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")]\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"span\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" miette\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"SourceSpan\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"kind\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" BaseErrorKind\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"b\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" str\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Box\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"dyn\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" std\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"error\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Error\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" +\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Send\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" +\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Sync\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" +\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" '\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"static\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e\u003e,\"})]}),\"\\n\",s(r.span,{className:\"line\"})]})}),l(r.p,{children:[\"which tells miette to mark the provided span (the location in the source code) with the error display from \",s(r.code,{children:\"kind\"}),\".\"]}),l(r.p,{children:[\"Here we use the \",s(r.a,{href:\"https://docs.rs/nom-supreme/latest/nom_supreme/error/type.ErrorTree.html\",children:\"error tree\"}),\" type to specify the parsing error.\"]}),l(r.p,{children:['The error tree type will make it easier to handle errors on \"alts\" (like our root type). If you tried to parse ',s(r.code,{children:\"select +!@#!@!!\"}),\" nom would fail in the select parser but still try the other ones, so it would not know what parser errors to show. That issue can be fixed slightly with \",s(r.a,{href:\"https://docs.rs/nom/latest/nom/combinator/fn.cut.html\",children:\"cut\"}),\" to not try other branches in the alt if we know for sure we are in a select/insert/create/etc.\"]}),l(r.p,{children:[\"However, cases like parsing \",s(r.code,{children:\"I like rust\"}),\" are tough, all the parsers would fail without being cut, so what can we show? Ideally, we would say something like \",s(r.code,{children:\"expected select|create|insert, got ....\"}),\" which the error tree type will help with (though not now).\"]}),l(r.p,{children:[\"To get these errors we first need to update \",s(r.code,{children:\"ParseResult\"}),\" to use the error tree type as its error type.\"]}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"// Alias for later\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" type\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" MyParseError\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" ErrorTree\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"RawSpan\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e\u003e;\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" type\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" ParseResult\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"T\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" IResult\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"RawSpan\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e, \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"T\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"MyParseError\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e;\"})]}),\"\\n\",s(r.span,{className:\"line\"})]})}),s(r.p,{children:\"The beauty of nom is we don't need to update any code in our existing parsers to change the error type, they were all generic over it.\"}),s(r.p,{children:\"Now we need to convert the error tree error into our miette error type\"}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" format_parse_error\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e(input\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" \u0026\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" str\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", e\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" MyParseError\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" FormattedError\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    match\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" e {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:'        // a \"normal\" error like unexpected charcter'})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"        GenericErrorTree\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Base\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" { location, kind } \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\u003e\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"            // the location type is nom_locate's RawSpan type\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"            // Might be nice to just use our own span/make a wrapper to implement\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"            // From\u003cOurSpan\u003e for miette::SourceSpan\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            let\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" offset \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" location\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"location_offset\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"into\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"();\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"            FormattedError\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                src\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" input,\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                span\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" miette\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"SourceSpan\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"new\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(offset, \"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"0.\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"into\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()),\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                kind,\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                others\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Vec\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"new\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(),\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"        // an error that has a context attached (from nom's context function)\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"        GenericErrorTree\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Stack\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" { base, contexts } \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\u003e\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            let\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" mut\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" base \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" format_parse_error\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(input, \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"*\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"base);\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            let\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" mut\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" contexts\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Vec\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"FormattedErrorContext\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" contexts\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"into_iter\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"map\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(location, context)\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                    let\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" offset \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" location\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"location_offset\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"into\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"();\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                    FormattedErrorContext\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                        src\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" input,\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                        span\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" miette\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"SourceSpan\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"new\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(offset, \"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"0.\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"into\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()),\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                        context,\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                    }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                })\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"collect\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"();\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            base\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"others\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"append\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026mut\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" contexts);\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            base\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:'        // an error from an \"alt\"'})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"        GenericErrorTree\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Alt\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(alt_errors) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\u003e\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"            // get the error with the most context\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"            // since that parsed the most stuff\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"            // TODO: figure out what to do on ties\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            alt_errors\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"into_iter\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"map\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"e\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" format_parse_error\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(input, e))\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"max_by_key\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"formatted\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" formatted\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"others\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"len\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"())\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"unwrap\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"})]})}),l(r.p,{children:[\"Now to make it easy to get this formatted error add the following to our \",s(r.code,{children:\"Parser\"}),\" trait\"]}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" parse_format_error\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(i\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" \u0026\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" str\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\") \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Result\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"Self\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"FormattedError\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e\u003e {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"        let\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" input \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" LocatedSpan\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"new\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(i);\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"        match\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" all_consuming\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"Self\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"parse)(input)\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"finish\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"() {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"            Ok\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"((_, query)) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\u003e\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Ok\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(query),\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"            Err\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(e) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\u003e\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Err\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"format_parse_error\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(i, e)),\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",s(r.span,{className:\"line\"})]})}),s(r.p,{children:\"Now we can finally update our REPL with\"}),s(r.div,{className:\"remark-code-title\",children:\"sql_jr_repl/Cargo.toml\"}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#b31d28\",\"--shiki-dark\":\"#FDAEB7\",fontStyle:\"italic\",\"--shiki-dark-font-style\":\"italic\"},children:\"...\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"[\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"dependencies\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"]\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"# use the workspace version of miette but also use the fancy feature\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"# to allow for display errors\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"miette = {workspace = \"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"true\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", features = [\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"fancy\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"]}\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#b31d28\",\"--shiki-dark\":\"#FDAEB7\",fontStyle:\"italic\",\"--shiki-dark-font-style\":\"italic\"},children:\"...\"})}),\"\\n\",s(r.span,{className:\"line\"})]})}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"let\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" query \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" parse_sql_query\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(line);\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"match\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" SqlQuery\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"parse_format_error\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(line\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"as_ref\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()) {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"    Ok\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(q) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\u003e\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" println!\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"{q:?}\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"),\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"    Err\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(e) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\u003e\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"        let\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" mut\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" s \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" String\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"new\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"();\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"        GraphicalReportHandler\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"new\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"render_report\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026mut\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" s, \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"e)\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"unwrap\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"();\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"        println!\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"{s}\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\");\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    },\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"})]})}),s(r.p,{children:\"and we finally have some sweet parsing errors.\"}),l(r.h2,{id:\"part-1-wrap-up\",children:[s(r.a,{href:\"#part-1-wrap-up\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:s(r.span,{className:\"icon icon-link\"})}),\"Part 1 wrap up\"]}),s(r.p,{children:\"I definitely went overkill (but still feels like not enough...) on getting the parser errors to work nicely, but our eventual 0 users will appreciate it.\"}),s(r.p,{children:\"Next post will focus on actually running queries (and addressing any feedback I get on this post).\"})]})}return{default:function(e={}){const{wrapper:l}=e.components||{};return l?s(l,{...e,children:s(_createMdxContent,{...e})}):_createMdxContent(e)}};function _missingMdxReference(e,s){throw new Error(\"Expected \"+(s?\"component\":\"object\")+\" `\"+e+\"` to be defined: you likely forgot to import, pass, or provide it.\")}"])</script><script>self.__next_f.push([1,"19:T2186d,"])</script><script>self.__next_f.push([1,"const{Fragment:e,jsx:s,jsxs:l}=arguments[0];function _createMdxContent(i){const r={a:\"a\",annotation:\"annotation\",blockquote:\"blockquote\",code:\"code\",div:\"div\",em:\"em\",h1:\"h1\",h2:\"h2\",h3:\"h3\",img:\"img\",li:\"li\",math:\"math\",mi:\"mi\",mn:\"mn\",mo:\"mo\",mrow:\"mrow\",msub:\"msub\",p:\"p\",pre:\"pre\",semantics:\"semantics\",span:\"span\",ul:\"ul\",...i.components},{TOCInline:a}=r;return a||function(e,s){throw new Error(\"Expected \"+(s?\"component\":\"object\")+\" `\"+e+\"` to be defined: you likely forgot to import, pass, or provide it.\")}(\"TOCInline\",!0),l(e,{children:[s(a,{toc:i.toc,asDisclosure:!0}),l(r.h1,{id:\"feedback-from-part-1\",children:[s(r.a,{href:\"#feedback-from-part-1\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:s(r.span,{className:\"icon icon-link\"})}),\"Feedback from part 1\"]}),l(r.p,{children:[\"I got some very nice feedback from the \",s(r.a,{href:\"/blog/build-a-db/part01\",children:\"first part of this series\"}),\". The main suggestions were to use some different parsing libraries like \",s(r.a,{href:\"https://docs.rs/chumsky/latest/chumsky/\",children:\"chumsky\"}),\" or use an existing SQL parser like \",s(r.a,{href:\"https://github.com/sqlparser-rs/sqlparser-rs\",children:\"sqlparser-rs\"}),\".\"]}),l(r.p,{children:[s(r.code,{children:\"chumsky\"}),\" looks like it handles a lot of the error handling logic I had to do myself while still being defined in rust (no extra language). If I had known of this before I would have used it. Might switch to it later on if our grammar gets more involved. Thanks \",s(r.a,{href:\"https://hachyderm.io/@hjvt/109620348134117972\",children:\"@hjvt@hachyderm.io\"}),\" for the recommendation!\"]}),l(r.p,{children:[s(r.code,{children:\"sqlparser-rs\"}),\" on the other hand looks very well maintained and handles many existing SQL dialects. If this was not a toy project I would have probably started off with this to get going faster without writing any parser logic.\"]}),s(r.p,{children:\"Enough feedback, let's get into actually running queries.\"}),l(r.h1,{id:\"execution\",children:[s(r.a,{href:\"#execution\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:s(r.span,{className:\"icon icon-link\"})}),\"Execution\"]}),l(r.p,{children:[\"To get started on execution let's make a new crate for it with \",s(r.code,{children:\"cargo new sql_jr_execution\"}),\". We will need the parser crate for our types we made and some other workspace dependencies.\"]}),s(r.div,{className:\"remark-code-title\",children:\"sql_jr_execution/Cargo.toml\"}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"[\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"package\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"]\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"name = \"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"sql_jr_execution\"'})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"version = \"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"0.1.0\"'})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"edition = \"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"2021\"'})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"[\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"dependencies\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"]\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"miette = {workspace = \"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"true\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"serde = {workspace = \"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"true\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"sql_jr_parser = { path = \"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"../sql_jr_parser\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" }\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"thiserror = {workspace = \"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"true\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})]}),\"\\n\",s(r.span,{className:\"line\"})]})}),s(r.p,{children:\"Since we will need to operate on tables, let's start by defining our table type. For now, we will only deal with in memory execution. Soon enough we can handle reading from disk.\"}),s(r.div,{className:\"remark-code-title\",children:\"table.rs\"}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"use\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" std\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"collections\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"{\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"BTreeMap\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"HashMap\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"};\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"use\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" serde\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"{\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Deserialize\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Serialize\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"};\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"use\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" sql_jr_parser\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Column\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"; \"}),s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"// See part 1 for this type def. Just column name and sql data type (string or int)\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"// NOTE: For now just a mapping of col name =\u003e data as a str. Will change later\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"/// A row stored in a table\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"type\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" StoredRow\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" =\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" HashMap\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"String\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"String\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e;\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"/// List of column info\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"type\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" ColumnInfo\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" =\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Vec\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Column\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e;\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"#[derive(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Debug\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Clone\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Default\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Serialize\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Deserialize\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")]\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"pub\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"crate\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\") \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"struct\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Table\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"    /// row id to row\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    rows\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" BTreeMap\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"usize\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"StoredRow\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e,\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"    /// Column info for all columns in the table\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    columns\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" ColumnInfo\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"})]})}),l(r.p,{children:[\"The \",s(r.code,{children:\"Table\"}),\" struct is basically just a wrapper around Rust's \",s(r.a,{href:\"https://doc.rust-lang.org/stable/std/collections/struct.BTreeMap.html#\",children:\"Btree\"}),\" with some extra column info.\"]}),l(r.h3,{id:\"what-is-a-b-tree\",children:[s(r.a,{href:\"#what-is-a-b-tree\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:s(r.span,{className:\"icon icon-link\"})}),\"What is a B-Tree?\"]}),l(r.p,{children:[\"A \",s(r.a,{href:\"https://en.wikipedia.org/wiki/B-tree\",children:\"B-Tree\"}),' is a generalized Binary Search Tree (BST). BSTs are great in theory but in practice, they kinda suck for cache locality, nodes only store 1 piece of data, have the potential to be unbalanced, and require a heap allocation for each insertion. In \"current year\" CPUs are insanely fast, so we need data structures that are better for reducing memory access.']}),l(r.p,{children:[s(r.em,{children:\"insert rant about why data oriented design is GOATED here\"}),\".\"]}),l(r.p,{children:[\"Alexis Beingessner in \",s(r.a,{href:\"https://cglab.ca/~abeinges/blah/rust-btree-case/#what's-a-b-tree?-why's-a-b-tree?\",children:\"Rust Collections Case Study: BTreeMap\"}),\" described B-Trees as\"]}),s(r.blockquote,{children:s(r.p,{children:'B-Trees take the idea of a BST, and say \"lets put some arrays in there; computers love arrays\". Rather than each node consisting of a single element with two children, B-Tree nodes have an array of elements with an array of children'})}),s(r.p,{children:\"I won't go into too much detail on B-Tree implementation, since I'm just using rust's built-in for now. If you're interested here are some good resources on B-Trees.\"}),l(r.ul,{children:[s(r.li,{children:s(r.a,{href:\"https://cglab.ca/~abeinges/blah/rust-btree-case\",children:\"Rust Collections Case Study: BTreeMap\"})}),s(r.li,{children:s(r.a,{href:\"https://en.wikipedia.org/wiki/B-tree\",children:\"Wikipedia\"})}),s(r.li,{children:s(r.a,{href:\"http://opendatastructures.org/ods-python/14_2_B_Trees.html\",children:\"Open Data Structures\"})})]}),s(r.p,{children:\"With that said, let's walk through a basic example\"}),s(r.p,{children:s(r.img,{alt:\"B-Tree example\",src:\"https://upload.wikimedia.org/wikipedia/commons/6/65/B-tree.svg\"})}),l(r.p,{children:[\"Here the internal node (the root) has 3 children. All keys \",l(r.span,{className:\"katex\",children:[s(r.span,{className:\"katex-mathml\",children:s(r.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:l(r.semantics,{children:[l(r.mrow,{children:[s(r.mo,{children:\"\u003c\"}),s(r.mn,{children:\"7\"})]}),s(r.annotation,{encoding:\"application/x-tex\",children:\"\u003c 7\"})]})})}),l(r.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[l(r.span,{className:\"base\",children:[s(r.span,{style:{height:\".5782em\",verticalAlign:\"-.0391em\"},className:\"strut\"}),s(r.span,{className:\"mrel\",children:\"\u003c\"}),s(r.span,{style:{marginRight:\".2778em\"},className:\"mspace\"})]}),l(r.span,{className:\"base\",children:[s(r.span,{style:{height:\".6444em\"},className:\"strut\"}),s(r.span,{className:\"mord\",children:\"7\"})]})]})]}),\" are in the left child, keys \",l(r.span,{className:\"katex\",children:[s(r.span,{className:\"katex-mathml\",children:s(r.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:l(r.semantics,{children:[l(r.mrow,{children:[s(r.mo,{children:\"\u003e\"}),s(r.mn,{children:\"7\"})]}),s(r.annotation,{encoding:\"application/x-tex\",children:\"\u003e 7\"})]})})}),l(r.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[l(r.span,{className:\"base\",children:[s(r.span,{style:{height:\".5782em\",verticalAlign:\"-.0391em\"},className:\"strut\"}),s(r.span,{className:\"mrel\",children:\"\u003e\"}),s(r.span,{style:{marginRight:\".2778em\"},className:\"mspace\"})]}),l(r.span,{className:\"base\",children:[s(r.span,{style:{height:\".6444em\"},className:\"strut\"}),s(r.span,{className:\"mord\",children:\"7\"})]})]})]}),\" and \",l(r.span,{className:\"katex\",children:[s(r.span,{className:\"katex-mathml\",children:s(r.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:l(r.semantics,{children:[l(r.mrow,{children:[s(r.mo,{children:\"\u003c\"}),s(r.mo,{children:\"=\"}),s(r.mn,{children:\"16\"})]}),s(r.annotation,{encoding:\"application/x-tex\",children:\"\u003c= 16\"})]})})}),l(r.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[l(r.span,{className:\"base\",children:[s(r.span,{style:{height:\".5782em\",verticalAlign:\"-.0391em\"},className:\"strut\"}),s(r.span,{className:\"mrel\",children:\"\u003c=\"}),s(r.span,{style:{marginRight:\".2778em\"},className:\"mspace\"})]}),l(r.span,{className:\"base\",children:[s(r.span,{style:{height:\".6444em\"},className:\"strut\"}),s(r.span,{className:\"mord\",children:\"16\"})]})]})]}),\" are in the middle, and finally, keys \",l(r.span,{className:\"katex\",children:[s(r.span,{className:\"katex-mathml\",children:s(r.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:l(r.semantics,{children:[l(r.mrow,{children:[s(r.mo,{children:\"\u003e\"}),s(r.mn,{children:\"16\"})]}),s(r.annotation,{encoding:\"application/x-tex\",children:\"\u003e 16\"})]})})}),l(r.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[l(r.span,{className:\"base\",children:[s(r.span,{style:{height:\".5782em\",verticalAlign:\"-.0391em\"},className:\"strut\"}),s(r.span,{className:\"mrel\",children:\"\u003e\"}),s(r.span,{style:{marginRight:\".2778em\"},className:\"mspace\"})]}),l(r.span,{className:\"base\",children:[s(r.span,{style:{height:\".6444em\"},className:\"strut\"}),s(r.span,{className:\"mord\",children:\"16\"})]})]})]}),\" are in the right child.\"]}),l(r.p,{children:[\"You can customize the \",l(r.span,{className:\"katex\",children:[s(r.span,{className:\"katex-mathml\",children:s(r.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:l(r.semantics,{children:[s(r.mrow,{children:s(r.mi,{children:\"B\"})}),s(r.annotation,{encoding:\"application/x-tex\",children:\"B\"})]})})}),s(r.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:l(r.span,{className:\"base\",children:[s(r.span,{style:{height:\".6833em\"},className:\"strut\"}),s(r.span,{style:{marginRight:\".05017em\"},className:\"mord mathnormal\",children:\"B\"})]})})]}),\" constant to have nodes store more/fewer keys and have more/fewer children. The average Lookup for a B-tree with \",l(r.span,{className:\"katex\",children:[s(r.span,{className:\"katex-mathml\",children:s(r.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:l(r.semantics,{children:[s(r.mrow,{children:s(r.mi,{children:\"N\"})}),s(r.annotation,{encoding:\"application/x-tex\",children:\"N\"})]})})}),s(r.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:l(r.span,{className:\"base\",children:[s(r.span,{style:{height:\".6833em\"},className:\"strut\"}),s(r.span,{style:{marginRight:\".10903em\"},className:\"mord mathnormal\",children:\"N\"})]})})]}),\" keys is \",l(r.span,{className:\"katex\",children:[s(r.span,{className:\"katex-mathml\",children:s(r.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:l(r.semantics,{children:[l(r.mrow,{children:[s(r.mi,{mathvariant:\"script\",children:\"O\"}),s(r.mo,{stretchy:\"false\",children:\"(\"}),s(r.mi,{children:\"log\"}),s(r.mo,{children:\"⁡\"}),l(r.msub,{children:[s(r.mrow,{}),s(r.mn,{children:\"2\"})]}),s(r.mi,{children:\"N\"}),s(r.mo,{stretchy:\"false\",children:\")\"})]}),s(r.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathcal{O}(\\\\log{_2}N)\"})]})})}),s(r.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:l(r.span,{className:\"base\",children:[s(r.span,{style:{height:\"1em\",verticalAlign:\"-.25em\"},className:\"strut\"}),s(r.span,{style:{marginRight:\".02778em\"},className:\"mord mathcal\",children:\"O\"}),s(r.span,{className:\"mopen\",children:\"(\"}),l(r.span,{className:\"mop\",children:[\"lo\",s(r.span,{style:{marginRight:\".01389em\"},children:\"g\"})]}),s(r.span,{style:{marginRight:\".1667em\"},className:\"mspace\"}),s(r.span,{className:\"mord\",children:l(r.span,{className:\"mord\",children:[s(r.span,{}),s(r.span,{className:\"msupsub\",children:l(r.span,{className:\"vlist-t vlist-t2\",children:[l(r.span,{className:\"vlist-r\",children:[s(r.span,{style:{height:\".3011em\"},className:\"vlist\",children:l(r.span,{style:{top:\"-2.55em\",marginRight:\".05em\"},children:[s(r.span,{style:{height:\"2.7em\"},className:\"pstrut\"}),s(r.span,{className:\"mtight reset-size6 size3 sizing\",children:s(r.span,{className:\"mord mtight\",children:\"2\"})})]})}),s(r.span,{className:\"vlist-s\",children:\"​\"})]}),s(r.span,{className:\"vlist-r\",children:s(r.span,{style:{height:\".15em\"},className:\"vlist\",children:s(r.span,{})})})]})})]})}),s(r.span,{style:{marginRight:\".10903em\"},className:\"mord mathnormal\",children:\"N\"}),s(r.span,{className:\"mclose\",children:\")\"})]})})]}),\" which is the same for a BST.\"]}),l(r.h3,{id:\"why-b-tree\",children:[s(r.a,{href:\"#why-b-tree\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:s(r.span,{className:\"icon icon-link\"})}),\"Why B-Tree?\"]}),s(r.p,{children:\"As I mentioned before B-Trees are great for cache locality. Also, you can make each node the size of a memory/disk block. This way you can minimize reads by chunking up the data more efficiently.\"}),l(r.h2,{id:\"actually-do-stuff\",children:[s(r.a,{href:\"#actually-do-stuff\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:s(r.span,{className:\"icon icon-link\"})}),\"Actually do stuff\"]}),s(r.p,{children:\"Nerd stuff aside, let's add actual logic for our table\"}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"impl\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Table\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"    // Create a table with the given column definitions\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" new\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(columns\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Vec\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Column\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\" Self\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"        Self\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            rows\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" BTreeMap\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"new\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(),\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            columns,\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"    /// Insert values (a row) into the table\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"    ///\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"    /// assumes the values are in the same order of the columns passed to create\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" insert\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026mut\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\" self\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", values\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Vec\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"String\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e) {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"        let\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" id \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\" self\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            .\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"rows\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"last_key_value\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"map_or\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"0\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(max_id, _)\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" max_id \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"+\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\" 1\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\");\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"        let\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" row\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" StoredRow\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" =\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" values\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"into_iter\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"zip\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"self\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"columns\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"iter\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"())\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"map\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(v, col)\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" (col\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"name\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"to_owned\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(), v))\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"collect\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"();\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"        self\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"rows\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"insert\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(id, row);\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"})]})}),s(r.p,{children:\"Here we create a table with the given column definitions (from the create table sql command). For insert, we get an ID for the new row which is just an ID sequence starting at 0 for the first row. We then insert the values into the B-TreeMap with that ID as the key and the row's values as a hash map of the column name to a string of the value to insert.\"}),l(r.p,{children:[\"Those two functions can handle creating tables (mostly) and inserting data, but how should we handle select? A simple first step is to re-use the \",s(r.a,{href:\"https://doc.rust-lang.org/std/iter/trait.Iterator.html\",children:\"Iterator\"}),\" on \",s(r.a,{href:\"https://doc.rust-lang.org/std/collections/struct.BTreeMap.html#method.iter\",children:\"BTreeMap\"}),\".\"]}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"impl\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Table\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" iter\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"self\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\") \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" std\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"collections\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"btree_map\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Iter\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"usize\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Row\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"        self\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"rows\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"iter\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"})]})}),l(r.p,{children:[\"This will give us an \",s(r.code,{children:\"Iterator\"}),\" over \",s(r.code,{children:\"(row_id, row_values)\"}),\".\"]}),l(r.p,{children:[\"Re-using the iterator from BTreeMap is fine, but I like how many Rust DB libraries have a \",s(r.code,{children:\"Row\"}),\" trait/struct that gives you extra information. For example, \",s(r.a,{href:\"https://github.com/launchbadge/sqlx\",children:\"SQLX\"}),\" has a \",s(r.a,{href:\"https://docs.rs/sqlx/latest/sqlx/trait.Row.html\",children:\"Row trait\"}),\" that lets you get column info back for the query you ran, safe/unsafe conversions into rust types, and a few other helpers. So let's make our \",s(r.code,{children:\"Row\"}),\" struct and iterator, so we can add these features later on.\"]}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"use\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" std\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"{\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"collections\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"HashMap\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"rc\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Rc\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"};\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"use\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" crate::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"table\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"ColumnInfo\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"; \"}),s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"// Vec\u003cColumn\u003e\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"/// A Row in a Query response\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"#[derive(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Debug\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Clone\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")]\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" struct\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Row\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    id\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" usize\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    columns\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Rc\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"ColumnInfo\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e,\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    data\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" \u0026\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" HashMap\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"String\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"String\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e,\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"})]})}),l(r.p,{children:[\"Here I made the decision that this \",s(r.code,{children:\"Row\"}),\" struct will not own the data it's showing. Therefore, it needs a reference to the data stored in the table. I also want to have the row have access to the \",s(r.code,{children:\"ColumnInfo\"}),\" from the table. Since every row will be holding a reference to the same \",s(r.code,{children:\"ColumnInfo\"}),\", I went with an \",s(r.a,{href:\"https://doc.rust-lang.org/std/rc/index.html\",children:\"RC\"}),\" to avoid extra lifetime parameters on the row struct.\"]}),l(r.p,{children:[\"Now we can implement \",s(r.code,{children:\"Iterator\"}),\" for the table. We can just wrap the existing \",s(r.code,{children:\"Iterator\"}),\" from \",s(r.code,{children:\"BTreeMap\"}),\" and transform each response into our \",s(r.code,{children:\"Row\"}),\" struct.\"]}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"/// Iterator of [`Row`]s from a table\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"pub\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"crate\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\") \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"struct\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" TableIter\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"    /// Underlying iterator over the btree_map\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    map_iter\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" std\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"collections\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"btree_map\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Iter\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"usize\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"StoredRow\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e,\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"    /// The columns of the [`Table`]\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    columns\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Rc\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"ColumnInfo\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e,\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"impl\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"TableIter\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" new\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        map_iter\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" std\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"collections\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"btree_map\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Iter\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"usize\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"StoredRow\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e,\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        columns\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Rc\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"ColumnInfo\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e,\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    ) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\" Self\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"        Self\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" { map_iter, columns }\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"impl\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Iterator\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" for\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" TableIter\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    type\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Item\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" =\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Row\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e;\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" next\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026mut\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\" self\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\") \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Option\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"Self\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Item\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"        self\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"map_iter\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"next\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"map\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(id, data)\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Row\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"new\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"self\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"columns\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"clone\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(), id\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"clone\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(), data))\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",s(r.span,{className:\"line\"})]})}),l(r.p,{children:[\"Now we can implement the \",s(r.a,{href:\"https://doc.rust-lang.org/std/iter/trait.IntoIterator.html\",children:\"IntoIterator trait\"}),\" on \",s(r.code,{children:\"Table\"}),\" for easy conversion into an iterator.\"]}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"impl\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"IntoIterator\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" for\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" \u0026\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Table\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    type\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Item\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" =\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Row\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e;\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    type\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" IntoIter\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" =\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" TableIter\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e;\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" into_iter\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"self\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\") \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\" Self\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"IntoIter\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"        let\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" col_info \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Rc\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"new\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"self\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"columns\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"clone\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"());\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"        TableIter\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"new\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"self\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"rows\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"iter\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(), col_info)\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"})]})}),l(r.p,{children:[\"now the \",s(r.code,{children:\"iter\"}),\" method (not necessarily needed) on table can just call the trait method\"]}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"impl\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Table\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"  pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" iter\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"self\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\") \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" impl\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Iterator\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Item\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" =\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Row\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"        self\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"into_iter\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"})]})}),l(r.h2,{id:\"handling-sql-queries\",children:[s(r.a,{href:\"#handling-sql-queries\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:s(r.span,{className:\"icon icon-link\"})}),\"Handling SQL Queries\"]}),l(r.p,{children:[\"Now that we have a \",s(r.code,{children:\"Table\"}),\" struct we need to hook up the parsed commands to create, insert, and read from tables.\"]}),s(r.p,{children:\"First we should define the response type for an execution\"}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"use\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" derive_more\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Display\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\";\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"#[derive(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Debug\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Display\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")]\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" enum\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" ExecResponse\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    #[display(fmt \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:' \"{_0:?}\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")] \"}),s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:'// only show the values not \"Select(...)\"'})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"    Select\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Vec\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Row\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e\u003e),\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"    Insert\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"    Create\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"})]})}),l(r.p,{children:[\"Here I use the \",s(r.a,{href:\"https://docs.rs/derive_more/latest/derive_more/\",children:\"derive_more\"}),\" crate's Display derive macro to avoid writing my own implementation of Display. If you're a real one who's been paying attention, you may have noticed that we did not implement \",s(r.code,{children:\"Display\"}),\" on \",s(r.code,{children:\"Row\"}),\" but the \",s(r.code,{children:\"Display\"}),\" derive still compiles, this is due to us adding \",s(r.code,{children:'#[display(fmt = \"{_0:?}\")]'}),\" to use the debug format of \",s(r.code,{children:\"Vec\u003cRow\u003e\"}),\" as the \",s(r.code,{children:\"Display\"}),\" format. While we won't use it much for select display (more on that later), for the other response cases It's nice to have.\"]}),s(r.p,{children:\"We also should make our own Error type for Query Execution\"}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"use\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" miette\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Diagnostic\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\";\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"use\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" thiserror\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Error\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\";\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"/// Errors during query execution\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"#[derive(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Error\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Debug\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Diagnostic\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")]\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"#[error(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"Query Execution Error\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")]\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" enum\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" QueryExecutionError\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    #[error(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"Table {0} was not found\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")]\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"    TableNotFound\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"String\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"),\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    #[error(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"Table {0} already exists\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")]\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"    TableAlreadyExists\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"String\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"),\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    #[error(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"Column {0} does not exist\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")]\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"    ColumnDoesNotExist\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"String\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"),\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"})]})}),l(r.p,{children:[\"Like in \",s(r.a,{href:\"/blog/build-a-db/part01\",children:\"part1\"}),\", we still are using \",s(r.a,{href:\"https://docs.rs/miette/latest/miette/\",children:\"miette\"}),\"/\",s(r.a,{href:\"https://docs.rs/thiserror/latest/thiserror/\",children:\"thiserror\"}),\" for better looking errors.\"]}),l(r.p,{children:[\"Now we can finally actually run some queries. For a quick refresher on the \",s(r.code,{children:\"SqlQuery\"}),\" type, see \",s(r.a,{href:\"https://github.com/JRMurr/SQLJr/blob/5324c38bc74cb77d2daf035a0f3d1da3fc7b4c3b/crates/sql_jr_parser/src/ast.rs#L19\",children:\"the source code\"})]}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"#[derive(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Debug\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Default\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")]\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" struct\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Execution\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    tables\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" HashMap\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"String\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Table\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e,\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"impl\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Execution\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" new\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"() \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\" Self\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"        Self\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            tables\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" HashMap\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"new\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(),\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" run\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026mut\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\" self\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", query\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" SqlQuery\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\") \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Result\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"ExecResponse\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"QueryExecutionError\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"        match\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" query {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"            SqlQuery\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Select\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"mut\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" select) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\u003e\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                let\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" table \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" select\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"table; \"}),s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"// the table name\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                let\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" table \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\" self\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                    .\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"tables\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                    .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"get\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"table)\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                    .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"ok_or\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"QueryExecutionError\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"TableNotFound\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(table))\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"?\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\";\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"                // not projecting to the selected columns yet\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                let\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" rows \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" table\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"iter\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"collect\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"();\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                Ok\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"ExecResponse\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Select\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(rows)))\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            }\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"            SqlQuery\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Insert\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(insert) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\u003e\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                let\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Some\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(table) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\" self\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"tables\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"get_mut\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"insert\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"table) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"else\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                    return\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Err\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"QueryExecutionError\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"TableNotFound\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(insert\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"table))\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                };\"})}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                table\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"insert\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(insert\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"values);\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                Ok\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"ExecResponse\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Insert\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            }\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"            SqlQuery\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Create\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(create) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\u003e\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                let\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" table \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Table\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"new\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(create\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"columns);\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"                self\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"tables\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"insert\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(create\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"table, table);\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                Ok\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"ExecResponse\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Create\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"})]})}),l(r.p,{children:[\"Since we handled most of the logic in the \",s(r.code,{children:\"Table\"}),\"/\",s(r.code,{children:\"Row\"}),\" structs, the actual execution is mostly just wrapper around the \",s(r.code,{children:\"HashMap\"}),\" of tables with some basic error handling.\"]}),l(r.h2,{id:\"bringing-it-all-together\",children:[s(r.a,{href:\"#bringing-it-all-together\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:s(r.span,{className:\"icon icon-link\"})}),\"Bringing it all together\"]}),l(r.p,{children:[\"With the \",s(r.code,{children:\"Execution\"}),\" struct we can handle the parsed commands from our parser but right now we don't have it all hooked up. We need to unify the parser and execution into one.\"]}),l(r.p,{children:['Ideally, we would have some new crate for the full \"pipeline\" from parsing to execution (and probably more steps we will add later), but for now having this logic in the ',s(r.code,{children:\"Execution\"}),\" crate feels fine.\"]}),s(r.p,{children:\"First, step is to combine the Error types from Parsing and Execution\"}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"use\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" miette\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Diagnostic\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\";\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"use\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" sql_jr_parser\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"error\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"FormattedError\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\";\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"use\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" thiserror\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Error\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\";\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:'/// Errors at any point in the SQL \"pipeline\"'})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"#[derive(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Error\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Debug\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Diagnostic\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")]\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"#[error(transparent)]\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" enum\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" SQLError\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    #[diagnostic(transparent)]\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"    QueryExecutionError\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(#[from] \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"QueryExecutionError\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"),\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    #[diagnostic(transparent)]\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"    ParsingError\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"FormattedError\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e),\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"// need a manual impl since the error #[from] seems sad on lifetimes\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"impl\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"From\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"FormattedError\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e\u003e \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"for\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" SQLError\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" from\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(value\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" FormattedError\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\" Self\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"        SQLError\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"ParsingError\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(value)\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"})]})}),l(r.p,{children:[\"Here \",s(r.code,{children:\"#[diagnostic(transparent)]\"}),\" is similar to \",s(r.code,{children:\"#[error(transparent)]\"}),\" in \",s(r.code,{children:\"thiserror\"}),\", it lets you wrap other errors but still call their \",s(r.code,{children:\"Display\"}),\" trait when the error is shown.\"]}),s(r.p,{children:\"Now we can have a function that parses and executes the query\"}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"impl\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Execution\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"   pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" parse_and_run\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e(\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026mut\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\" self\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", query\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" \u0026\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" str\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\") \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Result\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"ExecResponse\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"SQLError\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e\u003e {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"        let\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" query \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" parse_sql_query\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(query)\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"?\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\";\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"        let\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" res \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\" self\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"run\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(query)\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"?\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\";\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"        Ok\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(res)\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"})]})}),s(r.p,{children:\"Which lets our REPL now look like\"}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" main\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"() {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"  ...\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"  let\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" mut\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" exec \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" sql_jr_execution\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Execution\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"new\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"();\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"  loop\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"        let\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" readline \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" rl\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"readline\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"\u003e\u003e \"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\");\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"        match\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" readline {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"          Ok\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(line) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\u003e\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                rl\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"add_history_entry\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(line\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"as_str\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"());\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                let\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" line\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" \u0026\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"str\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" =\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" line\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"as_ref\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"();\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                let\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" res \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" exec\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"parse_and_run\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(line);\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                match\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" res {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                    Ok\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(exec_res) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\u003e\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" println!\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"{exec_res}\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"),\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                    Err\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(e) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\u003e\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                        let\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" mut\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" s \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" String\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"new\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"();\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                        GraphicalReportHandler\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"new\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                            .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"with_cause_chain\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                            .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"with_context_lines\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"10\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                            .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"render_report\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026mut\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" s, \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"e)\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                            .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"unwrap\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"();\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                        println!\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"{s}\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\");\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                    }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"          // other cases unchanged from part 1\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"})]})}),s(r.p,{children:\"The happy path in our REPL now looks like\"}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[s(r.span,{className:\"line\",children:s(r.span,{children:\"\u003e\u003e create table foo (col1 string, col2 string);\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\"Create\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\"\u003e\u003e insert into foo values a,b;\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\"Insert\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\"\u003e\u003e select col1,col2 from foo;\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:'[Row { id: 0, columns: [Column { name: \"col1\", type_info: String }, Column { name: \"col2\", type_info: String }], data: {\"col1\": \"a\", \"col2\": \"b\"} }]'})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\"\u003e\u003e\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{})})]})}),l(r.h2,{id:\"better-display-for-repl\",children:[s(r.a,{href:\"#better-display-for-repl\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:s(r.span,{className:\"icon icon-link\"})}),\"Better display for REPL\"]}),l(r.p,{children:[\"The REPL works, but the display for select queries is pretty gross. We can use the \",s(r.a,{href:\"https://github.com/zhiburt/tabled\",children:\"tabled crate\"}),\" to format the response as a table. We can run \",s(r.code,{children:\"cargo add tabled\"}),\" in \",s(r.code,{children:\"crates/sql_jr_repl\"}),\" to add the crate to the repl.\"]}),l(r.p,{children:[\"If you look at the docs for \",s(r.code,{children:\"tabled\"}),\" many of the first examples involve the \",s(r.code,{children:\"#[derive(Tabled)]\"}),\" macro on your structs/enums. This does not really work for select queries since the columns are dynamic. Tabled still supports this with the \",s(r.a,{href:\"https://docs.rs/tabled/0.10.0/tabled/builder/struct.Builder.html\",children:\"builder\"}),\" to allow us to set the rows + columns dynamically.\"]}),s(r.p,{children:\"Let's add a new file to the REPL crate and handle display there\"}),s(r.div,{className:\"remark-code-title\",children:\"crates/sql_jr_repl/display.rs\"}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" display_response\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(res\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" ExecResponse\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\") {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    match\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" res {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"        ExecResponse\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Select\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(rows) \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\u003e\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            let\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" mut\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" builder \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Builder\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"default\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"();\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"            // Get column info from the first row\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            let\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" row \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" rows\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"get\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"0\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"expect\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"For now assuming we get data back\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\");\"})]}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            let\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" columns\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Vec\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"String\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" row\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"columns\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"() \"}),s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"// added helper, see below\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"iter\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"map\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"col\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" col\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"name\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"to_string\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"())\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                .\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"collect\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"();\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            builder\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"set_columns\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"columns);\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            for\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" row \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"in\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" rows\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"into_iter\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"() {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                builder\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"add_record\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(columns\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"iter\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"map\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"col\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" row\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"get\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(col))); \"}),s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"// added a get helper, see below\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            }\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"            println!\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"{}\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", builder\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"build\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"())\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        }\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        _ \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\u003e\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" println!\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"{res}\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"),\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"})]})}),s(r.p,{children:\"as noted in a comment I added these helpers to the row struct to make column lookup easier\"}),s(r.div,{className:\"remark-code-title\",children:\"crates/sql_jr_execution/row.rs\"}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"impl\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Row\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"     pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" columns\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"self\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\") \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" \u0026\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"ColumnInfo\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"        self\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"columns\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"as_ref\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"    /// Get a single value from the row\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"    ///\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"    /// # Panics\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"    ///\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"    /// Panics if the column does not exist\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"    /// See [`try_get`](Self::try_get) for a non-panicking\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"    /// version.\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" get\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"self\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", column\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" \u0026\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"String\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\") \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" String\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"        self\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"try_get\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(column)\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"unwrap\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",s(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"    /// Get a single value from the row\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    pub\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" fn\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" try_get\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"self\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", column\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" \u0026\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"String\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\") \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Result\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"String\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"QueryExecutionError\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"        self\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"data\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"get\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(column)\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"map_or_else\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            ||\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Err\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"QueryExecutionError\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"ColumnDoesNotExist\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(column\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"to_owned\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"())),\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            |\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"val\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Ok\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(val\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"to_string\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()),\"})]}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        )\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",s(r.span,{className:\"line\"})]})}),s(r.p,{children:\"now the REPL from the example above would show\"}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[s(r.span,{className:\"line\",children:s(r.span,{children:\"\u003e\u003e select col1,col2 from foo;\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\"+------+------+\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\"| col1 | col2 |\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\"+------+------+\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\"| a    | b    |\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{children:\"+------+------+\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{})})]})}),l(r.p,{children:[s(r.code,{children:\"tabled\"}),\" has many \",s(r.a,{href:\"https://github.com/zhiburt/tabled#style\",children:\"style options\"}),\" if we wanted to tweak the look, but this is fine for now.\"]}),s(r.p,{children:\"You probably noticed the line\"}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[s(r.span,{className:\"line\",children:s(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"//Get column info from the first row\"})}),\"\\n\",l(r.span,{className:\"line\",children:[s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"let\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" row \"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" rows\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"get\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"0\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")\"}),s(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),s(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"expect\"}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),s(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"For now assuming we get data back\"'}),s(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\");\"})]}),\"\\n\",s(r.span,{className:\"line\"})]})}),l(r.p,{children:[\"in our display function. This obviously would get sad on empty responses. The best decision would be to add/move \",s(r.code,{children:\"ColumnInfo\"}),\" into \",s(r.code,{children:\"ExecResponse::Select\"}),\", so we return something like\"]}),s(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:l(r.code,{children:[s(r.span,{className:\"line\",children:s(r.span,{children:\"{columns: Rc\u003cColumnInfo\u003e, row: Vec\u003cRow\u003e}\"})}),\"\\n\",s(r.span,{className:\"line\",children:s(r.span,{})})]})}),s(r.p,{children:\"but I'll save that for the next post.\"}),l(r.h2,{id:\"wrap-up\",children:[s(r.a,{href:\"#wrap-up\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:s(r.span,{className:\"icon icon-link\"})}),\"Wrap up\"]}),l(r.p,{children:[\"Having basic execution feels nice, but the real challenge will be filtering and projecting the data. We have some extra clones and \",s(r.code,{children:\"unwraps\"}),\"/\",s(r.code,{children:\"expects\"}),\" we need to handle once we start moving away from this extremely simple happy path but so far the high level design feels good!\"]})]})}return{default:function(e={}){const{wrapper:l}=e.components||{};return l?s(l,{...e,children:s(_createMdxContent,{...e})}):_createMdxContent(e)}};"])</script><script>self.__next_f.push([1,"1a:T13213,"])</script><script>self.__next_f.push([1,"const{Fragment:e,jsx:l,jsxs:s}=arguments[0];function _createMdxContent(i){const r={a:\"a\",code:\"code\",div:\"div\",h1:\"h1\",h2:\"h2\",li:\"li\",p:\"p\",pre:\"pre\",span:\"span\",ul:\"ul\",...i.components},{Note:a,TOCInline:n}=r;return a||_missingMdxReference(\"Note\",!0),n||_missingMdxReference(\"TOCInline\",!0),s(e,{children:[l(n,{toc:i.toc,asDisclosure:!0}),s(r.h1,{id:\"where-we-left-off\",children:[l(r.a,{href:\"#where-we-left-off\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:l(r.span,{className:\"icon icon-link\"})}),\"Where we left off\"]}),l(r.p,{children:\"In the last post we ended up with extremely basic query execution. We could parse queries, update our tables in memory, and read full tables back; all while having decent error messages throughout.\"}),l(r.p,{children:\"While that was a great milestone it leaves a lot to be desired\"}),s(r.ul,{children:[l(r.li,{children:\"While we parse columns in select queries, we never actually project/use them, so you always get all the columns back\"}),l(r.li,{children:\"We aren't validating types on insert, so the column types mean nothing\"})]}),l(r.p,{children:\"So those main points are what I want to tackle for this post\"}),l(a,{children:s(r.p,{children:[\"This post is much less of a tutorial/guide than the previous posts. I needed to cleanup what I have so the changes are pretty straightforward, small, and all over. Check the \",l(r.a,{href:\"https://github.com/JRMurr/SQLJr\",children:\"repo\"}),\" for more detailed changes.\"]})}),s(r.h1,{id:\"actually-selecting-columns\",children:[l(r.a,{href:\"#actually-selecting-columns\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:l(r.span,{className:\"icon icon-link\"})}),\"Actually selecting columns\"]}),l(r.p,{children:\"For a refresher, here's what the select response looks like\"}),l(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:s(r.code,{children:[s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"pub\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" enum\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" ExecResponse\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"    Select\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Vec\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Row\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e\u003e),\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"    Insert\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"    Create\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"pub\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" struct\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Row\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    id\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" usize\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    columns\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Rc\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"ColumnInfo\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e,\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    data\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" \u0026\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"'\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" HashMap\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"String\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"String\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e, \"}),l(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"// reference to the actual row in the table struct\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",l(r.span,{className:\"line\"})]})}),s(r.p,{children:[\"So the select response is just a \",l(r.code,{children:\"Vec\"}),\" over rows, each row holding info on the columns of the table and the data for that row.\"]}),l(r.p,{children:\"There's a few things not great about this\"}),s(r.ul,{children:[s(r.li,{children:[\"Why return a \",l(r.code,{children:\"Vec\"}),\" when we could just return an iterator, the consumer is going to iterate over it anyway\"]}),l(r.li,{children:\"The select response does not return any column info outside of the rows, so empty results would not give any column info\"}),s(r.li,{children:[\"The data in the row is just a reference to the table, not horrible for \",l(r.code,{children:\"select *\"}),\" but need to modify it to only hold the columns we care about\",l(r.ul,{children:l(r.li,{children:\"We probably will update this type over time to reduce space but for now we'll stick with a hash map\"})})]})]}),s(r.p,{children:[\"To address the first 2 issues, we can just return our existing \",l(r.code,{children:\"TableIter\"}),\" struct, this is an iterator, and it holds column info\"]}),l(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:s(r.code,{children:[s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"pub\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" enum\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" ExecResponse\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"    Select\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"TableIter\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e),\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"    Insert\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"    Create\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",l(r.span,{className:\"line\"})]})}),s(r.h2,{id:\"for-real-lets-do-a-select\",children:[l(r.a,{href:\"#for-real-lets-do-a-select\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:l(r.span,{className:\"icon icon-link\"})}),\"For real let's do a select\"]}),s(r.p,{children:[\"We didn't actually have a select function on \",l(r.code,{children:\"Table\"}),\" before, so let's add one that's validates the columns we pass in actually exist\"]}),l(r.div,{className:\"remark-code-title\",children:\"table.rs\"}),l(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:s(r.code,{children:[s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"#[derive(\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Debug\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Clone\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Default\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Serialize\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Deserialize\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", derive_more\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"From\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")]\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"pub\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" struct\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" ColumnInfo\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    columns\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Vec\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Column\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e,\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"impl\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" ColumnInfo\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    pub\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" fn\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" iter\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026\"}),l(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"self\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\") \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" impl\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Iterator\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Item\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" =\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" \u0026\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Column\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"        self\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"columns\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"iter\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    pub\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" fn\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" find_column\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026\"}),l(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"self\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", column_name\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" \u0026\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"String\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\") \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Result\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Column\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"QueryExecutionError\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"        self\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"iter\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            .\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"find\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"col\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" col\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"name \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"==\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" *\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"column_name)\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            .\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"ok_or_else\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"||\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" QueryExecutionError\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"ColumnDoesNotExist\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(column_name\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"to_owned\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()))\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"// Also updated Table.columns to be `ColumnInfo` instead of Vec\u003cColumn\u003e\"})}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"impl\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Table\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    pub\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" fn\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" select\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026\"}),l(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"self\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", columns\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Vec\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"String\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e) \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Result\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"TableIter\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"QueryExecutionError\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"        let\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" selected_columns \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" columns\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            .\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"into_iter\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            .\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"map\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"column_name\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"                self\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"columns\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                    .\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"find_column\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"column_name)\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                    .\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"map\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"col\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" col\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"clone\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"())\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            })\"})}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            .\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"collect\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Result\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Vec\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c_\u003e, _\u003e\u003e()\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"?\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\";\"})]}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"        let\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" col_info\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Rc\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"ColumnInfo\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Rc\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"new\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(selected_columns\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"into\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"());\"})]}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"        Ok\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"TableIter\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"new\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"self\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"rows\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"iter\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(), col_info))\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",l(r.span,{className:\"line\"})]})}),l(r.p,{children:\"Since the select function validates all the columns exist, the iterator can avoid the same error checking like so\"}),l(r.div,{className:\"remark-code-title\",children:\"table.rs\"}),l(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:s(r.code,{children:[s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"impl\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e \"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Iterator\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" for\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" TableIter\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    type\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Item\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" =\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Row\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e;\"})]}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    fn\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" next\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026mut\"}),l(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\" self\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\") \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Option\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),l(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"Self\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Item\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"        self\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"map_iter\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"next\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"map\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(id, data)\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            let\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" projected_data \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" data\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                .\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"data \"}),l(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"// the stored row hashmap\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                .\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"iter\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                .\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"filter_map\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(key, value)\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),l(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\" self\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"columns\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"find_column\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(key)\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"ok\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"map\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"_\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" (key, value)))\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"                .\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"collect\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"();\"})]}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"            Row\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"new\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"self\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"columns\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"clone\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(), \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"*\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"id, projected_data)\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        })\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",l(r.span,{className:\"line\"})]})}),l(r.p,{children:\"All the iterator does is go over the stored table's b-tree, for each row it filters the hash map of row data to only the columns we selected.\"}),s(r.h1,{id:\"doing-type-checking\",children:[l(r.a,{href:\"#doing-type-checking\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:l(r.span,{className:\"icon icon-link\"})}),\"Doing type checking\"]}),l(r.p,{children:\"Right now we track column types when you create tables\"}),l(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:s(r.code,{children:[s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"CREATE\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" TABLE\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" foo\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" (\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    col1 \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"int\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    col2 string\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\");\"})}),\"\\n\",l(r.span,{className:\"line\"})]})}),l(r.p,{children:\"but we can just throw anything in there\"}),l(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:s(r.code,{children:[s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"INSERT INTO\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" foo\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    VALUES\"})}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        thisIsNotAnInt, \"}),l(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"3\"})]}),\"\\n\",l(r.span,{className:\"line\"})]})}),l(r.p,{children:\"to have proper type checking we first need to update the insert statement to be type aware (instead of having every value be strings).\"}),l(r.p,{children:\"So let's make a SQL value type\"}),l(r.div,{className:\"remark-code-title\",children:\"parser/value.rs\"}),l(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:s(r.code,{children:[s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"#[derive(\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Debug\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Clone\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"PartialEq\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Eq\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Hash\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Serialize\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Deserialize\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Display\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")]\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"pub\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" enum\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Value\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"    Number\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"BigDecimal\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"),\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"    String\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"String\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"),\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",l(r.span,{className:\"line\"})]})}),s(r.p,{children:[\"Here we just make an enum of what types/values we support in our SQL language. Here I decided to have one number representation with \",l(r.code,{children:\"BigDecimal\"}),\" instead of having \",l(r.code,{children:\"Int\"}),\"/\",l(r.code,{children:\"Float\"}),\" types. Eventually I will, I'm just getting the basics in.\"]}),l(r.p,{children:\"Now we need to parse these values\"}),l(r.div,{className:\"remark-code-title\",children:\"parser/value.rs\"}),l(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:s(r.code,{children:[l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"/// Parse a single quoted string value\"})}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"fn\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" parse_string_value\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(input\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" RawSpan\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"_\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e) \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" ParseResult\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"_\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Value\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"    // TODO: look into https://github.com/rust-bakery/nom/blob/main/examples/string.rs\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"    // for escaped strings\"})}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    let\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" (remaining, (_, str_value, _)) \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" context\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'        \"String Literal\"'}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"        tuple\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"((\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"            tag\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"\\'\"'}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"),\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"            take_until\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"\\'\"'}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\")\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"map\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"s\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" RawSpan\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Value\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"String\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(s\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"fragment\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"to_string\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"())),\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"            tag\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"\\'\"'}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"), \"}),l(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"// take_until does not consume the ending quote\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        )),\"})}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    )(input)\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"?\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\";\"})]}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"    Ok\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"((remaining, str_value))\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"/// Parse a numeric literal\"})}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"fn\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" parse_number_value\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(input\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" RawSpan\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"_\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e) \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" ParseResult\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"_\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Value\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    let\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" (remaining, digits) \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"        context\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"Number Literal\"'}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"take_while\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"c\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" char\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" c\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"is_numeric\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()))(input)\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"?\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"; \"}),l(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"// TODO: handle floats\"})]}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    let\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" digits \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" digits\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"fragment\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"();\"})]}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"    Ok\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"((\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        remaining,\"})}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"        Value\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Number\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"BigDecimal\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"from_str\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(digits)\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"unwrap\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()),\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    ))\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"impl\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e \"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Parse\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"for\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Value\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    fn\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" parse\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(input\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" RawSpan\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e) \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" ParseResult\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c'\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"a\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),l(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"Self\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"        context\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'            \"Value\"'}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"            preceded\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                multispace0,\"})}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                terminated\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"                    // peek_then_cut will give better errors so if we see\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"                    // a quote we knows to only try to parse a string\"})}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"                    alt\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"((\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"peek_then_cut\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:'\"\\'\"'}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", parse_string_value), parse_number_value)),\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                    multispace0,\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                ),\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            ),\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"        )(input)\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",l(r.span,{className:\"line\"})]})}),s(r.p,{children:[\"The parsing logic is mostly straightforward, the main weirdness you might be confused by is why the calls to \",l(r.code,{children:\".fragment()\"}),\"? That is because the input to the parse functions is a \",l(r.code,{children:\"RawSpan\"}),\", you need to call \",l(r.code,{children:\"fragment()\"}),\" to get the actual string from the span.\"]}),s(r.p,{children:[\"Now when we wants strings we will need to quote them like \",l(r.code,{children:'\"aString\"'})]}),s(r.p,{children:[\"Now that we have this value type, we need to replace all our string values with this new type. This change was sorta all over, if you want a good diff this \",l(r.a,{href:\"https://github.com/JRMurr/SQLJr/commit/55d66244a573a371983d75534b99577035ead478#diff-01c60d528deeaabdcb2502648bce756b7aa879d131d966016939ca85de7a039c\",children:\"commit\"}),\" has the needed changes for that. This is still probably a little wasteful representation, but it starts us on the path to better types and performance.\"]}),l(r.p,{children:\"We can now check the value on insert and see if it lines up with the given column's data type\"}),l(r.div,{className:\"remark-code-title\",children:\"table.rs\"}),l(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:s(r.code,{children:[s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"impl\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Table\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    pub\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" fn\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" insert\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"\u0026mut\"}),l(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\" self\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", values\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\":\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Vec\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Value\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e) \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"-\u003e\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Result\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c(), \"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"QueryExecutionError\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003e {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"        let\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" id \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),l(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\" self\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            .\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"rows\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            .\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"last_key_value\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            .\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"map_or\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"0\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(max_id, _)\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" max_id \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"+\"}),l(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\" 1\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\");\"})]}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"        let\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" row \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" values\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            .\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"into_iter\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"()\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            .\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"zip\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"self\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"columns\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"iter\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"())\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            .\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"map\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(value, col)\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"|\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" match\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" (col\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"type_info, value) {\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                (\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"SqlTypeInfo\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"String\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", v \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"@\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Value\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"String\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(_)) \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\u003e\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Ok\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"((col\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"name\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"to_owned\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(), v)),\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                (\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"SqlTypeInfo\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Int\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", v \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"@\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Value\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Number\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(_)) \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\u003e\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Ok\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"((col\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"name\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"to_owned\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(), v)), \"}),l(r.span,{style:{color:\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},children:\"// TODO: when we add floats make sure number is an int\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"                (_,v) \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"=\u003e\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" Err\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"QueryExecutionError\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"InsertTypeMismatch\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(col\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"type_info, v)),\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"            })\"})}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"            .\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"collect\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"::\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"Result\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"HashMap\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"\u003c_, _\u003e,_\u003e\u003e()\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"?\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\";\"})]}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"        self\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"rows\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"insert\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(id, row\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\".\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"into\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"());\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\"        Ok\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"(())\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    }\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"}\"})}),\"\\n\",l(r.span,{className:\"line\"})]})}),s(r.p,{children:[\"Here it's pretty basic, we match on the tuple of column type and value, if the value and type match up we allow the insert, otherwise error with a type mismatch. Later on we could add some logic for implicit conversions for things like converting \",l(r.code,{children:\"int\"}),\"s to \",l(r.code,{children:\"float\"}),\"s but for now we are going to be strict.\"]}),l(r.p,{children:\"So now we can run\"}),l(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:s(r.code,{children:[s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"CREATE\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" TABLE\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" sad\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" (\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    col1 \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"int\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    col2 string\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\");\"})}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"INSERT INTO\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" sad\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    VALUES\"})}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"        1\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),l(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"2\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\";\"})]}),\"\\n\",l(r.span,{className:\"line\"})]})}),l(r.p,{children:\"and get back\"}),l(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:s(r.code,{children:[l(r.span,{className:\"line\",children:l(r.span,{children:\" × Value 2 can not be inserted into a String column\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{})})]})}),l(r.p,{children:\"For the happy path\"}),l(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:s(r.code,{children:[s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"CREATE\"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\" TABLE\"}),l(r.span,{style:{color:\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},children:\" foo\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" (\"})]}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    col1 \"}),l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"int\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\",\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    col2 string\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\");\"})}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"INSERT INTO\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" foo\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    VALUES\"})}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"        1\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),l(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:\"'aString'\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\";\"})]}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"INSERT INTO\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\" foo\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"    VALUES\"})}),\"\\n\",s(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},children:\"        4\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\", \"}),l(r.span,{style:{color:\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},children:\"'aDiffString with spaces'\"}),l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\";\"})]}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"SELECT\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    col1,\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    col2\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#d73a49\",\"--shiki-dark\":\"#F97583\"},children:\"FROM\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},children:\"    foo;\"})}),\"\\n\",l(r.span,{className:\"line\"})]})}),l(r.p,{children:\"will return\"}),l(r.pre,{className:\"shiki shiki-themes github-light github-dark\",style:{backgroundColor:\"#fff\",\"--shiki-dark-bg\":\"#24292e\",color:\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},tabIndex:\"0\",children:s(r.code,{children:[l(r.span,{className:\"line\",children:l(r.span,{children:\"+------+-------------------------+\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{children:\"| col1 | col2                    |\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{children:\"+------+-------------------------+\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{children:\"| 1    | aString                 |\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{children:\"+------+-------------------------+\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{children:\"| 4    | aDiffString with spaces |\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{children:\"+------+-------------------------+\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{})})]})}),s(r.h2,{id:\"wrap-up\",children:[l(r.a,{href:\"#wrap-up\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:l(r.span,{className:\"icon icon-link\"})}),\"Wrap up\"]}),l(r.p,{children:'This is definitely getting to the point in every personal project where the initial burst of interest starts to wane. While I would love to focus on more \"sexy\" features like where clauses, joins, and saving the DB to disk; I really needed to clean up what I had.'}),l(r.p,{children:\"I do plan on focusing on some other side projects for now (and may write some posts on them), but I do plan on focusing more on the DB soon.\"}),l(r.p,{children:\"If you really want some more I would highly recommend trying this yourself! As you can probably tell from reading this posts, I'm far from a DB expert. Just start somewhere, you would be impressed with how much you can accomplish already and how much you will learn as you go!\"})]})}return{default:function(e={}){const{wrapper:s}=e.components||{};return s?l(s,{...e,children:l(_createMdxContent,{...e})}):_createMdxContent(e)}};function _missingMdxReference(e,l){throw new Error(\"Expected \"+(l?\"component\":\"object\")+\" `\"+e+\"` to be defined: you likely forgot to import, pass, or provide it.\")}"])</script><script>self.__next_f.push([1,"7:[[\"$\",\"script\",null,{\"type\":\"application/ld+json\",\"dangerouslySetInnerHTML\":{\"__html\":\"{\\\"@context\\\":\\\"https://schema.org\\\",\\\"@type\\\":\\\"BlogPosting\\\",\\\"headline\\\":\\\"Building a Simple DB in Rust - Part 2 - Basic Execution\\\",\\\"datePublished\\\":\\\"2023-01-23T14:01:22.231Z\\\",\\\"dateModified\\\":\\\"2023-01-23T14:01:22.231Z\\\",\\\"description\\\":\\\"Building a basic database in rust\\\",\\\"author\\\":[{\\\"@type\\\":\\\"Person\\\",\\\"name\\\":\\\"John Murray\\\"}]}\"}}],[\"$\",\"section\",null,{\"className\":\"mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0\",\"children\":[[\"$\",\"$L16\",null,{}],[\"$\",\"article\",null,{\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"header\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"space-y-1 border-b border-gray-200 pb-10 text-center dark:border-gray-700\",\"children\":[[\"$\",\"dl\",null,{\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"dt\",null,{\"className\":\"sr-only\",\"children\":\"Published on\"}],[\"$\",\"dd\",null,{\"className\":\"text-base font-medium leading-6 text-gray-500 dark:text-gray-400\",\"children\":[[\"$\",\"time\",null,{\"dateTime\":\"2023-01-23T14:01:22.231Z\",\"children\":\"January 23, 2023\"}],[\"$\",\"span\",null,{\"className\":\"mx-2\",\"children\":\"-\"}],[\"$\",\"span\",null,{\"className\":\"ml-1\",\"children\":[9,\" min read\"]}]]}]]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h1\",null,{\"className\":\"text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14\",\"children\":\"Building a Simple DB in Rust - Part 2 - Basic Execution\"}]}]]}]}],[\"$\",\"div\",null,{\"className\":\"grid-rows-[auto_1fr] divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:divide-y-0\",\"children\":[[\"$\",\"div\",null,{\"className\":\"divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0\",\"children\":[[\"$\",\"div\",null,{\"className\":\"prose max-w-none pb-8 pt-10 dark:prose-invert\",\"children\":[[\"$\",\"$L17\",null,{\"series\":{\"title\":\"Building a Simple DB in Rust\",\"posts\":[{\"title\":\"Building a Simple DB in Rust - Part 1 - Parsing\",\"seriesTitle\":\"Part 1 - Parsing\",\"date\":\"2023-01-02T05:19:22.985Z\",\"summary\":\"building a basic database in rust\",\"tags\":[\"rust\",\"database\",\"parsing\"],\"authors\":[\"default\"],\"layout\":\"PostSimple\",\"metadata\":{\"readingTime\":12,\"wordCount\":3076},\"body\":\"$18\",\"draft\":false,\"path\":\"blog/build-a-db/part01\",\"slug\":\"build-a-db/part01\",\"toc\":[{\"title\":\"What am I Making\",\"url\":\"#what-am-i-making\",\"depth\":0,\"items\":[]},{\"title\":\"Project setup\",\"url\":\"#project-setup\",\"depth\":0,\"items\":[{\"title\":\"Cargo Workspaces\",\"url\":\"#cargo-workspaces\",\"depth\":1,\"items\":[]}]},{\"title\":\"The REPL\",\"url\":\"#the-repl\",\"depth\":0,\"items\":[]},{\"title\":\"Parsing\",\"url\":\"#parsing\",\"depth\":0,\"items\":[{\"title\":\"nom for dummies\",\"url\":\"#nom-for-dummies\",\"depth\":1,\"items\":[]},{\"title\":\"My Own SQL\",\"url\":\"#my-own-sql\",\"depth\":1,\"items\":[]},{\"title\":\"Actual parsing\",\"url\":\"#actual-parsing\",\"depth\":1,\"items\":[]},{\"title\":\"Helper trait\",\"url\":\"#helper-trait\",\"depth\":1,\"items\":[]},{\"title\":\"Parsing Create Table\",\"url\":\"#parsing-create-table\",\"depth\":1,\"items\":[]},{\"title\":\"Pulling it all together\",\"url\":\"#pulling-it-all-together\",\"depth\":1,\"items\":[]},{\"title\":\"Parser Errors\",\"url\":\"#parser-errors\",\"depth\":1,\"items\":[]}]},{\"title\":\"Part 1 wrap up\",\"url\":\"#part-1-wrap-up\",\"depth\":0,\"items\":[]}],\"structuredData\":{\"@context\":\"https://schema.org\",\"@type\":\"BlogPosting\",\"headline\":\"Building a Simple DB in Rust - Part 1 - Parsing\",\"datePublished\":\"2023-01-02T05:19:22.985Z\",\"dateModified\":\"2023-01-02T05:19:22.985Z\",\"description\":\"building a basic database in rust\"}},{\"title\":\"Building a Simple DB in Rust - Part 2 - Basic Execution\",\"seriesTitle\":\"Part 2 - Basic Execution\",\"date\":\"2023-01-23T14:01:22.231Z\",\"summary\":\"Building a basic database in rust\",\"tags\":[\"rust\",\"database\"],\"authors\":[\"default\"],\"layout\":\"PostSimple\",\"metadata\":{\"readingTime\":9,\"wordCount\":2415},\"body\":\"$19\",\"draft\":false,\"path\":\"blog/build-a-db/part02\",\"slug\":\"build-a-db/part02\",\"toc\":[{\"title\":\"Feedback from part 1\",\"url\":\"#feedback-from-part-1\",\"depth\":0,\"items\":[]},{\"title\":\"Execution\",\"url\":\"#execution\",\"depth\":0,\"items\":[{\"title\":\"Actually do stuff\",\"url\":\"#actually-do-stuff\",\"depth\":1,\"items\":[]},{\"title\":\"Handling SQL Queries\",\"url\":\"#handling-sql-queries\",\"depth\":1,\"items\":[]},{\"title\":\"Bringing it all together\",\"url\":\"#bringing-it-all-together\",\"depth\":1,\"items\":[]},{\"title\":\"Better display for REPL\",\"url\":\"#better-display-for-repl\",\"depth\":1,\"items\":[]},{\"title\":\"Wrap up\",\"url\":\"#wrap-up\",\"depth\":1,\"items\":[]}]}],\"structuredData\":{\"@context\":\"https://schema.org\",\"@type\":\"BlogPosting\",\"headline\":\"Building a Simple DB in Rust - Part 2 - Basic Execution\",\"datePublished\":\"2023-01-23T14:01:22.231Z\",\"dateModified\":\"2023-01-23T14:01:22.231Z\",\"description\":\"Building a basic database in rust\",\"author\":[{\"@type\":\"Person\",\"name\":\"John Murray\"}]}},{\"title\":\"Building a Simple DB in Rust - Part 3 - Less Basic Execution\",\"seriesTitle\":\"Part 3 - Less Basic Execution\",\"date\":\"2023-04-04T00:01:55.249Z\",\"summary\":\"Cleaning up existing execution logic\",\"tags\":[\"rust\",\"database\",\"repl\"],\"authors\":[\"default\"],\"layout\":\"PostSimple\",\"metadata\":{\"readingTime\":5,\"wordCount\":1363},\"body\":\"$1a\",\"draft\":false,\"path\":\"blog/build-a-db/part03\",\"slug\":\"build-a-db/part03\",\"toc\":[{\"title\":\"Where we left off\",\"url\":\"#where-we-left-off\",\"depth\":0,\"items\":[]},{\"title\":\"Actually selecting columns\",\"url\":\"#actually-selecting-columns\",\"depth\":0,\"items\":[{\"title\":\"For real let's do a select\",\"url\":\"#for-real-lets-do-a-select\",\"depth\":1,\"items\":[]}]},{\"title\":\"Doing type checking\",\"url\":\"#doing-type-checking\",\"depth\":0,\"items\":[{\"title\":\"Wrap up\",\"url\":\"#wrap-up\",\"depth\":1,\"items\":[]}]}],\"structuredData\":{\"@context\":\"https://schema.org\",\"@type\":\"BlogPosting\",\"headline\":\"Building a Simple DB in Rust - Part 3 - Less Basic Execution\",\"datePublished\":\"2023-04-04T00:01:55.249Z\",\"dateModified\":\"2023-04-04T00:01:55.249Z\",\"description\":\"Cleaning up existing execution logic\"}}]},\"currSlug\":\"build-a-db/part02\"}],[[\"$\",\"details\",null,{\"open\":true,\"children\":[[\"$\",\"summary\",null,{\"className\":\"ml-6 pb-2 pt-2 text-xl font-bold\",\"children\":\"Table of Contents\"}],[\"$\",\"div\",null,{\"className\":\"ml-6\",\"children\":[\"$\",\"ul\",null,{\"className\":\"\",\"children\":[[\"$\",\"li\",\"0\",{\"children\":[[\"$\",\"a\",null,{\"href\":\"#feedback-from-part-1\",\"children\":\"Feedback from part 1\"}],null]}],[\"$\",\"li\",\"1\",{\"children\":[[\"$\",\"a\",null,{\"href\":\"#execution\",\"children\":\"Execution\"}],[\"$\",\"ul\",null,{\"className\":\"\",\"children\":[[\"$\",\"li\",\"0\",{\"children\":[[\"$\",\"a\",null,{\"href\":\"#actually-do-stuff\",\"children\":\"Actually do stuff\"}],null]}],[\"$\",\"li\",\"1\",{\"children\":[[\"$\",\"a\",null,{\"href\":\"#handling-sql-queries\",\"children\":\"Handling SQL Queries\"}],null]}],[\"$\",\"li\",\"2\",{\"children\":[[\"$\",\"a\",null,{\"href\":\"#bringing-it-all-together\",\"children\":\"Bringing it all together\"}],null]}],[\"$\",\"li\",\"3\",{\"children\":[[\"$\",\"a\",null,{\"href\":\"#better-display-for-repl\",\"children\":\"Better display for REPL\"}],null]}],[\"$\",\"li\",\"4\",{\"children\":[[\"$\",\"a\",null,{\"href\":\"#wrap-up\",\"children\":\"Wrap up\"}],null]}]]}]]}]]}]}]]}],[\"$\",\"h1\",null,{\"id\":\"feedback-from-part-1\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#feedback-from-part-1\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Feedback from part 1\"]}],[\"$\",\"p\",null,{\"children\":[\"I got some very nice feedback from the \",[\"$\",\"$Le\",null,{\"href\":\"/blog/build-a-db/part01\",\"children\":\"first part of this series\"}],\". The main suggestions were to use some different parsing libraries like \",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://docs.rs/chumsky/latest/chumsky/\",\"children\":\"chumsky\"}],\" or use an existing SQL parser like \",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/sqlparser-rs/sqlparser-rs\",\"children\":\"sqlparser-rs\"}],\".\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"chumsky\"}],\" looks like it handles a lot of the error handling logic I had to do myself while still being defined in rust (no extra language). If I had known of this before I would have used it. Might switch to it later on if our grammar gets more involved. Thanks \",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://hachyderm.io/@hjvt/109620348134117972\",\"children\":\"@hjvt@hachyderm.io\"}],\" for the recommendation!\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"sqlparser-rs\"}],\" on the other hand looks very well maintained and handles many existing SQL dialects. If this was not a toy project I would have probably started off with this to get going faster without writing any parser logic.\"]}],[\"$\",\"p\",null,{\"children\":\"Enough feedback, let's get into actually running queries.\"}],[\"$\",\"h1\",null,{\"id\":\"execution\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#execution\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Execution\"]}],[\"$\",\"p\",null,{\"children\":[\"To get started on execution let's make a new crate for it with \",[\"$\",\"code\",null,{\"children\":\"cargo new sql_jr_execution\"}],\". We will need the parser crate for our types we made and some other workspace dependencies.\"]}],[\"$\",\"div\",null,{\"className\":\"remark-code-title\",\"children\":\"sql_jr_execution/Cargo.toml\"}],[\"$\",\"$L1b\",null,{\"className\":\"shiki shiki-themes github-light github-dark\",\"style\":{\"backgroundColor\":\"#fff\",\"--shiki-dark-bg\":\"#24292e\",\"color\":\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},\"tabIndex\":\"0\",\"children\":[\"$\",\"code\",null,{\"children\":[[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"package\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"]\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"name = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"sql_jr_execution\\\"\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"version = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"0.1.0\\\"\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"edition = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"2021\\\"\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"dependencies\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"]\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"miette = {workspace = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"serde = {workspace = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"sql_jr_parser = { path = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"../sql_jr_parser\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" }\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"thiserror = {workspace = \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}]]}]}],[\"$\",\"p\",null,{\"children\":\"Since we will need to operate on tables, let's start by defining our table type. For now, we will only deal with in memory execution. Soon enough we can handle reading from disk.\"}],[\"$\",\"div\",null,{\"className\":\"remark-code-title\",\"children\":\"table.rs\"}],[\"$\",\"$L1b\",null,{\"className\":\"shiki shiki-themes github-light github-dark\",\"style\":{\"backgroundColor\":\"#fff\",\"--shiki-dark-bg\":\"#24292e\",\"color\":\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},\"tabIndex\":\"0\",\"children\":[\"$\",\"code\",null,{\"children\":[[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"use\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" std\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"collections\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"BTreeMap\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"HashMap\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"use\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" serde\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Deserialize\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Serialize\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"use\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" sql_jr_parser\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Column\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"; \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"// See part 1 for this type def. Just column name and sql data type (string or int)\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"// NOTE: For now just a mapping of col name =\u003e data as a str. Will change later\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"/// A row stored in a table\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" StoredRow\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" HashMap\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"/// List of column info\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" ColumnInfo\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Vec\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Column\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"#[derive(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Debug\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Clone\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Serialize\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Deserialize\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\")]\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"pub\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"crate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"struct\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Table\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"    /// row id to row\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    rows\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" BTreeMap\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"usize\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"StoredRow\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"    /// Column info for all columns in the table\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    columns\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" ColumnInfo\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}]]}]}],[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"Table\"}],\" struct is basically just a wrapper around Rust's \",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://doc.rust-lang.org/stable/std/collections/struct.BTreeMap.html#\",\"children\":\"Btree\"}],\" with some extra column info.\"]}],[\"$\",\"h3\",null,{\"id\":\"what-is-a-b-tree\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#what-is-a-b-tree\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"What is a B-Tree?\"]}],[\"$\",\"p\",null,{\"children\":[\"A \",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://en.wikipedia.org/wiki/B-tree\",\"children\":\"B-Tree\"}],\" is a generalized Binary Search Tree (BST). BSTs are great in theory but in practice, they kinda suck for cache locality, nodes only store 1 piece of data, have the potential to be unbalanced, and require a heap allocation for each insertion. In \\\"current year\\\" CPUs are insanely fast, so we need data structures that are better for reducing memory access.\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"em\",null,{\"children\":\"insert rant about why data oriented design is GOATED here\"}],\".\"]}],[\"$\",\"p\",null,{\"children\":[\"Alexis Beingessner in \",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://cglab.ca/~abeinges/blah/rust-btree-case/#what's-a-b-tree?-why's-a-b-tree?\",\"children\":\"Rust Collections Case Study: BTreeMap\"}],\" described B-Trees as\"]}],[\"$\",\"blockquote\",null,{\"children\":[\"$\",\"p\",null,{\"children\":\"B-Trees take the idea of a BST, and say \\\"lets put some arrays in there; computers love arrays\\\". Rather than each node consisting of a single element with two children, B-Tree nodes have an array of elements with an array of children\"}]}],[\"$\",\"p\",null,{\"children\":\"I won't go into too much detail on B-Tree implementation, since I'm just using rust's built-in for now. If you're interested here are some good resources on B-Trees.\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://cglab.ca/~abeinges/blah/rust-btree-case\",\"children\":\"Rust Collections Case Study: BTreeMap\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://en.wikipedia.org/wiki/B-tree\",\"children\":\"Wikipedia\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"http://opendatastructures.org/ods-python/14_2_B_Trees.html\",\"children\":\"Open Data Structures\"}]}]]}],[\"$\",\"p\",null,{\"children\":\"With that said, let's walk through a basic example\"}],[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"alt\":\"B-Tree example\",\"src\":\"https://upload.wikimedia.org/wikipedia/commons/6/65/B-tree.svg\"}]}],[\"$\",\"p\",null,{\"children\":[\"Here the internal node (the root) has 3 children. All keys \",[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[[\"$\",\"mo\",null,{\"children\":\"\u003c\"}],[\"$\",\"mn\",null,{\"children\":\"7\"}]]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"\u003c 7\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"height\":\".5782em\",\"verticalAlign\":\"-.0391em\"},\"className\":\"strut\"}],[\"$\",\"span\",null,{\"className\":\"mrel\",\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"marginRight\":\".2778em\"},\"className\":\"mspace\"}]]}],[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"height\":\".6444em\"},\"className\":\"strut\"}],[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"7\"}]]}]]}]]}],\" are in the left child, keys \",[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[[\"$\",\"mo\",null,{\"children\":\"\u003e\"}],[\"$\",\"mn\",null,{\"children\":\"7\"}]]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"\u003e 7\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"height\":\".5782em\",\"verticalAlign\":\"-.0391em\"},\"className\":\"strut\"}],[\"$\",\"span\",null,{\"className\":\"mrel\",\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"marginRight\":\".2778em\"},\"className\":\"mspace\"}]]}],[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"height\":\".6444em\"},\"className\":\"strut\"}],[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"7\"}]]}]]}]]}],\" and \",[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[[\"$\",\"mo\",null,{\"children\":\"\u003c\"}],[\"$\",\"mo\",null,{\"children\":\"=\"}],[\"$\",\"mn\",null,{\"children\":\"16\"}]]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"\u003c= 16\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"height\":\".5782em\",\"verticalAlign\":\"-.0391em\"},\"className\":\"strut\"}],[\"$\",\"span\",null,{\"className\":\"mrel\",\"children\":\"\u003c=\"}],[\"$\",\"span\",null,{\"style\":{\"marginRight\":\".2778em\"},\"className\":\"mspace\"}]]}],[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"height\":\".6444em\"},\"className\":\"strut\"}],[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"16\"}]]}]]}]]}],\" are in the middle, and finally, keys \",[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[[\"$\",\"mo\",null,{\"children\":\"\u003e\"}],[\"$\",\"mn\",null,{\"children\":\"16\"}]]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"\u003e 16\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"height\":\".5782em\",\"verticalAlign\":\"-.0391em\"},\"className\":\"strut\"}],[\"$\",\"span\",null,{\"className\":\"mrel\",\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"marginRight\":\".2778em\"},\"className\":\"mspace\"}]]}],[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"height\":\".6444em\"},\"className\":\"strut\"}],[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"16\"}]]}]]}]]}],\" are in the right child.\"]}],[\"$\",\"p\",null,{\"children\":[\"You can customize the \",[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[\"$\",\"mi\",null,{\"children\":\"B\"}]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"B\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"height\":\".6833em\"},\"className\":\"strut\"}],[\"$\",\"span\",null,{\"style\":{\"marginRight\":\".05017em\"},\"className\":\"mord mathnormal\",\"children\":\"B\"}]]}]}]]}],\" constant to have nodes store more/fewer keys and have more/fewer children. The average Lookup for a B-tree with \",[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[\"$\",\"mi\",null,{\"children\":\"N\"}]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"N\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"height\":\".6833em\"},\"className\":\"strut\"}],[\"$\",\"span\",null,{\"style\":{\"marginRight\":\".10903em\"},\"className\":\"mord mathnormal\",\"children\":\"N\"}]]}]}]]}],\" keys is \",[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[[\"$\",\"mi\",null,{\"mathvariant\":\"script\",\"children\":\"O\"}],[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\"(\"}],[\"$\",\"mi\",null,{\"children\":\"log\"}],[\"$\",\"mo\",null,{\"children\":\"⁡\"}],[\"$\",\"msub\",null,{\"children\":[[\"$\",\"mrow\",null,{}],[\"$\",\"mn\",null,{\"children\":\"2\"}]]}],[\"$\",\"mi\",null,{\"children\":\"N\"}],[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\")\"}]]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"\\\\mathcal{O}(\\\\log{_2}N)\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"height\":\"1em\",\"verticalAlign\":\"-.25em\"},\"className\":\"strut\"}],[\"$\",\"span\",null,{\"style\":{\"marginRight\":\".02778em\"},\"className\":\"mord mathcal\",\"children\":\"O\"}],[\"$\",\"span\",null,{\"className\":\"mopen\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"mop\",\"children\":[\"lo\",[\"$\",\"span\",null,{\"style\":{\"marginRight\":\".01389em\"},\"children\":\"g\"}]]}],[\"$\",\"span\",null,{\"style\":{\"marginRight\":\".1667em\"},\"className\":\"mspace\"}],[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":[[\"$\",\"span\",null,{}],[\"$\",\"span\",null,{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",null,{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"height\":\".3011em\"},\"className\":\"vlist\",\"children\":[\"$\",\"span\",null,{\"style\":{\"top\":\"-2.55em\",\"marginRight\":\".05em\"},\"children\":[[\"$\",\"span\",null,{\"style\":{\"height\":\"2.7em\"},\"className\":\"pstrut\"}],[\"$\",\"span\",null,{\"className\":\"mtight reset-size6 size3 sizing\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord mtight\",\"children\":\"2\"}]}]]}]}],[\"$\",\"span\",null,{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",null,{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",null,{\"style\":{\"height\":\".15em\"},\"className\":\"vlist\",\"children\":[\"$\",\"span\",null,{}]}]}]]}]}]]}]}],[\"$\",\"span\",null,{\"style\":{\"marginRight\":\".10903em\"},\"className\":\"mord mathnormal\",\"children\":\"N\"}],[\"$\",\"span\",null,{\"className\":\"mclose\",\"children\":\")\"}]]}]}]]}],\" which is the same for a BST.\"]}],[\"$\",\"h3\",null,{\"id\":\"why-b-tree\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#why-b-tree\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Why B-Tree?\"]}],[\"$\",\"p\",null,{\"children\":\"As I mentioned before B-Trees are great for cache locality. Also, you can make each node the size of a memory/disk block. This way you can minimize reads by chunking up the data more efficiently.\"}],[\"$\",\"h2\",null,{\"id\":\"actually-do-stuff\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#actually-do-stuff\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Actually do stuff\"]}],[\"$\",\"p\",null,{\"children\":\"Nerd stuff aside, let's add actual logic for our table\"}],[\"$\",\"$L1b\",null,{\"className\":\"shiki shiki-themes github-light github-dark\",\"style\":{\"backgroundColor\":\"#fff\",\"--shiki-dark-bg\":\"#24292e\",\"color\":\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},\"tabIndex\":\"0\",\"children\":[\"$\",\"code\",null,{\"children\":[[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"impl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Table\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"    // Create a table with the given column definitions\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"    pub\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" fn\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(columns\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Vec\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Column\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e) \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"-\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" Self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"        Self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"            rows\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" BTreeMap\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(),\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"            columns,\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"        }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"    /// Insert values (a row) into the table\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"    ///\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"    /// assumes the values are in the same order of the columns passed to create\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"    pub\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" fn\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" insert\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"\u0026mut\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", values\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Vec\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e) {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"        let\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" id \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" self\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"            .\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"rows\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"            .\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"last_key_value\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"()\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"            .\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"map_or\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"|\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(max_id, _)\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"|\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" max_id \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" 1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"        let\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" row\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" StoredRow\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" values\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"            .\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"into_iter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"()\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"            .\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"zip\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"columns\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"iter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"())\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"            .\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"map\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"|\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(v, col)\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"|\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" (col\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"name\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"to_owned\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(), v))\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"            .\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"collect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"        self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"rows\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"insert\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(id, row);\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}]]}]}],[\"$\",\"p\",null,{\"children\":\"Here we create a table with the given column definitions (from the create table sql command). For insert, we get an ID for the new row which is just an ID sequence starting at 0 for the first row. We then insert the values into the B-TreeMap with that ID as the key and the row's values as a hash map of the column name to a string of the value to insert.\"}],[\"$\",\"p\",null,{\"children\":[\"Those two functions can handle creating tables (mostly) and inserting data, but how should we handle select? A simple first step is to re-use the \",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://doc.rust-lang.org/std/iter/trait.Iterator.html\",\"children\":\"Iterator\"}],\" on \",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://doc.rust-lang.org/std/collections/struct.BTreeMap.html#method.iter\",\"children\":\"BTreeMap\"}],\".\"]}],[\"$\",\"$L1b\",null,{\"className\":\"shiki shiki-themes github-light github-dark\",\"style\":{\"backgroundColor\":\"#fff\",\"--shiki-dark-bg\":\"#24292e\",\"color\":\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},\"tabIndex\":\"0\",\"children\":[\"$\",\"code\",null,{\"children\":[[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"impl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Table\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"    pub\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" fn\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" iter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"\u0026\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"-\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" std\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"collections\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"btree_map\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Iter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"usize\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Row\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"        self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"rows\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"iter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"()\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}]]}]}],[\"$\",\"p\",null,{\"children\":[\"This will give us an \",[\"$\",\"code\",null,{\"children\":\"Iterator\"}],\" over \",[\"$\",\"code\",null,{\"children\":\"(row_id, row_values)\"}],\".\"]}],[\"$\",\"p\",null,{\"children\":[\"Re-using the iterator from BTreeMap is fine, but I like how many Rust DB libraries have a \",[\"$\",\"code\",null,{\"children\":\"Row\"}],\" trait/struct that gives you extra information. For example, \",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/launchbadge/sqlx\",\"children\":\"SQLX\"}],\" has a \",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://docs.rs/sqlx/latest/sqlx/trait.Row.html\",\"children\":\"Row trait\"}],\" that lets you get column info back for the query you ran, safe/unsafe conversions into rust types, and a few other helpers. So let's make our \",[\"$\",\"code\",null,{\"children\":\"Row\"}],\" struct and iterator, so we can add these features later on.\"]}],[\"$\",\"$L1b\",null,{\"className\":\"shiki shiki-themes github-light github-dark\",\"style\":{\"backgroundColor\":\"#fff\",\"--shiki-dark-bg\":\"#24292e\",\"color\":\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},\"tabIndex\":\"0\",\"children\":[\"$\",\"code\",null,{\"children\":[[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"use\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" std\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"collections\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"HashMap\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"rc\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Rc\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"};\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"use\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" crate::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"table\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"ColumnInfo\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"; \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"// Vec\u003cColumn\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"/// A Row in a Query response\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"#[derive(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Debug\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Clone\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\")]\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"pub\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" struct\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Row\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"a\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" usize\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    columns\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Rc\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"ColumnInfo\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    data\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" \u0026\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"a\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" HashMap\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}]]}]}],[\"$\",\"p\",null,{\"children\":[\"Here I made the decision that this \",[\"$\",\"code\",null,{\"children\":\"Row\"}],\" struct will not own the data it's showing. Therefore, it needs a reference to the data stored in the table. I also want to have the row have access to the \",[\"$\",\"code\",null,{\"children\":\"ColumnInfo\"}],\" from the table. Since every row will be holding a reference to the same \",[\"$\",\"code\",null,{\"children\":\"ColumnInfo\"}],\", I went with an \",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://doc.rust-lang.org/std/rc/index.html\",\"children\":\"RC\"}],\" to avoid extra lifetime parameters on the row struct.\"]}],[\"$\",\"p\",null,{\"children\":[\"Now we can implement \",[\"$\",\"code\",null,{\"children\":\"Iterator\"}],\" for the table. We can just wrap the existing \",[\"$\",\"code\",null,{\"children\":\"Iterator\"}],\" from \",[\"$\",\"code\",null,{\"children\":\"BTreeMap\"}],\" and transform each response into our \",[\"$\",\"code\",null,{\"children\":\"Row\"}],\" struct.\"]}],[\"$\",\"$L1b\",null,{\"className\":\"shiki shiki-themes github-light github-dark\",\"style\":{\"backgroundColor\":\"#fff\",\"--shiki-dark-bg\":\"#24292e\",\"color\":\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},\"tabIndex\":\"0\",\"children\":[\"$\",\"code\",null,{\"children\":[[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"/// Iterator of [`Row`]s from a table\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"pub\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"crate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"struct\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" TableIter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"a\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"    /// Underlying iterator over the btree_map\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    map_iter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" std\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"collections\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"btree_map\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Iter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"a\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"usize\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"StoredRow\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"    /// The columns of the [`Table`]\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    columns\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Rc\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"ColumnInfo\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"impl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"a\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"TableIter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"a\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"    pub\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" fn\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"        map_iter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" std\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"collections\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"btree_map\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Iter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"a\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"usize\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"StoredRow\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"        columns\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Rc\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"ColumnInfo\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    ) \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"-\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" Self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"        Self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" { map_iter, columns }\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"impl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"a\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Iterator\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" for\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" TableIter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"a\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"    type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Item\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Row\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"a\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"    fn\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" next\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"\u0026mut\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"-\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Option\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"Self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Item\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"        self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"map_iter\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"            .\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"next\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"()\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"            .\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"map\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"|\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(id, data)\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"|\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Row\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"columns\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"clone\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(), id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"clone\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(), data))\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}]]}]}],[\"$\",\"p\",null,{\"children\":[\"Now we can implement the \",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://doc.rust-lang.org/std/iter/trait.IntoIterator.html\",\"children\":\"IntoIterator trait\"}],\" on \",[\"$\",\"code\",null,{\"children\":\"Table\"}],\" for easy conversion into an iterator.\"]}],[\"$\",\"$L1b\",null,{\"className\":\"shiki shiki-themes github-light github-dark\",\"style\":{\"backgroundColor\":\"#fff\",\"--shiki-dark-bg\":\"#24292e\",\"color\":\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},\"tabIndex\":\"0\",\"children\":[\"$\",\"code\",null,{\"children\":[[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"impl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"a\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"IntoIterator\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" for\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" \u0026\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"a\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Table\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"    type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Item\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Row\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"a\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"    type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" IntoIter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" TableIter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"a\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"    fn\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" into_iter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"-\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" Self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"IntoIter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"        let\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" col_info \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Rc\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"columns\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"clone\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"());\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"        TableIter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"rows\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"iter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(), col_info)\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}]]}]}],[\"$\",\"p\",null,{\"children\":[\"now the \",[\"$\",\"code\",null,{\"children\":\"iter\"}],\" method (not necessarily needed) on table can just call the trait method\"]}],[\"$\",\"$L1b\",null,{\"className\":\"shiki shiki-themes github-light github-dark\",\"style\":{\"backgroundColor\":\"#fff\",\"--shiki-dark-bg\":\"#24292e\",\"color\":\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},\"tabIndex\":\"0\",\"children\":[\"$\",\"code\",null,{\"children\":[[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"impl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Table\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"  pub\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" fn\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" iter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"\u0026\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"-\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" impl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Iterator\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Item\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Row\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"        self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"into_iter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"()\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}]]}]}],[\"$\",\"h2\",null,{\"id\":\"handling-sql-queries\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#handling-sql-queries\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Handling SQL Queries\"]}],[\"$\",\"p\",null,{\"children\":[\"Now that we have a \",[\"$\",\"code\",null,{\"children\":\"Table\"}],\" struct we need to hook up the parsed commands to create, insert, and read from tables.\"]}],[\"$\",\"p\",null,{\"children\":\"First we should define the response type for an execution\"}],[\"$\",\"$L1b\",null,{\"className\":\"shiki shiki-themes github-light github-dark\",\"style\":{\"backgroundColor\":\"#fff\",\"--shiki-dark-bg\":\"#24292e\",\"color\":\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},\"tabIndex\":\"0\",\"children\":[\"$\",\"code\",null,{\"children\":[[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"use\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" derive_more\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Display\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"#[derive(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Debug\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Display\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\")]\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"pub\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" enum\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" ExecResponse\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"a\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    #[display(fmt \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\" \\\"{_0:?}\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\")] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"// only show the values not \\\"Select(...)\\\"\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"    Select\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Vec\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Row\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"a\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e\u003e),\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"    Insert\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"    Create\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}]]}]}],[\"$\",\"p\",null,{\"children\":[\"Here I use the \",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://docs.rs/derive_more/latest/derive_more/\",\"children\":\"derive_more\"}],\" crate's Display derive macro to avoid writing my own implementation of Display. If you're a real one who's been paying attention, you may have noticed that we did not implement \",[\"$\",\"code\",null,{\"children\":\"Display\"}],\" on \",[\"$\",\"code\",null,{\"children\":\"Row\"}],\" but the \",[\"$\",\"code\",null,{\"children\":\"Display\"}],\" derive still compiles, this is due to us adding \",[\"$\",\"code\",null,{\"children\":\"#[display(fmt = \\\"{_0:?}\\\")]\"}],\" to use the debug format of \",[\"$\",\"code\",null,{\"children\":\"Vec\u003cRow\u003e\"}],\" as the \",[\"$\",\"code\",null,{\"children\":\"Display\"}],\" format. While we won't use it much for select display (more on that later), for the other response cases It's nice to have.\"]}],[\"$\",\"p\",null,{\"children\":\"We also should make our own Error type for Query Execution\"}],[\"$\",\"$L1b\",null,{\"className\":\"shiki shiki-themes github-light github-dark\",\"style\":{\"backgroundColor\":\"#fff\",\"--shiki-dark-bg\":\"#24292e\",\"color\":\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},\"tabIndex\":\"0\",\"children\":[\"$\",\"code\",null,{\"children\":[[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"use\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" miette\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Diagnostic\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"use\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" thiserror\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"/// Errors during query execution\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"#[derive(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Debug\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Diagnostic\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\")]\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"#[error(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"Query Execution Error\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\")]\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"pub\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" enum\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" QueryExecutionError\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    #[error(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"Table {0} was not found\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\")]\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"    TableNotFound\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"),\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    #[error(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"Table {0} already exists\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\")]\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"    TableAlreadyExists\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"),\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    #[error(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"Column {0} does not exist\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\")]\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"    ColumnDoesNotExist\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"),\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}]]}]}],[\"$\",\"p\",null,{\"children\":[\"Like in \",[\"$\",\"$Le\",null,{\"href\":\"/blog/build-a-db/part01\",\"children\":\"part1\"}],\", we still are using \",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://docs.rs/miette/latest/miette/\",\"children\":\"miette\"}],\"/\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://docs.rs/thiserror/latest/thiserror/\",\"children\":\"thiserror\"}],\" for better looking errors.\"]}],[\"$\",\"p\",null,{\"children\":[\"Now we can finally actually run some queries. For a quick refresher on the \",[\"$\",\"code\",null,{\"children\":\"SqlQuery\"}],\" type, see \",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/JRMurr/SQLJr/blob/5324c38bc74cb77d2daf035a0f3d1da3fc7b4c3b/crates/sql_jr_parser/src/ast.rs#L19\",\"children\":\"the source code\"}]]}],[\"$\",\"$L1b\",null,{\"className\":\"shiki shiki-themes github-light github-dark\",\"style\":{\"backgroundColor\":\"#fff\",\"--shiki-dark-bg\":\"#24292e\",\"color\":\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},\"tabIndex\":\"0\",\"children\":[\"$\",\"code\",null,{\"children\":[[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"#[derive(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Debug\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\")]\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"pub\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" struct\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Execution\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    tables\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" HashMap\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Table\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"impl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Execution\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"    pub\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" fn\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"() \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"-\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" Self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"        Self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"            tables\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" HashMap\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(),\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"        }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"    pub\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" fn\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" run\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"\u0026mut\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" SqlQuery\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"-\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Result\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"ExecResponse\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"QueryExecutionError\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"        match\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" query {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"            SqlQuery\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Select\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"mut\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" select) \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"                let\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" table \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" select\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"table; \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"// the table name\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"                let\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" table \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" self\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"                    .\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"tables\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"                    .\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"get\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"\u0026\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"table)\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"                    .\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"ok_or\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"QueryExecutionError\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"TableNotFound\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(table))\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"?\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"                // not projecting to the selected columns yet\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"                let\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" rows \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" table\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"iter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"collect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"                Ok\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"ExecResponse\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Select\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(rows)))\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"            }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"            SqlQuery\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Insert\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(insert) \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"                let\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Some\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(table) \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"tables\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"get_mut\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"\u0026\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"insert\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"table) \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"else\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"                    return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Err\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"QueryExecutionError\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"TableNotFound\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(insert\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"table))\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"                };\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"                table\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"insert\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(insert\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"values);\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"                Ok\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"ExecResponse\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Insert\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"            }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"            SqlQuery\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Create\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(create) \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"                let\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" table \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Table\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(create\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"columns);\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"                self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"tables\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"insert\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(create\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"table, table);\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"                Ok\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"ExecResponse\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Create\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"            }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"        }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}]]}]}],[\"$\",\"p\",null,{\"children\":[\"Since we handled most of the logic in the \",[\"$\",\"code\",null,{\"children\":\"Table\"}],\"/\",[\"$\",\"code\",null,{\"children\":\"Row\"}],\" structs, the actual execution is mostly just wrapper around the \",[\"$\",\"code\",null,{\"children\":\"HashMap\"}],\" of tables with some basic error handling.\"]}],[\"$\",\"h2\",null,{\"id\":\"bringing-it-all-together\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#bringing-it-all-together\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Bringing it all together\"]}],[\"$\",\"p\",null,{\"children\":[\"With the \",[\"$\",\"code\",null,{\"children\":\"Execution\"}],\" struct we can handle the parsed commands from our parser but right now we don't have it all hooked up. We need to unify the parser and execution into one.\"]}],[\"$\",\"p\",null,{\"children\":[\"Ideally, we would have some new crate for the full \\\"pipeline\\\" from parsing to execution (and probably more steps we will add later), but for now having this logic in the \",[\"$\",\"code\",null,{\"children\":\"Execution\"}],\" crate feels fine.\"]}],[\"$\",\"p\",null,{\"children\":\"First, step is to combine the Error types from Parsing and Execution\"}],[\"$\",\"$L1b\",null,{\"className\":\"shiki shiki-themes github-light github-dark\",\"style\":{\"backgroundColor\":\"#fff\",\"--shiki-dark-bg\":\"#24292e\",\"color\":\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},\"tabIndex\":\"0\",\"children\":[\"$\",\"code\",null,{\"children\":[[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"use\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" miette\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Diagnostic\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"use\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" sql_jr_parser\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"FormattedError\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"use\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" thiserror\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"/// Errors at any point in the SQL \\\"pipeline\\\"\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"#[derive(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Debug\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Diagnostic\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\")]\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"#[error(transparent)]\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"pub\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" enum\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" SQLError\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"a\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    #[diagnostic(transparent)]\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"    QueryExecutionError\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(#[from] \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"QueryExecutionError\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"),\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    #[diagnostic(transparent)]\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"    ParsingError\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"FormattedError\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"a\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e),\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"// need a manual impl since the error #[from] seems sad on lifetimes\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"impl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"a\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"From\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"FormattedError\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"a\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"for\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" SQLError\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"a\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"    fn\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(value\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" FormattedError\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"a\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e) \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"-\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" Self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"        SQLError\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"ParsingError\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(value)\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}]]}]}],[\"$\",\"p\",null,{\"children\":[\"Here \",[\"$\",\"code\",null,{\"children\":\"#[diagnostic(transparent)]\"}],\" is similar to \",[\"$\",\"code\",null,{\"children\":\"#[error(transparent)]\"}],\" in \",[\"$\",\"code\",null,{\"children\":\"thiserror\"}],\", it lets you wrap other errors but still call their \",[\"$\",\"code\",null,{\"children\":\"Display\"}],\" trait when the error is shown.\"]}],[\"$\",\"p\",null,{\"children\":\"Now we can have a function that parses and executes the query\"}],[\"$\",\"$L1b\",null,{\"className\":\"shiki shiki-themes github-light github-dark\",\"style\":{\"backgroundColor\":\"#fff\",\"--shiki-dark-bg\":\"#24292e\",\"color\":\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},\"tabIndex\":\"0\",\"children\":[\"$\",\"code\",null,{\"children\":[[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"impl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Execution\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"   pub\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" fn\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" parse_and_run\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"a\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"\u0026mut\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" \u0026\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"a\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"-\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Result\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"ExecResponse\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"SQLError\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"a\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e\u003e {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"        let\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" query \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" parse_sql_query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(query)\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"?\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"        let\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" res \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"run\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(query)\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"?\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"        Ok\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(res)\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}]]}]}],[\"$\",\"p\",null,{\"children\":\"Which lets our REPL now look like\"}],[\"$\",\"$L1b\",null,{\"className\":\"shiki shiki-themes github-light github-dark\",\"style\":{\"backgroundColor\":\"#fff\",\"--shiki-dark-bg\":\"#24292e\",\"color\":\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},\"tabIndex\":\"0\",\"children\":[\"$\",\"code\",null,{\"children\":[[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"fn\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" main\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"() {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"  ...\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"  let\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" mut\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" exec \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" sql_jr_execution\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Execution\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"  loop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"        let\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" readline \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" rl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"readline\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"\u003e\u003e \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"        match\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" readline {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"          Ok\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(line) \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"                rl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"add_history_entry\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(line\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"as_str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"());\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"                let\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" line\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" \u0026\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" line\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"as_ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"                let\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" res \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" exec\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"parse_and_run\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(line);\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"                match\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" res {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"                    Ok\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(exec_res) \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" println!\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"{exec_res}\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"),\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"                    Err\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(e) \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"                        let\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" mut\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" s \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"                        GraphicalReportHandler\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"()\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"                            .\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"with_cause_chain\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"()\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"                            .\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"with_context_lines\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"10\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"                            .\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"render_report\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"\u0026mut\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" s, \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"\u0026\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"e)\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"                            .\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"unwrap\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"                        println!\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"{s}\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"                    }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"                }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"            }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"          // other cases unchanged from part 1\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"        }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}]]}]}],[\"$\",\"p\",null,{\"children\":\"The happy path in our REPL now looks like\"}],[\"$\",\"$L1b\",null,{\"className\":\"shiki shiki-themes github-light github-dark\",\"style\":{\"backgroundColor\":\"#fff\",\"--shiki-dark-bg\":\"#24292e\",\"color\":\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},\"tabIndex\":\"0\",\"children\":[\"$\",\"code\",null,{\"children\":[[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"children\":\"\u003e\u003e create table foo (col1 string, col2 string);\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"children\":\"Create\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"children\":\"\u003e\u003e insert into foo values a,b;\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"children\":\"Insert\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"children\":\"\u003e\u003e select col1,col2 from foo;\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"children\":\"[Row { id: 0, columns: [Column { name: \\\"col1\\\", type_info: String }, Column { name: \\\"col2\\\", type_info: String }], data: {\\\"col1\\\": \\\"a\\\", \\\"col2\\\": \\\"b\\\"} }]\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"children\":\"\u003e\u003e\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{}]}]]}]}],[\"$\",\"h2\",null,{\"id\":\"better-display-for-repl\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#better-display-for-repl\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Better display for REPL\"]}],[\"$\",\"p\",null,{\"children\":[\"The REPL works, but the display for select queries is pretty gross. We can use the \",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/zhiburt/tabled\",\"children\":\"tabled crate\"}],\" to format the response as a table. We can run \",[\"$\",\"code\",null,{\"children\":\"cargo add tabled\"}],\" in \",[\"$\",\"code\",null,{\"children\":\"crates/sql_jr_repl\"}],\" to add the crate to the repl.\"]}],[\"$\",\"p\",null,{\"children\":[\"If you look at the docs for \",[\"$\",\"code\",null,{\"children\":\"tabled\"}],\" many of the first examples involve the \",[\"$\",\"code\",null,{\"children\":\"#[derive(Tabled)]\"}],\" macro on your structs/enums. This does not really work for select queries since the columns are dynamic. Tabled still supports this with the \",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://docs.rs/tabled/0.10.0/tabled/builder/struct.Builder.html\",\"children\":\"builder\"}],\" to allow us to set the rows + columns dynamically.\"]}],[\"$\",\"p\",null,{\"children\":\"Let's add a new file to the REPL crate and handle display there\"}],[\"$\",\"div\",null,{\"className\":\"remark-code-title\",\"children\":\"crates/sql_jr_repl/display.rs\"}],[\"$\",\"$L1b\",null,{\"className\":\"shiki shiki-themes github-light github-dark\",\"style\":{\"backgroundColor\":\"#fff\",\"--shiki-dark-bg\":\"#24292e\",\"color\":\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},\"tabIndex\":\"0\",\"children\":[\"$\",\"code\",null,{\"children\":[[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"pub\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" fn\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" display_response\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(res\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" ExecResponse\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"    match\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" res {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"        ExecResponse\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"Select\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(rows) \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"            let\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" mut\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" builder \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Builder\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"            // Get column info from the first row\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"            let\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" row \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" rows\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"get\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"expect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"For now assuming we get data back\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"            let\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" columns\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Vec\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" row\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"                .\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"columns\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"() \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"// added helper, see below\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"                .\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"iter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"()\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"                .\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"map\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"|\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"col\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"|\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" col\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"name\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"to_string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"())\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"                .\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"collect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"();\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"            builder\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"set_columns\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"\u0026\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"columns);\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"            for\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" row \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"in\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" rows\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"into_iter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"() {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"                builder\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"add_record\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(columns\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"iter\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"map\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"|\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"col\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"|\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" row\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"get\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(col))); \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"// added a get helper, see below\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"            }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"            println!\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"{}\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", builder\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"build\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"())\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"        }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"        _ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" println!\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"{res}\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"),\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}]]}]}],[\"$\",\"p\",null,{\"children\":\"as noted in a comment I added these helpers to the row struct to make column lookup easier\"}],[\"$\",\"div\",null,{\"className\":\"remark-code-title\",\"children\":\"crates/sql_jr_execution/row.rs\"}],[\"$\",\"$L1b\",null,{\"className\":\"shiki shiki-themes github-light github-dark\",\"style\":{\"backgroundColor\":\"#fff\",\"--shiki-dark-bg\":\"#24292e\",\"color\":\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},\"tabIndex\":\"0\",\"children\":[\"$\",\"code\",null,{\"children\":[[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"impl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Row\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"     pub\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" fn\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" columns\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"\u0026\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"-\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" \u0026\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"ColumnInfo\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"        self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"columns\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"as_ref\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"()\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"    /// Get a single value from the row\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"    ///\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"    /// # Panics\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"    ///\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"    /// Panics if the column does not exist\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"    /// See [`try_get`](Self::try_get) for a non-panicking\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"    /// version.\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"    pub\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" fn\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" get\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"\u0026\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", column\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" \u0026\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"-\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"        self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"try_get\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(column)\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"unwrap\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"()\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"    /// Get a single value from the row\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"    pub\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" fn\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" try_get\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"\u0026\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", column\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" \u0026\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"-\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Result\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"QueryExecutionError\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"\u003e {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"        self\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"data\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"get\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(column)\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"map_or_else\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"            ||\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Err\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"QueryExecutionError\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"::\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"ColumnDoesNotExist\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(column\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"to_owned\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"())),\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"            |\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"val\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"|\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" Ok\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(val\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"to_string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"()),\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"        )\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}]]}]}],[\"$\",\"p\",null,{\"children\":\"now the REPL from the example above would show\"}],[\"$\",\"$L1b\",null,{\"className\":\"shiki shiki-themes github-light github-dark\",\"style\":{\"backgroundColor\":\"#fff\",\"--shiki-dark-bg\":\"#24292e\",\"color\":\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},\"tabIndex\":\"0\",\"children\":[\"$\",\"code\",null,{\"children\":[[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"children\":\"\u003e\u003e select col1,col2 from foo;\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"children\":\"+------+------+\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"children\":\"| col1 | col2 |\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"children\":\"+------+------+\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"children\":\"| a    | b    |\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"children\":\"+------+------+\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{}]}]]}]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"tabled\"}],\" has many \",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/zhiburt/tabled#style\",\"children\":\"style options\"}],\" if we wanted to tweak the look, but this is fine for now.\"]}],[\"$\",\"p\",null,{\"children\":\"You probably noticed the line\"}],[\"$\",\"$L1b\",null,{\"className\":\"shiki shiki-themes github-light github-dark\",\"style\":{\"backgroundColor\":\"#fff\",\"--shiki-dark-bg\":\"#24292e\",\"color\":\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},\"tabIndex\":\"0\",\"children\":[\"$\",\"code\",null,{\"children\":[[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#6a737d\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"//Get column info from the first row\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"let\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" row \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" rows\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"get\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#005cc5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#d73a49\",\"--shiki-dark\":\"#F97583\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6f42c1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"expect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#032f62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"For now assuming we get data back\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#24292e\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}]]}]}],[\"$\",\"p\",null,{\"children\":[\"in our display function. This obviously would get sad on empty responses. The best decision would be to add/move \",[\"$\",\"code\",null,{\"children\":\"ColumnInfo\"}],\" into \",[\"$\",\"code\",null,{\"children\":\"ExecResponse::Select\"}],\", so we return something like\"]}],[\"$\",\"$L1b\",null,{\"className\":\"shiki shiki-themes github-light github-dark\",\"style\":{\"backgroundColor\":\"#fff\",\"--shiki-dark-bg\":\"#24292e\",\"color\":\"#24292e\",\"--shiki-dark\":\"#e1e4e8\"},\"tabIndex\":\"0\",\"children\":[\"$\",\"code\",null,{\"children\":[[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"children\":\"{columns: Rc\u003cColumnInfo\u003e, row: Vec\u003cRow\u003e}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{}]}]]}]}],[\"$\",\"p\",null,{\"children\":\"but I'll save that for the next post.\"}],[\"$\",\"h2\",null,{\"id\":\"wrap-up\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#wrap-up\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Wrap up\"]}],[\"$\",\"p\",null,{\"children\":[\"Having basic execution feels nice, but the real challenge will be filtering and projecting the data. We have some extra clones and \",[\"$\",\"code\",null,{\"children\":\"unwraps\"}],\"/\",[\"$\",\"code\",null,{\"children\":\"expects\"}],\" we need to handle once we start moving away from this extremely simple happy path but so far the high level design feels good!\"]}]]]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"div\",null,{\"className\":\"pb-6 pt-6 text-sm text-gray-700 dark:text-gray-300\",\"children\":[[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"nofollow\",\"href\":\"https://mobile.twitter.com/search?q=https%3A%2F%2Fjohns.codes%2Fblog%2Fbuild-a-db%2Fpart02\",\"children\":\"Discuss on Twitter\"}],\" • \",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/JRMurr/JRMurr.github.io/blob/main/content/blog/build-a-db/part02.md\",\"children\":\"View on GitHub\"}]]}],[\"$\",\"div\",null,{\"className\":\"pb-6 pt-6 text-center text-gray-700 dark:text-gray-300\",\"id\":\"comment\",\"children\":[\"$\",\"$L1c\",null,{}]}],\"$undefined\"]}]]}],[\"$\",\"footer\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col text-sm font-medium sm:flex-row sm:justify-between sm:text-base\",\"children\":[[\"$\",\"div\",null,{\"className\":\"pt-4 xl:pt-8\",\"children\":[\"$\",\"$Le\",null,{\"href\":\"/blog/build-a-db/part01\",\"className\":\"text-primary-500 hover:text-primary-600 dark:hover:text-primary-400\",\"aria-label\":\"Previous post: Building a Simple DB in Rust - Part 1 - Parsing\",\"children\":[\"← \",\"Building a Simple DB in Rust - Part 1 - Parsing\"]}]}],[\"$\",\"div\",null,{\"className\":\"pt-4 xl:pt-8\",\"children\":[\"$\",\"$Le\",null,{\"href\":\"/blog/build-a-db/part03\",\"className\":\"text-primary-500 hover:text-primary-600 dark:hover:text-primary-400\",\"aria-label\":\"Next post: Building a Simple DB in Rust - Part 3 - Less Basic Execution\",\"children\":[\"Building a Simple DB in Rust - Part 3 - Less Basic Execution\",\" →\"]}]}]]}]}]]}]]}]}]]}]]\n"])</script><script>self.__next_f.push([1,"13:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"Building a Simple DB in Rust - Part 2 - Basic Execution | John's Codes\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"Building a basic database in rust\"}],[\"$\",\"meta\",\"4\",{\"name\":\"robots\",\"content\":\"index, follow\"}],[\"$\",\"meta\",\"5\",{\"name\":\"googlebot\",\"content\":\"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1\"}],[\"$\",\"link\",\"6\",{\"rel\":\"canonical\",\"href\":\"https://johns.codes/blog/build-a-db/part02\"}],[\"$\",\"link\",\"7\",{\"rel\":\"alternate\",\"type\":\"application/rss+xml\",\"href\":\"https://johns.codes/feed.xml\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:title\",\"content\":\"Building a Simple DB in Rust - Part 2 - Basic Execution\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:description\",\"content\":\"Building a basic database in rust\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:url\",\"content\":\"https://johns.codes/blog/build-a-db/part02\"}],[\"$\",\"meta\",\"11\",{\"property\":\"og:site_name\",\"content\":\"John's Codes\"}],[\"$\",\"meta\",\"12\",{\"property\":\"og:locale\",\"content\":\"en_US\"}],[\"$\",\"meta\",\"13\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"14\",{\"property\":\"article:published_time\",\"content\":\"2023-01-23T14:01:22.231Z\"}],[\"$\",\"meta\",\"15\",{\"property\":\"article:modified_time\",\"content\":\"2023-01-23T14:01:22.231Z\"}],[\"$\",\"meta\",\"16\",{\"property\":\"article:author\",\"content\":\"John Murray\"}],[\"$\",\"meta\",\"17\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"18\",{\"name\":\"twitter:title\",\"content\":\"Building a Simple DB in Rust - Part 2 - Basic Execution\"}],[\"$\",\"meta\",\"19\",{\"name\":\"twitter:description\",\"content\":\"Building a basic database in rust\"}],[\"$\",\"meta\",\"20\",{\"name\":\"next-size-adjust\"}]]\n"])</script><script>self.__next_f.push([1,"6:null\n"])</script><script>self.__next_f.push([1,""])</script></body></html>