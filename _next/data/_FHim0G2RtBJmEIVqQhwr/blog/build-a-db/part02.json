{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var d=Object.create;var c=Object.defineProperty;var t=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var p=Object.getPrototypeOf,y=Object.prototype.hasOwnProperty;var i=n=>c(n,\"__esModule\",{value:!0});var m=(n,s)=>()=>(s||n((s={exports:{}}).exports,s),s.exports),u=(n,s)=>{i(n);for(var r in s)c(n,r,{get:s[r],enumerable:!0})},N=(n,s,r)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let e of h(s))!y.call(n,e)&&e!==\"default\"&&c(n,e,{get:()=>s[e],enumerable:!(r=t(s,e))||r.enumerable});return n},C=n=>N(i(c(n!=null?d(p(n)):{},\"default\",n&&n.__esModule&&\"default\"in n?{get:()=>n.default,enumerable:!0}:{value:n,enumerable:!0})),n);var F=m((w,a)=>{a.exports=_jsx_runtime});var E={};u(E,{default:()=>g,frontmatter:()=>v});var l=C(F()),v={title:\"Building a Simple DB in Rust - Part 2 - Basic Execution\",seriesTitle:\"Part 2 - Basic Execution\",date:new Date(1674482482231),tags:[\"rust\",\"database\"],draft:!1,summary:\"Building a basic database in rust\",images:[],layout:\"PostLayout\"};function B(n={}){let{wrapper:s}=n.components||{};return s?(0,l.jsx)(s,Object.assign({},n,{children:(0,l.jsx)(r,{})})):r();function r(){let e=Object.assign({h1:\"h1\",a:\"a\",span:\"span\",p:\"p\",code:\"code\",pre:\"pre\",div:\"div\",h3:\"h3\",em:\"em\",blockquote:\"blockquote\",ul:\"ul\",li:\"li\",img:\"img\",math:\"math\",semantics:\"semantics\",mrow:\"mrow\",mo:\"mo\",mn:\"mn\",annotation:\"annotation\",mi:\"mi\",msub:\"msub\",h2:\"h2\"},n.components),{TOCInline:o}=e;return o||f(\"TOCInline\",!0),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(o,{toc:n.toc,asDisclosure:!0}),`\n`,(0,l.jsxs)(e.h1,{id:\"feedback-from-part-1\",children:[(0,l.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#feedback-from-part-1\",children:(0,l.jsx)(e.span,{className:\"icon icon-link\"})}),\"Feedback from part 1\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"I got some very nice feedback from the \",(0,l.jsx)(e.a,{href:\"/blog/build-a-db/part01\",children:\"first part of this series\"}),\". The main suggestions were to use some different parsing libraries like \",(0,l.jsx)(e.a,{href:\"https://docs.rs/chumsky/latest/chumsky/\",children:\"chumsky\"}),\" or use an existing SQL parser like \",(0,l.jsx)(e.a,{href:\"https://github.com/sqlparser-rs/sqlparser-rs\",children:\"sqlparser-rs\"}),\".\"]}),`\n`,(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:\"chumsky\"}),\" looks like it handles a lot of the error handling logic I had to do myself while still being defined in rust (no extra language). If I had known of this before I would have used it. Might switch to it later on if our grammar gets more involved. Thanks \",(0,l.jsx)(e.a,{href:\"https://hachyderm.io/@hjvt/109620348134117972\",children:\"@hjvt@hachyderm.io\"}),\" for the recommendation!\"]}),`\n`,(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:\"sqlparser-rs\"}),\" on the other hand looks very well maintained and handles many existing SQL dialects. If this was not a toy project I would have probably started off with this to get going faster without writing any parser logic.\"]}),`\n`,(0,l.jsx)(e.p,{children:\"Enough feedback, let's get into actually running queries.\"}),`\n`,(0,l.jsxs)(e.h1,{id:\"execution\",children:[(0,l.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#execution\",children:(0,l.jsx)(e.span,{className:\"icon icon-link\"})}),\"Execution\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"To get started on execution let's make a new crate for it with \",(0,l.jsx)(e.code,{children:\"cargo new sql_jr_execution\"}),\". We will need the parser crate for our types we made and some other workspace dependencies.\"]}),`\n`,(0,l.jsx)(\"div\",{className:\"remark-code-title\",children:\"sql_jr_execution/Cargo.toml\"}),`\n`,(0,l.jsxs)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:[(0,l.jsx)(e.div,{className:\"language-id\",children:\"toml\"}),(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsxs)(e.code,{children:[(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"[\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"package\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"]\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"name\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#E9F284\"},children:'\"'}),(0,l.jsx)(e.span,{style:{color:\"#F1FA8C\"},children:\"sql_jr_execution\"}),(0,l.jsx)(e.span,{style:{color:\"#E9F284\"},children:'\"'})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"version\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#E9F284\"},children:'\"'}),(0,l.jsx)(e.span,{style:{color:\"#F1FA8C\"},children:\"0.1.0\"}),(0,l.jsx)(e.span,{style:{color:\"#E9F284\"},children:'\"'})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"edition\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#E9F284\"},children:'\"'}),(0,l.jsx)(e.span,{style:{color:\"#F1FA8C\"},children:\"2021\"}),(0,l.jsx)(e.span,{style:{color:\"#E9F284\"},children:'\"'})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"[\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"dependencies\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"]\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"miette\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"workspace\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"true\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"serde\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"workspace\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"true\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"sql_jr_parser\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" { \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"path\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#E9F284\"},children:'\"'}),(0,l.jsx)(e.span,{style:{color:\"#F1FA8C\"},children:\"../sql_jr_parser\"}),(0,l.jsx)(e.span,{style:{color:\"#E9F284\"},children:'\"'}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" }\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"thiserror\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"workspace\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"true\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})]})]})})]}),`\n`,(0,l.jsx)(e.p,{children:\"Since we will need to operate on tables, let's start by defining our table type. For now, we will only deal with in memory execution. Soon enough we can handle reading from disk.\"}),`\n`,(0,l.jsx)(\"div\",{className:\"remark-code-title\",children:\"table.rs\"}),`\n`,(0,l.jsxs)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:[(0,l.jsx)(e.div,{className:\"language-id\",children:\"rust\"}),(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsxs)(e.code,{children:[(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"use\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" std\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"collections\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"{\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"BTreeMap\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"HashMap\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"};\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"use\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" serde\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"{\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Deserialize\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Serialize\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"};\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"use\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" sql_jr_parser\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Column\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\";\"}),(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\" // See part 1 for this type def. Just column name and sql data type (string or int)\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"// NOTE: For now just a mapping of col name => data as a str. Will change later\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"/// A row stored in a table\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"type\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"StoredRow\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"HashMap\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"String\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"String\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\">;\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"/// List of column info\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"type\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"ColumnInfo\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Vec\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Column\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\">;\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"#[derive(\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Debug\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Clone\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Default\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Serialize\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Deserialize\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\")]\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"pub\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"crate\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"struct\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Table\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"    /// row id to row\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    rows\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"BTreeMap\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"usize\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"StoredRow\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\">,\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"    /// Column info for all columns in the table\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    columns\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"ColumnInfo\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\",\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})})]})})]}),`\n`,(0,l.jsxs)(e.p,{children:[\"The \",(0,l.jsx)(e.code,{children:\"Table\"}),\" struct is basically just a wrapper around Rust's \",(0,l.jsx)(e.a,{href:\"https://doc.rust-lang.org/stable/std/collections/struct.BTreeMap.html#\",children:\"Btree\"}),\" with some extra column info.\"]}),`\n`,(0,l.jsxs)(e.h3,{id:\"what-is-a-b-tree\",children:[(0,l.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#what-is-a-b-tree\",children:(0,l.jsx)(e.span,{className:\"icon icon-link\"})}),\"What is a B-Tree?\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"A \",(0,l.jsx)(e.a,{href:\"https://en.wikipedia.org/wiki/B-tree\",children:\"B-Tree\"}),' is a generalized Binary Search Tree (BST). BSTs are great in theory but in practice, they kinda suck for cache locality, nodes only store 1 piece of data, have the potential to be unbalanced, and require a heap allocation for each insertion. In \"current year\" CPUs are insanely fast, so we need data structures that are better for reducing memory access.']}),`\n`,(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.em,{children:\"insert rant about why data oriented design is GOATED here\"}),\".\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"Alexis Beingessner in \",(0,l.jsx)(e.a,{href:\"https://cglab.ca/~abeinges/blah/rust-btree-case/#what's-a-b-tree?-why's-a-b-tree?\",children:\"Rust Collections Case Study: BTreeMap\"}),\" described B-Trees as\"]}),`\n`,(0,l.jsxs)(e.blockquote,{children:[`\n`,(0,l.jsx)(e.p,{children:'B-Trees take the idea of a BST, and say \"lets put some arrays in there; computers love arrays\". Rather than each node consisting of a single element with two children, B-Tree nodes have an array of elements with an array of children'}),`\n`]}),`\n`,(0,l.jsx)(e.p,{children:\"I won't go into too much detail on B-Tree implementation, since I'm just using rust's built-in for now. If you're interested here are some good resources on B-Trees.\"}),`\n`,(0,l.jsxs)(e.ul,{children:[`\n`,(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:\"https://cglab.ca/~abeinges/blah/rust-btree-case\",children:\"Rust Collections Case Study: BTreeMap\"})}),`\n`,(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:\"https://en.wikipedia.org/wiki/B-tree\",children:\"Wikipedia\"})}),`\n`,(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:\"http://opendatastructures.org/ods-python/14_2_B_Trees.html\",children:\"Open Data Structures\"})}),`\n`]}),`\n`,(0,l.jsx)(e.p,{children:\"With that said, let's walk through a basic example\"}),`\n`,(0,l.jsx)(e.p,{children:(0,l.jsx)(e.img,{src:\"https://upload.wikimedia.org/wikipedia/commons/6/65/B-tree.svg\",alt:\"B-Tree example\"})}),`\n`,(0,l.jsxs)(e.p,{children:[\"Here the internal node (the root) has 3 children. All keys \",(0,l.jsx)(e.span,{className:\"math math-inline\",children:(0,l.jsxs)(e.span,{className:\"katex\",children:[(0,l.jsx)(e.span,{className:\"katex-mathml\",children:(0,l.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mo,{children:\"<\"}),(0,l.jsx)(e.mn,{children:\"7\"})]}),(0,l.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"< 7\"})]})})}),(0,l.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,l.jsxs)(e.span,{className:\"base\",children:[(0,l.jsx)(e.span,{className:\"strut\",style:{height:\"0.5782em\",verticalAlign:\"-0.0391em\"}}),(0,l.jsx)(e.span,{className:\"mrel\",children:\"<\"}),(0,l.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,l.jsxs)(e.span,{className:\"base\",children:[(0,l.jsx)(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),(0,l.jsx)(e.span,{className:\"mord\",children:\"7\"})]})]})]})}),\" are in the left child, keys \",(0,l.jsx)(e.span,{className:\"math math-inline\",children:(0,l.jsxs)(e.span,{className:\"katex\",children:[(0,l.jsx)(e.span,{className:\"katex-mathml\",children:(0,l.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mo,{children:\">\"}),(0,l.jsx)(e.mn,{children:\"7\"})]}),(0,l.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"> 7\"})]})})}),(0,l.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,l.jsxs)(e.span,{className:\"base\",children:[(0,l.jsx)(e.span,{className:\"strut\",style:{height:\"0.5782em\",verticalAlign:\"-0.0391em\"}}),(0,l.jsx)(e.span,{className:\"mrel\",children:\">\"}),(0,l.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,l.jsxs)(e.span,{className:\"base\",children:[(0,l.jsx)(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),(0,l.jsx)(e.span,{className:\"mord\",children:\"7\"})]})]})]})}),\" and \",(0,l.jsx)(e.span,{className:\"math math-inline\",children:(0,l.jsxs)(e.span,{className:\"katex\",children:[(0,l.jsx)(e.span,{className:\"katex-mathml\",children:(0,l.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mo,{children:\"<\"}),(0,l.jsx)(e.mo,{children:\"=\"}),(0,l.jsx)(e.mn,{children:\"16\"})]}),(0,l.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"<= 16\"})]})})}),(0,l.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,l.jsxs)(e.span,{className:\"base\",children:[(0,l.jsx)(e.span,{className:\"strut\",style:{height:\"0.5782em\",verticalAlign:\"-0.0391em\"}}),(0,l.jsx)(e.span,{className:\"mrel\",children:\"<=\"}),(0,l.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,l.jsxs)(e.span,{className:\"base\",children:[(0,l.jsx)(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),(0,l.jsx)(e.span,{className:\"mord\",children:\"16\"})]})]})]})}),\" are in the middle, and finally, keys \",(0,l.jsx)(e.span,{className:\"math math-inline\",children:(0,l.jsxs)(e.span,{className:\"katex\",children:[(0,l.jsx)(e.span,{className:\"katex-mathml\",children:(0,l.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mo,{children:\">\"}),(0,l.jsx)(e.mn,{children:\"16\"})]}),(0,l.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"> 16\"})]})})}),(0,l.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,l.jsxs)(e.span,{className:\"base\",children:[(0,l.jsx)(e.span,{className:\"strut\",style:{height:\"0.5782em\",verticalAlign:\"-0.0391em\"}}),(0,l.jsx)(e.span,{className:\"mrel\",children:\">\"}),(0,l.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,l.jsxs)(e.span,{className:\"base\",children:[(0,l.jsx)(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),(0,l.jsx)(e.span,{className:\"mord\",children:\"16\"})]})]})]})}),\" are in the right child.\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"You can customize the \",(0,l.jsx)(e.span,{className:\"math math-inline\",children:(0,l.jsxs)(e.span,{className:\"katex\",children:[(0,l.jsx)(e.span,{className:\"katex-mathml\",children:(0,l.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsx)(e.mrow,{children:(0,l.jsx)(e.mi,{children:\"B\"})}),(0,l.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"B\"})]})})}),(0,l.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,l.jsxs)(e.span,{className:\"base\",children:[(0,l.jsx)(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,l.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05017em\"},children:\"B\"})]})})]})}),\" constant to have nodes store more/fewer keys and have more/fewer children. The average Lookup for a B-tree with \",(0,l.jsx)(e.span,{className:\"math math-inline\",children:(0,l.jsxs)(e.span,{className:\"katex\",children:[(0,l.jsx)(e.span,{className:\"katex-mathml\",children:(0,l.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsx)(e.mrow,{children:(0,l.jsx)(e.mi,{children:\"N\"})}),(0,l.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"N\"})]})})}),(0,l.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,l.jsxs)(e.span,{className:\"base\",children:[(0,l.jsx)(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,l.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.10903em\"},children:\"N\"})]})})]})}),\" keys is \",(0,l.jsx)(e.span,{className:\"math math-inline\",children:(0,l.jsxs)(e.span,{className:\"katex\",children:[(0,l.jsx)(e.span,{className:\"katex-mathml\",children:(0,l.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mi,{mathvariant:\"script\",children:\"O\"}),(0,l.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,l.jsx)(e.mi,{children:\"log\"}),(0,l.jsx)(e.mo,{children:\"\\u2061\"}),(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mrow,{}),(0,l.jsx)(e.mn,{children:\"2\"})]}),(0,l.jsx)(e.mi,{children:\"N\"}),(0,l.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,l.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathcal{O}(\\\\log{_2}N)\"})]})})}),(0,l.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,l.jsxs)(e.span,{className:\"base\",children:[(0,l.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,l.jsx)(e.span,{className:\"mord mathcal\",style:{marginRight:\"0.02778em\"},children:\"O\"}),(0,l.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,l.jsxs)(e.span,{className:\"mop\",children:[\"lo\",(0,l.jsx)(e.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),(0,l.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,l.jsx)(e.span,{className:\"mord\",children:(0,l.jsxs)(e.span,{className:\"mord\",children:[(0,l.jsx)(e.span,{}),(0,l.jsx)(e.span,{className:\"msupsub\",children:(0,l.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,l.jsxs)(e.span,{className:\"vlist-r\",children:[(0,l.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,l.jsxs)(e.span,{style:{top:\"-2.55em\",marginRight:\"0.05em\"},children:[(0,l.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,l.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,l.jsx)(e.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,l.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,l.jsx)(e.span,{className:\"vlist-r\",children:(0,l.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,l.jsx)(e.span,{})})})]})})]})}),(0,l.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.10903em\"},children:\"N\"}),(0,l.jsx)(e.span,{className:\"mclose\",children:\")\"})]})})]})}),\" which is the same for a BST.\"]}),`\n`,(0,l.jsxs)(e.h3,{id:\"why-b-tree\",children:[(0,l.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#why-b-tree\",children:(0,l.jsx)(e.span,{className:\"icon icon-link\"})}),\"Why B-Tree?\"]}),`\n`,(0,l.jsx)(e.p,{children:\"As I mentioned before B-Trees are great for cache locality. Also, you can make each node the size of a memory/disk block. This way you can minimize reads by chunking up the data more efficiently.\"}),`\n`,(0,l.jsxs)(e.h2,{id:\"actually-do-stuff\",children:[(0,l.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#actually-do-stuff\",children:(0,l.jsx)(e.span,{className:\"icon icon-link\"})}),\"Actually do stuff\"]}),`\n`,(0,l.jsx)(e.p,{children:\"Nerd stuff aside, let's add actual logic for our table\"}),`\n`,(0,l.jsxs)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:[(0,l.jsx)(e.div,{className:\"language-id\",children:\"rust\"}),(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsxs)(e.code,{children:[(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"impl\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Table\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"    // Create a table with the given column definitions\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"pub\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"fn\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"new\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(columns\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Vec\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Column\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\">) \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"->\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"Self\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"Self\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            rows\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"BTreeMap\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"new\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(),\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            columns,\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        }\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    }\"})}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"    /// Insert values (a row) into the table\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"    ///\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"    /// assumes the values are in the same order of the columns passed to create\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"pub\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"fn\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"insert\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"&mut\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", values\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Vec\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"String\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\">) {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" id \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"rows\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"last_key_value\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"()\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"map_or\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"0\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(max_id, _)\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" max_id \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"+\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"1\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\");\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" row\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"StoredRow\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" values\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"into_iter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"()\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"zip\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"columns\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"iter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"())\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"map\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(v, col)\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" (col\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"name\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"to_owned\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(), v))\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"collect\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"();\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"rows\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"insert\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(id, row);\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    }\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})})]})})]}),`\n`,(0,l.jsx)(e.p,{children:\"Here we create a table with the given column definitions (from the create table sql command). For insert, we get an ID for the new row which is just an ID sequence starting at 0 for the first row. We then insert the values into the B-TreeMap with that ID as the key and the row's values as a hash map of the column name to a string of the value to insert.\"}),`\n`,(0,l.jsxs)(e.p,{children:[\"Those two functions can handle creating tables (mostly) and inserting data, but how should we handle select? A simple first step is to re-use the \",(0,l.jsx)(e.a,{href:\"https://doc.rust-lang.org/std/iter/trait.Iterator.html\",children:\"Iterator\"}),\" on \",(0,l.jsx)(e.a,{href:\"https://doc.rust-lang.org/std/collections/struct.BTreeMap.html#method.iter\",children:\"BTreeMap\"}),\".\"]}),`\n`,(0,l.jsxs)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:[(0,l.jsx)(e.div,{className:\"language-id\",children:\"rust\"}),(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsxs)(e.code,{children:[(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"impl\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Table\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"pub\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"fn\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"iter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"&\"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"->\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" std\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"collections\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"btree_map\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Iter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"usize\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Row\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"> {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"rows\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"iter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"()\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    }\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})})]})})]}),`\n`,(0,l.jsxs)(e.p,{children:[\"This will give us an \",(0,l.jsx)(e.code,{children:\"Iterator\"}),\" over \",(0,l.jsx)(e.code,{children:\"(row_id, row_values)\"}),\".\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"Re-using the iterator from BTreeMap is fine, but I like how many Rust DB libraries have a \",(0,l.jsx)(e.code,{children:\"Row\"}),\" trait/struct that gives you extra information. For example, \",(0,l.jsx)(e.a,{href:\"https://github.com/launchbadge/sqlx\",children:\"SQLX\"}),\" has a \",(0,l.jsx)(e.a,{href:\"https://docs.rs/sqlx/latest/sqlx/trait.Row.html\",children:\"Row trait\"}),\" that lets you get column info back for the query you ran, safe/unsafe conversions into rust types, and a few other helpers. So let's make our \",(0,l.jsx)(e.code,{children:\"Row\"}),\" struct and iterator, so we can add these features later on.\"]}),`\n`,(0,l.jsxs)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:[(0,l.jsx)(e.div,{className:\"language-id\",children:\"rust\"}),(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsxs)(e.code,{children:[(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"use\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" std\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"{collections\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"HashMap\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", rc\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Rc\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"};\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"use\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"crate::\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"table\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"ColumnInfo\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\";\"}),(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\" // Vec<Column>\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"/// A Row in a Query response\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"#[derive(\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Debug\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Clone\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\")]\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"pub\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"struct\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Row\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"> {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    id\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"usize\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\",\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    columns\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Rc\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"ColumnInfo\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\">,\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    data\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"&\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"HashMap\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"String\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"String\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\">,\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})})]})})]}),`\n`,(0,l.jsxs)(e.p,{children:[\"Here I made the decision that this \",(0,l.jsx)(e.code,{children:\"Row\"}),\" struct will not own the data it's showing. Therefore, it needs a reference to the data stored in the table. I also want to have the row have access to the \",(0,l.jsx)(e.code,{children:\"ColumnInfo\"}),\" from the table. Since every row will be holding a reference to the same \",(0,l.jsx)(e.code,{children:\"ColumnInfo\"}),\", I went with an \",(0,l.jsx)(e.a,{href:\"https://doc.rust-lang.org/std/rc/index.html\",children:\"RC\"}),\" to avoid extra lifetime parameters on the row struct.\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"Now we can implement \",(0,l.jsx)(e.code,{children:\"Iterator\"}),\" for the table. We can just wrap the existing \",(0,l.jsx)(e.code,{children:\"Iterator\"}),\" from \",(0,l.jsx)(e.code,{children:\"BTreeMap\"}),\" and transform each response into our \",(0,l.jsx)(e.code,{children:\"Row\"}),\" struct.\"]}),`\n`,(0,l.jsxs)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:[(0,l.jsx)(e.div,{className:\"language-id\",children:\"rust\"}),(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsxs)(e.code,{children:[(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"/// Iterator of [`Row`]s from a table\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"pub\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"crate\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"struct\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"TableIter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"> {\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"    /// Underlying iterator over the btree_map\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    map_iter\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" std\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"collections\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"btree_map\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Iter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"usize\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"StoredRow\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\">,\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"    /// The columns of the [`Table`]\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    columns\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Rc\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"ColumnInfo\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\">,\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"impl\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"> \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"TableIter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"> {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"pub\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"fn\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"new\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        map_iter\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" std\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"collections\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"btree_map\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Iter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"usize\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"StoredRow\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\">,\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        columns\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Rc\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"ColumnInfo\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\">,\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    ) \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"->\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"Self\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"Self\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" { map_iter, columns }\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    }\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"impl\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"> \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Iterator\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"for\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"TableIter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"> {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"type\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Item\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Row\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\">;\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"fn\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"next\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"&mut\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"->\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Option\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"Self\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Item\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"> {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"map_iter\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"next\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"()\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"map\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(id, data)\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Row\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"new\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"columns\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"clone\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(), id\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"clone\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(), data))\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    }\"})})]})})]}),`\n`,(0,l.jsxs)(e.p,{children:[\"Now we can implement the \",(0,l.jsx)(e.a,{href:\"https://doc.rust-lang.org/std/iter/trait.IntoIterator.html\",children:\"IntoIterator trait\"}),\" on \",(0,l.jsx)(e.code,{children:\"Table\"}),\" for easy conversion into an iterator.\"]}),`\n`,(0,l.jsxs)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:[(0,l.jsx)(e.div,{className:\"language-id\",children:\"rust\"}),(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsxs)(e.code,{children:[(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"impl\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"> \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"IntoIterator\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"for\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"&\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Table\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"type\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Item\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Row\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\">;\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"type\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"IntoIter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"TableIter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\">;\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"fn\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"into_iter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"->\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"Self\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"IntoIter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" col_info \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Rc\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"new\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"columns\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"clone\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"());\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"TableIter\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"new\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"rows\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"iter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(), col_info)\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    }\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})})]})})]}),`\n`,(0,l.jsxs)(e.p,{children:[\"now the \",(0,l.jsx)(e.code,{children:\"iter\"}),\" method (not necessarily needed) on table can just call the trait method\"]}),`\n`,(0,l.jsxs)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:[(0,l.jsx)(e.div,{className:\"language-id\",children:\"rust\"}),(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsxs)(e.code,{children:[(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"impl\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Table\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"  \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"pub\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"fn\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"iter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"&\"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"->\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"impl\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Iterator\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Item\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Row\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"> {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"into_iter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"()\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    }\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})})]})})]}),`\n`,(0,l.jsxs)(e.h2,{id:\"handling-sql-queries\",children:[(0,l.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#handling-sql-queries\",children:(0,l.jsx)(e.span,{className:\"icon icon-link\"})}),\"Handling SQL Queries\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"Now that we have a \",(0,l.jsx)(e.code,{children:\"Table\"}),\" struct we need to hook up the parsed commands to create, insert, and read from tables.\"]}),`\n`,(0,l.jsx)(e.p,{children:\"First we should define the response type for an execution\"}),`\n`,(0,l.jsxs)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:[(0,l.jsx)(e.div,{className:\"language-id\",children:\"rust\"}),(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsxs)(e.code,{children:[(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"use\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" derive_more\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Display\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\";\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"#[derive(\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Debug\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Display\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\")]\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"pub\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"enum\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"ExecResponse\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"> {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    #[display(fmt \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#F1FA8C\"},children:'\"{_0:?}\"'}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\")]\"}),(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:' // only show the values not \"Select(...)\"'})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"Select\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Vec\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Row\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\">>),\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Insert\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\",\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Create\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\",\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})})]})})]}),`\n`,(0,l.jsxs)(e.p,{children:[\"Here I use the \",(0,l.jsx)(e.a,{href:\"https://docs.rs/derive_more/latest/derive_more/\",children:\"derive_more\"}),\" crate's Display derive macro to avoid writing my own implementation of Display. If you're a real one who's been paying attention, you may have noticed that we did not implement \",(0,l.jsx)(e.code,{children:\"Display\"}),\" on \",(0,l.jsx)(e.code,{children:\"Row\"}),\" but the \",(0,l.jsx)(e.code,{children:\"Display\"}),\" derive still compiles, this is due to us adding \",(0,l.jsx)(e.code,{children:'#[display(fmt = \"{_0:?}\")]'}),\" to use the debug format of \",(0,l.jsx)(e.code,{children:\"Vec<Row>\"}),\" as the \",(0,l.jsx)(e.code,{children:\"Display\"}),\" format. While we won't use it much for select display (more on that later), for the other response cases It's nice to have.\"]}),`\n`,(0,l.jsx)(e.p,{children:\"We also should make our own Error type for Query Execution\"}),`\n`,(0,l.jsxs)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:[(0,l.jsx)(e.div,{className:\"language-id\",children:\"rust\"}),(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsxs)(e.code,{children:[(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"use\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" miette\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Diagnostic\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\";\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"use\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" thiserror\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Error\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\";\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"/// Errors during query execution\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"#[derive(\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Error\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Debug\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Diagnostic\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\")]\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"#[error(\"}),(0,l.jsx)(e.span,{style:{color:\"#F1FA8C\"},children:'\"Query Execution Error\"'}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\")]\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"pub\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"enum\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"QueryExecutionError\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    #[error(\"}),(0,l.jsx)(e.span,{style:{color:\"#F1FA8C\"},children:'\"Table {0} was not found\"'}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\")]\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"TableNotFound\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"String\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"),\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    #[error(\"}),(0,l.jsx)(e.span,{style:{color:\"#F1FA8C\"},children:'\"Table {0} already exists\"'}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\")]\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"TableAlreadyExists\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"String\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"),\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    #[error(\"}),(0,l.jsx)(e.span,{style:{color:\"#F1FA8C\"},children:'\"Column {0} does not exist\"'}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\")]\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"ColumnDoesNotExist\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"String\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"),\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})})]})})]}),`\n`,(0,l.jsxs)(e.p,{children:[\"Like in \",(0,l.jsx)(e.a,{href:\"/blog/build-a-db/part01\",children:\"part1\"}),\", we still are using \",(0,l.jsx)(e.a,{href:\"https://docs.rs/miette/latest/miette/\",children:\"miette\"}),\"/\",(0,l.jsx)(e.a,{href:\"https://docs.rs/thiserror/latest/thiserror/\",children:\"thiserror\"}),\" for better looking errors.\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"Now we can finally actually run some queries. For a quick refresher on the \",(0,l.jsx)(e.code,{children:\"SqlQuery\"}),\" type, see \",(0,l.jsx)(e.a,{href:\"https://github.com/JRMurr/SQLJr/blob/5324c38bc74cb77d2daf035a0f3d1da3fc7b4c3b/crates/sql_jr_parser/src/ast.rs#L19\",children:\"the source code\"})]}),`\n`,(0,l.jsxs)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:[(0,l.jsx)(e.div,{className:\"language-id\",children:\"rust\"}),(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsxs)(e.code,{children:[(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"#[derive(\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Debug\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Default\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\")]\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"pub\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"struct\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Execution\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    tables\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"HashMap\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"String\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Table\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\">,\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"impl\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Execution\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"pub\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"fn\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"new\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"() \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"->\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"Self\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"Self\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            tables\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"HashMap\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"new\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(),\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        }\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    }\"})}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"pub\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"fn\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"run\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"&mut\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", query\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"SqlQuery\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"->\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Result\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"ExecResponse\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"QueryExecutionError\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"> {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"match\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" query {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"SqlQuery\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"Select\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"mut\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" select) \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" table \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" select\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"table;\"}),(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\" // the table name\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" table \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"tables\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"get\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"&\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"table)\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"ok_or\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"QueryExecutionError\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"TableNotFound\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(table))\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"?\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\";\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"                // not projecting to the selected columns yet\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" rows \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" table\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"iter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"()\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"collect\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"();\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Ok\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"ExecResponse\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"Select\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(rows)))\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            }\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"SqlQuery\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"Insert\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(insert) \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Some\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(table) \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"tables\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"get_mut\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"&\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"insert\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"table) \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"else\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"return\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Err\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"QueryExecutionError\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"TableNotFound\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(insert\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"table))\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                };\"})}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                table\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"insert\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(insert\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"values);\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Ok\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"ExecResponse\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Insert\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\")\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            }\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"SqlQuery\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"Create\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(create) \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" table \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Table\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"new\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(create\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"columns);\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"tables\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"insert\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(create\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"table, table);\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Ok\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"ExecResponse\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Create\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\")\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            }\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        }\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    }\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})})]})})]}),`\n`,(0,l.jsxs)(e.p,{children:[\"Since we handled most of the logic in the \",(0,l.jsx)(e.code,{children:\"Table\"}),\"/\",(0,l.jsx)(e.code,{children:\"Row\"}),\" structs, the actual execution is mostly just wrapper around the \",(0,l.jsx)(e.code,{children:\"HashMap\"}),\" of tables with some basic error handling.\"]}),`\n`,(0,l.jsxs)(e.h2,{id:\"bringing-it-all-together\",children:[(0,l.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#bringing-it-all-together\",children:(0,l.jsx)(e.span,{className:\"icon icon-link\"})}),\"Bringing it all together\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"With the \",(0,l.jsx)(e.code,{children:\"Execution\"}),` struct we can handle the parsed commands from our parser but right now we don't have it all hooked up.\nWe need to unify the parser and execution into one.`]}),`\n`,(0,l.jsxs)(e.p,{children:['Ideally, we would have some new crate for the full \"pipeline\" from parsing to execution (and probably more steps we will add later), but for now having this logic in the ',(0,l.jsx)(e.code,{children:\"Execution\"}),\" crate feels fine.\"]}),`\n`,(0,l.jsx)(e.p,{children:\"First, step is to combine the Error types from Parsing and Execution\"}),`\n`,(0,l.jsxs)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:[(0,l.jsx)(e.div,{className:\"language-id\",children:\"rust\"}),(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsxs)(e.code,{children:[(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"use\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" miette\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Diagnostic\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\";\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"use\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" sql_jr_parser\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"error\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"FormattedError\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\";\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"use\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" thiserror\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Error\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\";\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:'/// Errors at any point in the SQL \"pipeline\"'})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"#[derive(\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Error\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Debug\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Diagnostic\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\")]\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"#[error(transparent)]\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"pub\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"enum\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"SQLError\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"> {\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    #[diagnostic(transparent)]\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"QueryExecutionError\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(#[from] \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"QueryExecutionError\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"),\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    #[diagnostic(transparent)]\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"ParsingError\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"FormattedError\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\">),\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"// need a manual impl since the error #[from] seems sad on lifetimes\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"impl\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"> \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"From\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"FormattedError\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\">> \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"for\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"SQLError\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"> {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"fn\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"from\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(value\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"FormattedError\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\">) \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"->\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"Self\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"SQLError\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"ParsingError\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(value)\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    }\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})})]})})]}),`\n`,(0,l.jsxs)(e.p,{children:[\"Here \",(0,l.jsx)(e.code,{children:\"#[diagnostic(transparent)]\"}),\" is similar to \",(0,l.jsx)(e.code,{children:\"#[error(transparent)]\"}),\" in \",(0,l.jsx)(e.code,{children:\"thiserror\"}),\", it lets you wrap other errors but still call their \",(0,l.jsx)(e.code,{children:\"Display\"}),\" trait when the error is shown.\"]}),`\n`,(0,l.jsx)(e.p,{children:\"Now we can have a function that parses and executes the query\"}),`\n`,(0,l.jsxs)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:[(0,l.jsx)(e.div,{className:\"language-id\",children:\"rust\"}),(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsxs)(e.code,{children:[(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"impl\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Execution\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"   \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"pub\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"fn\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"parse_and_run\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\">(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"&mut\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", query\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"&\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"str\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"->\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Result\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"ExecResponse\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"SQLError\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<'\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"a\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\">> {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" query \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"parse_sql_query\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(query)\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"?\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\";\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" res \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"run\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(query)\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"?\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\";\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Ok\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(res)\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    }\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})})]})})]}),`\n`,(0,l.jsx)(e.p,{children:\"Which lets our REPL now look like\"}),`\n`,(0,l.jsxs)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:[(0,l.jsx)(e.div,{className:\"language-id\",children:\"rust\"}),(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsxs)(e.code,{children:[(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"fn\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"main\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"() {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"  \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"...\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"  \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"mut\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" exec \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" sql_jr_execution\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Execution\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"new\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"();\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"  \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"loop\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" readline \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" rl\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"readline\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#F1FA8C\"},children:'\">> \"'}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\");\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"match\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" readline {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"          \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Ok\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(line) \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                rl\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"add_history_entry\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(line\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"as_str\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"());\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" line\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"&\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"str\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" line\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"as_ref\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"();\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" res \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" exec\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"parse_and_run\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(line);\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"match\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" res {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                    \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Ok\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(exec_res) \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"println!\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#F1FA8C\"},children:'\"{exec_res}\"'}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"),\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                    \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Err\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(e) \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                        \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"mut\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" s \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"String\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"new\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"();\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                        \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"GraphicalReportHandler\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"new\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"()\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"with_cause_chain\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"()\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"with_context_lines\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"10\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\")\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"render_report\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"&mut\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" s, \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"&\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"e)\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"unwrap\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"();\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                        \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"println!\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#F1FA8C\"},children:'\"{s}\"'}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\");\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                    }\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                }\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            }\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"          // other cases unchanged from part 1\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        }\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})})]})})]}),`\n`,(0,l.jsx)(e.p,{children:\"The happy path in our REPL now looks like\"}),`\n`,(0,l.jsx)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsx)(e.code,{children:(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"undefined\"},children:`>> create table foo (col1 string, col2 string);\nCreate\n>> insert into foo values a,b;\nInsert\n>> select col1,col2 from foo;\n[Row { id: 0, columns: [Column { name: \"col1\", type_info: String }, Column { name: \"col2\", type_info: String }], data: {\"col1\": \"a\", \"col2\": \"b\"} }]\n>>`})})})})}),`\n`,(0,l.jsxs)(e.h2,{id:\"better-display-for-repl\",children:[(0,l.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#better-display-for-repl\",children:(0,l.jsx)(e.span,{className:\"icon icon-link\"})}),\"Better display for REPL\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"The REPL works, but the display for select queries is pretty gross. We can use the \",(0,l.jsx)(e.a,{href:\"https://github.com/zhiburt/tabled\",children:\"tabled crate\"}),\" to format the response as a table. We can run \",(0,l.jsx)(e.code,{children:\"cargo add tabled\"}),\" in \",(0,l.jsx)(e.code,{children:\"crates/sql_jr_repl\"}),\" to add the crate to the repl.\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"If you look at the docs for \",(0,l.jsx)(e.code,{children:\"tabled\"}),\" many of the first examples involve the \",(0,l.jsx)(e.code,{children:\"#[derive(Tabled)]\"}),\" macro on your structs/enums. This does not really work for select queries since the columns are dynamic. Tabled still supports this with the \",(0,l.jsx)(e.a,{href:\"https://docs.rs/tabled/0.10.0/tabled/builder/struct.Builder.html\",children:\"builder\"}),\" to allow us to set the rows + columns dynamically.\"]}),`\n`,(0,l.jsx)(e.p,{children:\"Let's add a new file to the REPL crate and handle display there\"}),`\n`,(0,l.jsx)(\"div\",{className:\"remark-code-title\",children:\"crates/sql_jr_repl/display.rs\"}),`\n`,(0,l.jsxs)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:[(0,l.jsx)(e.div,{className:\"language-id\",children:\"rust\"}),(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsxs)(e.code,{children:[(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"pub\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"fn\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"display_response\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(res\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"ExecResponse\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\") {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"match\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" res {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"ExecResponse\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"Select\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(rows) \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"mut\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" builder \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Builder\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"default\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"();\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"            // Get column info from the first row\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" row \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" rows\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"get\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"0\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\")\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"expect\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#F1FA8C\"},children:'\"For now assuming we get data back\"'}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\");\"})]}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" columns\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Vec\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"String\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"> \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" row\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"columns\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"()\"}),(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\" // added helper, see below\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"iter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"()\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"map\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"col\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" col\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"name\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"to_string\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"())\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"collect\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"();\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            builder\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"set_columns\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"&\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"columns);\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"for\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" row \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"in\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" rows\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"into_iter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"() {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"                builder\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"add_record\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(columns\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"iter\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"()\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"map\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"col\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" row\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"get\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(col)));\"}),(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\" // added a get helper, see below\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            }\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"println!\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#F1FA8C\"},children:'\"{}\"'}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", builder\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"build\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"())\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        }\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        _ \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"println!\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#F1FA8C\"},children:'\"{res}\"'}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"),\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    }\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})})]})})]}),`\n`,(0,l.jsx)(e.p,{children:\"as noted in a comment I added these helpers to the row struct to make column lookup easier\"}),`\n`,(0,l.jsx)(\"div\",{className:\"remark-code-title\",children:\"crates/sql_jr_execution/row.rs\"}),`\n`,(0,l.jsxs)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:[(0,l.jsx)(e.div,{className:\"language-id\",children:\"rust\"}),(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsxs)(e.code,{children:[(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"impl\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Row\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"     \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"pub\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"fn\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"columns\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"&\"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"->\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"&\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"ColumnInfo\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"columns\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"as_ref\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"()\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    }\"})}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"    /// Get a single value from the row\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"    ///\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"    /// # Panics\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"    ///\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"    /// Panics if the column does not exist\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"    /// See [`try_get`](Self::try_get) for a non-panicking\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"    /// version.\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"pub\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"fn\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"get\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"&\"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", column\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"&\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"String\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"->\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"String\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"try_get\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(column)\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"unwrap\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"()\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    }\"})}),(0,l.jsx)(e.div,{className:\"line\"}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"    /// Get a single value from the row\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"pub\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"fn\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"try_get\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"&\"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", column\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"&\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"String\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"->\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Result\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"String\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"QueryExecutionError\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"> {\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"self\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"data\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"get\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(column)\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"map_or_else\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"||\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Err\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"QueryExecutionError\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"::\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"ColumnDoesNotExist\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(column\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"to_owned\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"())),\"})]}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"            \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"val\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"|\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#8BE9FD\"},children:\"Ok\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(val\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"to_string\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"()),\"})]}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"        )\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"    }\"})}),(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"}\"})})]})})]}),`\n`,(0,l.jsx)(e.p,{children:\"now the REPL from the example above would show\"}),`\n`,(0,l.jsx)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsx)(e.code,{children:(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"undefined\"},children:`>> select col1,col2 from foo;\n+------+------+\n| col1 | col2 |\n+------+------+\n| a    | b    |\n+------+------+`})})})})}),`\n`,(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:\"tabled\"}),\" has many \",(0,l.jsx)(e.a,{href:\"https://github.com/zhiburt/tabled#style\",children:\"style options\"}),\" if we wanted to tweak the look, but this is fine for now.\"]}),`\n`,(0,l.jsx)(e.p,{children:\"You probably noticed the line\"}),`\n`,(0,l.jsxs)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:[(0,l.jsx)(e.div,{className:\"language-id\",children:\"rust\"}),(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsxs)(e.code,{children:[(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#6272A4\"},children:\"//Get column info from the first row\"})}),(0,l.jsxs)(e.div,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" row \"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\" rows\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"get\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#BD93F9\"},children:\"0\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\")\"}),(0,l.jsx)(e.span,{style:{color:\"#FF79C6\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#50FA7B\"},children:\"expect\"}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#F1FA8C\"},children:'\"For now assuming we get data back\"'}),(0,l.jsx)(e.span,{style:{color:\"#F8F8F2\"},children:\");\"})]})]})})]}),`\n`,(0,l.jsxs)(e.p,{children:[\"in our display function. This obviously would get sad on empty responses. The best decision would be to add/move \",(0,l.jsx)(e.code,{children:\"ColumnInfo\"}),\" into \",(0,l.jsx)(e.code,{children:\"ExecResponse::Select\"}),\", so we return something like\"]}),`\n`,(0,l.jsx)(e.pre,{className:\"shiki dracula\",style:{backgroundColor:\"#282A36\",color:\"#F8F8F2\"},children:(0,l.jsx)(e.div,{className:\"code-container\",children:(0,l.jsx)(e.code,{children:(0,l.jsx)(e.div,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"undefined\"},children:\"{columns: Rc<ColumnInfo>, row: Vec<Row>}\"})})})})}),`\n`,(0,l.jsx)(e.p,{children:\"but I'll save that for the next post.\"}),`\n`,(0,l.jsxs)(e.h2,{id:\"wrap-up\",children:[(0,l.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#wrap-up\",children:(0,l.jsx)(e.span,{className:\"icon icon-link\"})}),\"Wrap up\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"Having basic execution feels nice, but the real challenge will be filtering and projecting the data. We have some extra clones and \",(0,l.jsx)(e.code,{children:\"unwraps\"}),\"/\",(0,l.jsx)(e.code,{children:\"expects\"}),\" we need to handle once we start moving away from this extremely simple happy path but so far the high level design feels good!\"]})]})}}var g=B;function f(n,s){throw new Error(\"Expected \"+(s?\"component\":\"object\")+\" `\"+n+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return E;})();\n;return Component;","toc":[{"value":"Feedback from part 1","url":"#feedback-from-part-1","depth":1},{"value":"Execution","url":"#execution","depth":1},{"value":"What is a B-Tree?","url":"#what-is-a-b-tree","depth":3},{"value":"Why B-Tree?","url":"#why-b-tree","depth":3},{"value":"Actually do stuff","url":"#actually-do-stuff","depth":2},{"value":"Handling SQL Queries","url":"#handling-sql-queries","depth":2},{"value":"Bringing it all together","url":"#bringing-it-all-together","depth":2},{"value":"Better display for REPL","url":"#better-display-for-repl","depth":2},{"value":"Wrap up","url":"#wrap-up","depth":2}],"frontMatter":{"readingTime":{"text":"10 min read","minutes":9.866666666666667,"time":592000,"words":2368},"slug":"build-a-db/part02","fileName":"build-a-db/part02.md","title":"Building a Simple DB in Rust - Part 2 - Basic Execution","seriesTitle":"Part 2 - Basic Execution","date":"2023-01-23T14:01:22.231Z","tags":["rust","database"],"draft":false,"summary":"Building a basic database in rust","images":[],"layout":"PostLayout"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.17916666666666667,"time":10750,"words":43},"slug":["default"],"fileName":"default.md","name":"John Murray","avatar":"/static/images/me.jpg","occupation":"Software Engineer","github":"https://github.com/JRMurr","twitter":"https://twitter.com/JRMurrCodes","mastodon":"https://hachyderm.io/@jrmurr","email":"johnreillymurray@gmail.com","date":null}],"series":{"title":"Building a Simple DB in Rust","posts":[{"title":"Building a Simple DB in Rust - Part 1 - Parsing","seriesTitle":"Part 1 - Parsing","date":"2023-01-02T05:19:22.985Z","tags":["rust","database","parsing"],"draft":false,"summary":"building a basic database in rust","images":[],"layout":"PostLayout","slug":"build-a-db/part01"},{"title":"Building a Simple DB in Rust - Part 2 - Basic Execution","seriesTitle":"Part 2 - Basic Execution","date":"2023-01-23T14:01:22.231Z","tags":["rust","database"],"draft":false,"summary":"Building a basic database in rust","images":[],"layout":"PostLayout","slug":"build-a-db/part02"},{"title":"Building a Simple DB in Rust - Part 3 - Less Basic Execution","seriesTitle":"Part 3 - Less Basic Execution","date":"2023-04-04T00:01:55.249Z","tags":["rust","database","repl"],"draft":false,"summary":"Cleaning up existing execution logic","images":[],"layout":"PostLayout","slug":"build-a-db/part03"}]}},"__N_SSG":true}